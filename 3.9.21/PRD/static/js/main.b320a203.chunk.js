(this["webpackJsonprail-map-generator"]=this["webpackJsonprail-map-generator"]||[]).push([[77],[,,function(n,e,t){"use strict";t.d(e,"g",(function(){return a})),t.d(e,"k",(function(){return i})),t.d(e,"c",(function(){return c})),t.d(e,"a",(function(){return j})),t.d(e,"n",(function(){return m})),t.d(e,"d",(function(){return s})),t.d(e,"m",(function(){return u})),t.d(e,"b",(function(){return l})),t.d(e,"h",(function(){return d})),t.d(e,"l",(function(){return h})),t.d(e,"e",(function(){return f})),t.d(e,"i",(function(){return b})),t.d(e,"j",(function(){return g})),t.d(e,"f",(function(){return p}));var r,a,i,c,o=t(5);!function(n){n.init="init",n.loading="loading",n.loaded="loaded",n.failed="failed"}(a||(a={})),function(n){n.MTR="mtr",n.GZMTR="gzmtr",n.SHMetro="shmetro"}(i||(i={})),function(n){n.Destination="destination",n.RunIn="runin",n.RailMap="railmap",n.Indoor="indoor"}(c||(c={}));var s,u,l,d,h,f,b,g,p,j="all",m=(r={},Object(o.a)(r,i.MTR,[c.Destination,c.RailMap]),Object(o.a)(r,i.GZMTR,[c.RunIn,c.RailMap]),Object(o.a)(r,i.SHMetro,[c.Destination,c.RunIn,c.RailMap,c.Indoor]),r);!function(n){n.left="left",n.right="right"}(s||(s={})),function(n){n.left="l",n.right="r"}(u||(u={})),function(n){n.through="through",n.nonThrough="nonthrough"}(l||(l={})),function(n){n.black="#000",n.white="#fff"}(d||(d={})),function(n){n.local="local",n.express="express",n.direct="direct"}(h||(h={})),function(n){n.airport="airport",n.disney="disney",n.hsr="hsr",n.none=""}(f||(f={})),function(n){n.gz1="gz1",n.gz28="gz28",n.gz2otis="gz2otis",n.gz3="gz3",n.gz4="gz4",n.gz5="gz5",n.gz1421="gz1421",n.gz6="gz6",n.gzgf="gzgf"}(b||(b={})),function(n){n.sh="sh",n.sh2020="sh2020"}(g||(g={})),function(n){n.Catalan="ca",n.English="en",n.Spanish="es",n.French="fr",n.Gaelic="ga",n.Japanese="ja",n.Korean="ko",n.Norwegian="no",n.Portuguese="pt",n.Swedish="sv",n.Chinese="zh",n.ChineseCN="zh-CN",n.ChineseSimp="zh-Hans",n.ChineseTrad="zh-Hant",n.ChineseHK="zh-HK",n.ChineseTW="zh-TW"}(p||(p={}))},function(n,e){n.exports=React},function(n,e){n.exports=MaterialUI},,,function(n,e,t){"use strict";t.d(e,"g",(function(){return i})),t.d(e,"r",(function(){return c})),t.d(e,"s",(function(){return o})),t.d(e,"u",(function(){return s})),t.d(e,"a",(function(){return u})),t.d(e,"l",(function(){return l})),t.d(e,"e",(function(){return d})),t.d(e,"f",(function(){return h})),t.d(e,"t",(function(){return f})),t.d(e,"h",(function(){return b})),t.d(e,"d",(function(){return g})),t.d(e,"n",(function(){return p})),t.d(e,"i",(function(){return j})),t.d(e,"o",(function(){return m})),t.d(e,"m",(function(){return O})),t.d(e,"k",(function(){return v})),t.d(e,"j",(function(){return y})),t.d(e,"c",(function(){return _})),t.d(e,"b",(function(){return w})),t.d(e,"p",(function(){return S})),t.d(e,"q",(function(){return x})),t.d(e,"K",(function(){return T})),t.d(e,"S",(function(){return z})),t.d(e,"T",(function(){return k})),t.d(e,"V",(function(){return N})),t.d(e,"F",(function(){return M})),t.d(e,"N",(function(){return E})),t.d(e,"I",(function(){return C})),t.d(e,"J",(function(){return R})),t.d(e,"U",(function(){return I})),t.d(e,"L",(function(){return H})),t.d(e,"H",(function(){return P})),t.d(e,"P",(function(){return D})),t.d(e,"M",(function(){return F})),t.d(e,"Q",(function(){return B})),t.d(e,"O",(function(){return A})),t.d(e,"w",(function(){return W})),t.d(e,"Z",(function(){return L})),t.d(e,"C",(function(){return K})),t.d(e,"W",(function(){return J})),t.d(e,"A",(function(){return U})),t.d(e,"X",(function(){return V})),t.d(e,"y",(function(){return Y})),t.d(e,"G",(function(){return q})),t.d(e,"R",(function(){return $})),t.d(e,"E",(function(){return nn})),t.d(e,"db",(function(){return en})),t.d(e,"hb",(function(){return tn})),t.d(e,"eb",(function(){return rn})),t.d(e,"v",(function(){return an})),t.d(e,"B",(function(){return cn})),t.d(e,"Y",(function(){return on})),t.d(e,"fb",(function(){return sn})),t.d(e,"ib",(function(){return un})),t.d(e,"gb",(function(){return ln})),t.d(e,"bb",(function(){return dn})),t.d(e,"ab",(function(){return hn})),t.d(e,"z",(function(){return fn})),t.d(e,"cb",(function(){return bn})),t.d(e,"x",(function(){return gn})),t.d(e,"D",(function(){return pn}));var r=t(5),a=t(1),i="SET_FULL_PARAM",c="SET_SVG_HEIGHT",o="SET_SVG_WIDTH",s="SET_Y_PERCENTAGE",u="SET_BRANCH_SPACING",l="SET_PADDING_PERCENTAGE",d="SET_DIRECTION_INDICATOR_X",h="SET_DIRECTION_INDICATOR_Y",f="SET_THEME",b="SET_LINE_NAME",g="SET_DIRECTION",p="SET_PLATFORM",j="SET_LINE_NUM",m="SET_PSD_NUM",O="SET_PANEL_TYPE",v="SET_NOTES",y="SET_NAME_POSITION",_="SET_CUSTOMISED_MTR_DESTINATION",w="SET_CURRENT_STATION",S="SET_STATION",x="SET_STATIONS_BULK",T=function(n){return{type:i,fullParam:n}},z=function(n){return{type:c,svgHeight:n}},k=function(n,e){return{type:o,svgWidth:n,canvas:e}},N=function(n){return{type:s,yPercentage:n}},M=function(n){return{type:u,branchSpacing:n}},E=function(n){return{type:l,paddingPercentage:n}},C=function(n){return{type:d,directionIndicatorX:n}},R=function(n){return{type:h,directionIndicatorY:n}},I=function(n){return{type:f,theme:n}},H=function(n){return{type:b,lineName:n}},P=function(n){return{type:g,direction:n}},D=function(n){return{type:p,platform:n}},F=function(n){return{type:j,lineNum:n}},B=function(n){return{type:m,psdNum:n}},A=function(n){return{type:O,panelType:n}},G=function(n){return{type:v,notes:n}},W=function(){return function(n,e){var t=e().param.notesGZMTR;n(G(t.concat([["","",0,0,!1]])))}},L=function(n,e){return function(t,r){var a=r().param.notesGZMTR;t(G(a.map((function(t,r){return r===n?e:t}))))}},K=function(n){return function(e,t){var r=t().param.notesGZMTR;e(G(r.filter((function(e,t){return t!==n}))))}},Z=function(n){return{type:y,namePosition:n}},J=function(n){return function(e,t){var r=t().param.namePosMTR;e(Z(Object(a.a)(Object(a.a)({},r),{},{isStagger:n})))}},U=function(){return function(n,e){var t=e().param.namePosMTR;n(Z(Object(a.a)(Object(a.a)({},t),{},{isFlip:!t.isFlip})))}},X=function(n){return{type:_,customisedMtrDestination:n}},V=function(n){return function(e,t){var r=t().param.customiseMTRDest;e(X(Object(a.a)(Object(a.a)({},r),{},{isLegacy:n})))}},Y=function(n){return function(e,t){var r=t().param.customiseMTRDest;e(X(Object(a.a)(Object(a.a)({},r),{},{terminal:n})))}},q=function(n){return{type:w,currentStation:n}},Q=function(n,e){return{type:S,stationId:n,station:e}},$=function(n){return{type:x,stations:n}},nn=function(){return function(n,e){var t=e().param.stn_list,i=Object.keys(t).reduce((function(n,e){return Object(a.a)(Object(a.a)({},n),{},Object(r.a)({},e,function(n){switch(n){case"linestart":return Object(a.a)(Object(a.a)({},t.lineend),{},{parents:[],children:t.lineend.parents.slice().reverse(),branch:{left:[],right:t.lineend.branch.left}});case"lineend":return Object(a.a)(Object(a.a)({},t.linestart),{},{parents:t.linestart.children.slice().reverse(),children:[],branch:{left:t.linestart.branch.right,right:[]}});default:return Object(a.a)(Object(a.a)({},t[n]),{},{parents:t[n].children.map((function(n){return"linestart"===n?"lineend":"lineend"===n?"linestart":n})).reverse(),children:t[n].parents.map((function(n){return"linestart"===n?"lineend":"lineend"===n?"linestart":n})).reverse(),branch:{left:t[n].branch.right,right:t[n].branch.left}})}}(e)))}),{});n($(i))}},en=function(n,e){return function(t,r){var i=r().param.stn_list[n];t(Q(n,Object(a.a)(Object(a.a)({},i),{},{name:e})))}},tn=function(n,e){return function(t,r){var i=r().param.stn_list[n];t(Q(n,Object(a.a)(Object(a.a)({},i),{},{secondaryName:e})))}},rn=function(n,e){return function(t,r){var i=r().param.stn_list[n];t(Q(n,Object(a.a)(Object(a.a)({},i),{},{num:e})))}},an=function(n,e,t){return function(r,i){var c=i().param.stn_list[n],o=c.transfer.info.map((function(n){return n.slice()}));if(o.length>e)o[e].push(t);else{for(var s=o.length;s<e;s++)o[s]=[];o[e]=[t]}r(Q(n,Object(a.a)(Object(a.a)({},c),{},{transfer:Object(a.a)(Object(a.a)({},c.transfer),{},{info:o})})))}},cn=function(n,e,t){return function(r,i){var c=i().param.stn_list[n];if(c.transfer.info.length>e&&c.transfer.info[e].length>t){var o=c.transfer.info.map((function(n,r){return r===e?n.filter((function(n,e){return e!==t})):n}));r(Q(n,Object(a.a)(Object(a.a)({},c),{},{transfer:Object(a.a)(Object(a.a)({},c.transfer),{},{info:o})})))}}},on=function(n,e,t,r){return function(i,c){var o=c().param.stn_list[n];if(o.transfer.info.length>e&&o.transfer.info[e].length>t){var s=o.transfer.info.map((function(n,a){return a===e?n.map((function(n,e){return e===t?[0,1,2,3,4,5].map((function(e){return void 0===r[e]?n[e]:r[e]})):n})):n}));i(Q(n,Object(a.a)(Object(a.a)({},o),{},{transfer:Object(a.a)(Object(a.a)({},o.transfer),{},{info:s})})))}}},sn=function(n,e,t){return function(r,i){var c=i().param.stn_list[n],o=c.transfer.osi_names.map((function(n){return n.slice()}));if(o.length>e)o[e]=t;else{for(var s=o.length;s<e;s++)o[s]=["\u8eca\u7ad9\u540d","Stn Name"];o[e]=t}r(Q(n,Object(a.a)(Object(a.a)({},c),{},{transfer:Object(a.a)(Object(a.a)({},c.transfer),{},{osi_names:o})})))}},un=function(n,e){return function(t,r){var i=r().param.stn_list[n];t(Q(n,Object(a.a)(Object(a.a)({},i),{},{transfer:Object(a.a)(Object(a.a)({},i.transfer),{},{tick_direc:e})})))}},ln=function(n,e){return function(t,r){var i=r().param.stn_list[n];t(Q(n,Object(a.a)(Object(a.a)({},i),{},{transfer:Object(a.a)(Object(a.a)({},i.transfer),{},{paid_area:e})})))}},dn=function(n,e,t){return function(i,c){var o=c().param.stn_list[n];i(Q(n,Object(a.a)(Object(a.a)({},o),{},{branch:Object(a.a)(Object(a.a)({},o.branch),{},Object(r.a)({},e,[t,o.branch[e][1]]))})))}},hn=function(n){return function(e,t){var i,c=t().param.stn_list;e($(Object(a.a)(Object(a.a)({},c),{},(i={},Object(r.a)(i,n[0].stnId,Object(a.a)(Object(a.a)({},c[n[0].stnId]),{},{branch:Object(a.a)(Object(a.a)({},c[n[0].stnId].branch),{},Object(r.a)({},n[0].direction,[c[n[0].stnId].branch[n[0].direction][0],n[0].first]))})),Object(r.a)(i,n[1].stnId,Object(a.a)(Object(a.a)({},c[n[1].stnId]),{},{branch:Object(a.a)(Object(a.a)({},c[n[1].stnId].branch),{},Object(r.a)({},n[1].direction,[c[n[1].stnId].branch[n[1].direction][0],n[1].first]))})),i))))}},fn=function(n,e){return function(t,i){var c,o=i().param.stn_list;t($(Object(a.a)(Object(a.a)({},o),{},(c={},Object(r.a)(c,n,Object(a.a)(Object(a.a)({},o[n]),{},{parents:o[n].parents.slice().reverse()})),Object(r.a)(c,e,Object(a.a)(Object(a.a)({},o[e]),{},{children:o[e].children.slice().reverse()})),c))))}},bn=function(n,e){return function(t,r){var i=r().param.stn_list[n];t(Q(n,Object(a.a)(Object(a.a)({},i),{},{facility:e})))}},gn=function(n,e){return function(t,r){var i=r().param.stn_list[n];i.services.includes(e)||t(Q(n,Object(a.a)(Object(a.a)({},i),{},{services:i.services.concat(e)})))}},pn=function(n,e){return function(t,r){var i=r().param.stn_list[n];i.services.includes(e)&&t(Q(n,Object(a.a)(Object(a.a)({},i),{},{services:i.services.filter((function(n){return n!==e}))})))}}},function(n,e,t){"use strict";t.d(e,"e",(function(){return o})),t.d(e,"a",(function(){return s})),t.d(e,"b",(function(){return u})),t.d(e,"c",(function(){return l})),t.d(e,"d",(function(){return d})),t.d(e,"i",(function(){return h})),t.d(e,"g",(function(){return f})),t.d(e,"j",(function(){return g})),t.d(e,"k",(function(){return p})),t.d(e,"h",(function(){return j})),t.d(e,"f",(function(){return O}));var r=t(6),a=t.n(r),i=t(9),c=t(2),o="SET_RMG_STYLE",s="SET_CANVAS_SCALE",u="SET_CANVAS_SCALE_STATUS",l="SET_CANVAS_TO_SHOW",d="SET_CANVAS_TO_SHOW_STATUS",h=function(n){return{type:o,rmgStyle:n}},f=function(n){return{type:s,canvasScale:n}},b=function(n){return{type:u,canvasScaleStatus:n}},g=function(){return function(){var n=Object(i.a)(a.a.mark((function n(e,t){var r;return a.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return e(b(c.g.loading)),n.prev=1,r=Number((t().app.canvasScale+.1).toFixed(1)),e(f(r)),n.next=6,window.rmgStorage.writeFile("rmgScale",r.toString());case 6:e(b(c.g.loaded)),n.next=12;break;case 9:n.prev=9,n.t0=n.catch(1),e(b(c.g.failed));case 12:case"end":return n.stop()}}),n,null,[[1,9]])})));return function(e,t){return n.apply(this,arguments)}}()},p=function(){return function(){var n=Object(i.a)(a.a.mark((function n(e,t){var r,i;return a.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return e(b(c.g.loading)),n.prev=1,r=t().app.canvasScale,i=Number(r.toFixed(1))<=.1?Number(r.toFixed(1)):Number((r-.1).toFixed(1)),e(f(i)),n.next=7,window.rmgStorage.writeFile("rmgScale",i.toString());case 7:e(b(c.g.loaded)),n.next=13;break;case 10:n.prev=10,n.t0=n.catch(1),e(b(c.g.failed));case 13:case"end":return n.stop()}}),n,null,[[1,10]])})));return function(e,t){return n.apply(this,arguments)}}()},j=function(n){return{type:l,canvasToShow:n}},m=function(n){return{type:d,canvasToShowStatus:n}},O=function(n){return function(){var e=Object(i.a)(a.a.mark((function e(t){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t(m(c.g.loading)),e.prev=1,t(j(n)),e.next=5,window.rmgStorage.writeFile("rmgCanvas",n);case 5:t(m(c.g.loaded)),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),t(m(c.g.failed));case 11:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(n){return e.apply(this,arguments)}}()}},,function(n,e){n.exports=ReactRedux},,function(n,e){n.exports=ReactI18next},,,function(n,e){n.exports=ReactRouterDOM},,,function(n,e,t){"use strict";t.d(e,"c",(function(){return c})),t.d(e,"a",(function(){return o})),t.d(e,"b",(function(){return s})),t.d(e,"d",(function(){return u}));var r=t(11),a=t(3),i=t.n(a),c=function n(e,t){if(["linestart","lineend"].includes(e)||t[e].parents.length>1||t[e].children.length>1)return 0;var r=t[e].parents[0];return r?1===t[r].children.length?n(r,t):0===t[r].children.indexOf(e)?1:-1:0},o=function(n){console.log("computing branches");for(var e=["linestart"],t=[["linestart"]],r=0;e.length;){var a=e.shift(),i=t[r].slice().reverse()[0]||null;for(i&&"linestart"!==a?t[r].push(a):t[r]=[a];"lineend"!==a;){var c=n[i=a].children;if(function(){switch(c.length){case 1:a=c[0];break;case 2:var o=n[i].branch.right[1];"through"===n[i].branch.right[0]?(t.push([a]),e.push(o)):0===r&&(t.push([i]),e.push(o)),a=c.filter((function(n){return n!==o}))[0]}}(),t[r].push(a),i===n[a].branch.left[1])break}r++}return t},s=function(n){console.log("computing routes");for(var e=["linestart"],t=[["linestart"]],r=0;e.length;){var a=e.shift(),i=t[r].slice().reverse()[0]||null;for(i&&"linestart"!==a?t[r].push(a):t[r]=[a];"lineend"!==a;){var c=n[i=a].children;if(function(){switch(c.length){case 1:a=c[0];break;case 2:var o=n[i].branch.right[1];"through"===n[i].branch.right[0]?(t.push(t[r].slice()),e.push(o)):0===r&&(t.push([i]),e.push(o)),a=c.filter((function(n){return n!==o}))[0]}}(),t[r].push(a),i===n[a].branch.left[1]&&"nonthrough"===n[a].branch.left[0])break}r++}return t},u=function(n){var e=i.a.useState([]),t=Object(r.a)(e,2),a=t[0],c=t[1];return i.a.useEffect((function(){if(console.log("computing tpo"),1!==n.length){var e=n.reduce((function(n,e){var t=n.indexOf(e.slice(-1)[0]);return n.slice(0,t).concat(e.slice(1),n.slice(t+1))}),["lineend"]).slice(0,-1);c(e)}else c(n[0].slice(1,-1))}),[n.toString()]),a}},,function(n,e){n.exports=Redux},function(n,e,t){"use strict";t.d(e,"c",(function(){return c})),t.d(e,"b",(function(){return o})),t.d(e,"a",(function(){return s}));var r=t(24),a=t(11),i=t(2),c=function(n){var e;"line_name"in n||(n.line_name=["\u8def\u7dda\u540d","Name of Line"]),"dest_legacy"in n||(n.dest_legacy=!1),delete n.fontZH,delete n.fontEN,delete n.weightZH,delete n.weightEN;for(var t=0,r=Object.entries(n.stn_list);t<r.length;t++){var i=Object(a.a)(r[t],2),c=i[0],o=i[1];"branch"in o||(n.stn_list[c].branch={left:[],right:[]},2===o.children.length?n.stn_list[c].branch.right=["through",o.children[1]]:n.stn_list[c].branch.right=[],2===o.parents.length?n.stn_list[c].branch.left=["through",o.parents[1]]:n.stn_list[c].branch.left=[])}n.psd_num="psd_num"in n?n.psd_num.toString():"1","line_num"in n||(n.line_num="1"),delete n.style,3===n.theme.length&&n.theme.push("#fff");for(var s=0,u=Object.entries(n.stn_list);s<u.length;s++){var l=Object(a.a)(u[s],2),d=l[0],h=l[1];"num"in h||(n.stn_list[d].num="00"),"interchange"in h&&h.interchange.map((function(n){return n.forEach((function(n){5===n.length&&n.splice(3,0,"#fff")}))}))}for(var f=0,b=Object.entries(n.stn_list);f<b.length;f++){var g=Object(a.a)(b[f],2),p=g[0],j=g[1];"osi22_end_p"===j.change_type&&(n.stn_list[p].change_type="osi22_pr"),"osi22_end_u"===j.change_type&&(n.stn_list[p].change_type="osi22_ur")}for(var m=0,O=Object.entries(n.stn_list);m<O.length;m++){var v=Object(a.a)(O[m],2),y=v[0];"interchange"in v[1]||(n.stn_list[y].interchange=[[]])}n.info_panel_type="info_panel_type"in n?function(n){switch(n){case"gz_1":case"panasonic":return"gz28";case"gz_2":return"gz6";case"gz_3":return"gz3";default:return n}}(n.info_panel_type):"gz28","direction_gz_x"in n||(n.direction_gz_x=50),"direction_gz_y"in n||(n.direction_gz_y=70);for(var _=0,w=Object.entries(n.stn_list);_<w.length;_++){var S,x,T,z,k=Object(a.a)(w[_],2),N=k[0],M=k[1];if(!("transfer"in M))n.stn_list[N].transfer={tick_direc:"none"===M.change_type||"int2"===M.change_type?"r":null===(S=M.change_type)||void 0===S?void 0:S.split("_")[1].split("").slice().reverse()[0],paid_area:-1===(null===(x=M.change_type)||void 0===x?void 0:x.indexOf("osi"))||"p"===(null===(T=M.change_type)||void 0===T?void 0:T.split("_")[1][0]),osi_names:-1!==(null===(z=M.change_type)||void 0===z?void 0:z.indexOf("osi"))?[M.interchange[1][0]]:[],info:2===M.interchange.length?[M.interchange[0],M.interchange[1].slice(1)]:M.interchange};delete n.stn_list[N].change_type,delete n.stn_list[N].interchange}for(var E=0,C=Object.entries(n.stn_list);E<C.length;E++){var R=Object(a.a)(C[E],2),I=R[0],H=R[1];"services"in H||(n.stn_list[I].services=["local"]),"facility"in H||(n.stn_list[I].facility="usage"in H?H.usage:""),delete n.stn_list[I].usage}return"customiseMTRDest"in n||(n.customiseMTRDest={isLegacy:n.dest_legacy||!1,terminal:!1}),delete n.dest_legacy,"svgWidth"in n||(n.svgWidth={destination:n.svg_dest_width,runin:n.svg_dest_width,railmap:n.svg_width,indoor:n.svg_width}),"indoor"in n.svgWidth||(n.svgWidth.indoor=n.svgWidth.railmap),delete n.svg_width,delete n.svg_dest_width,"notesGZMTR"in n||(n.notesGZMTR=[]),n.notesGZMTR=null===(e=n.notesGZMTR)||void 0===e?void 0:e.map((function(n){return 4===n.length?n.concat([!1]):n})),delete n.char_form,delete n.show_outer,delete n.strip_pc,delete n.txt_bg_gap,"namePosMTR"in n||(n.namePosMTR={isStagger:!0,isFlip:n.txt_flip}),delete n.txt_flip,Object.keys(n.stn_list).forEach((function(e){"secondaryName"in n.stn_list[e]?!1!==n.stn_list[e].secondaryName&&","===n.stn_list[e].secondaryName.join()&&(n.stn_list[e].secondaryName=!1):n.stn_list[e].secondaryName=!1,"type"in n.stn_list[e].transfer&&delete n.stn_list[e].transfer.type})),n},o=function(n,e){var t,a=Object(r.a)(e);try{for(a.s();!(t=a.n()).done;){var c=t.value;if(n[c])return n[c]}}catch(o){a.e(o)}finally{a.f()}return n[i.f.English]},s=function(n,e){return(e===i.k.GZMTR?((null===n||void 0===n?void 0:n.num)||"-")+": ":"")+(null===n||void 0===n?void 0:n.name.join().replace("\\"," "))}},function(n,e){n.exports=i18next},function(n,e,t){"use strict";t.d(e,"a",(function(){return a}));var r=t(3),a=Object(r.createContext)({})},,function(n,e,t){"use strict";var r;t.d(e,"a",(function(){return r})),t.d(e,"b",(function(){return a})),function(n){n.Barcelona="barcelona",n.Beijing="beijing",n.Changsha="changsha",n.Chengdu="chengdu",n.Chongqing="chongqing",n.Dongguan="dongguan",n.Edinburgh="edinburgh",n.Foshan="foshan",n.Glasgow="glasgow",n.Guangzhou="guangzhou",n.Hangzhou="hangzhou",n.HongKong="hongkong",n.Kansai="kansai",n.Kaohsiung="kaohsiung",n.London="london",n.Macao="macao",n.Madrid="madrid",n.Nanjing="nanjing",n.NewTaipei="newtaipei",n.Osaka="osaka",n.Oslo="oslo",n.Paris="paris",n.Qingdao="qingdao",n.SanFrancisco="sanfrancisco",n.Seoul="seoul",n.Shanghai="shanghai",n.Shenzhen="shenzhen",n.Singapore="singapore",n.Stockholm="stockholm",n.Taipei="taipei",n.Tianjin="tianjin",n.Tokyo="tokyo",n.Toronto="toronto",n.TyneAndWear="tyneandwear",n.Xian="xian",n.Other="other"}(r||(r={}));var a=[{id:r.Barcelona,country:"ES",name:{en:"Barcelona","zh-Hans":"\u5df4\u585e\u7f57\u90a3","zh-HK":"\u5df4\u585e\u9686\u62ff","zh-TW":"\u5df4\u585e\u9686\u7d0d"}},{id:r.Beijing,country:"CN",name:{en:"Beijing",zh:"\u5317\u4eac"}},{id:r.Changsha,country:"CN",name:{en:"Changsha","zh-Hans":"\u957f\u6c99","zh-Hant":"\u9577\u6c99"}},{id:r.Chengdu,country:"CN",name:{en:"Chengdu",zh:"\u6210\u90fd"}},{id:r.Chongqing,country:"CN",name:{en:"Chongqing","zh-Hans":"\u91cd\u5e86","zh-Hant":"\u91cd\u6176"}},{id:r.Dongguan,country:"CN",name:{en:"Dongguan","zh-Hans":"\u4e1c\u839e","zh-Hant":"\u6771\u839e"}},{id:r.Edinburgh,country:"GBSCT",name:{en:"Edinburgh",ga:"D\xf9n \xc8ideann","zh-Hans":"\u7231\u4e01\u5821","zh-Hant":"\u611b\u4e01\u5821"}},{id:r.Foshan,country:"CN",name:{en:"Foshan",zh:"\u4f5b\u5c71"}},{id:r.Glasgow,country:"GBSCT",name:{en:"Glasgow",ga:"Glaschu",zh:"\u683c\u62c9\u65af\u54e5"}},{id:r.Guangzhou,country:"CN",name:{en:"Guangzhou","zh-Hans":"\u5e7f\u5dde","zh-Hant":"\u5ee3\u5dde"}},{id:r.Hangzhou,country:"CN",name:{en:"Hangzhou",zh:"\u676d\u5dde"}},{id:r.HongKong,country:"HK",name:{en:"Hong Kong",zh:"\u9999\u6e2f"}},{id:r.Kansai,country:"JP",name:{en:"Kansai Area",ja:"\u8fd1\u757f\u5730\u65b9","zh-Hans":"\u8fd1\u757f\u5730\u65b9\uff08\u5173\u897f\u5730\u65b9\uff09","zh-Hant":"\u8fd1\u757f\u5730\u65b9\uff08\u95dc\u897f\u5730\u65b9\uff09"}},{id:r.Kaohsiung,country:"TW",name:{en:"Kaohsiung",zh:"\u9ad8\u96c4"}},{id:r.London,country:"GBENG",name:{en:"London","zh-Hans":"\u4f26\u6566","zh-Hant":"\u502b\u6566"}},{id:r.Macao,country:"MO",name:{en:"Macao",pt:"Macau","zh-Hans":"\u6fb3\u95e8","zh-Hant":"\u6fb3\u9580"}},{id:r.Madrid,country:"ES",name:{en:"Madrid","zh-Hans":"\u9a6c\u5fb7\u91cc","zh-Hant":"\u99ac\u5fb7\u91cc"}},{id:r.Nanjing,country:"CN",name:{en:"Nanjing",zh:"\u5357\u4eac"}},{id:r.NewTaipei,country:"TW",name:{en:"New Taipei",zh:"\u65b0\u5317"}},{id:r.Osaka,country:"JP",name:{en:"Osaka",ja:"\u5927\u962a",zh:"\u5927\u962a"}},{id:r.Oslo,country:"NO",name:{en:"Oslo","zh-Hans":"\u5965\u65af\u9646","zh-Hant":"\u5967\u65af\u9678"}},{id:r.Paris,country:"FR",name:{en:"Paris",zh:"\u5df4\u9ece"}},{id:r.Qingdao,country:"CN",name:{en:"Qingdao","zh-Hans":"\u9752\u5c9b","zh-Hant":"\u9752\u5cf6"}},{id:r.SanFrancisco,country:"US",name:{en:"San Francisco","zh-Hans":"\u65e7\u91d1\u5c71","zh-HK":"\u4e09\u85e9\u5e02","zh-TW":"\u820a\u91d1\u5c71"}},{id:r.Seoul,country:"KR",name:{en:"Seoul (Metropolitan Area)",ko:"\uc11c\uc6b8(\uc218\ub3c4\uad8c)","zh-Hans":"\u9996\u5c14\uff08\u9996\u90fd\u5708\uff09","zh-Hant":"\u9996\u723e\uff08\u9996\u90fd\u5708\uff09"}},{id:r.Shanghai,country:"CN",name:{en:"Shanghai",zh:"\u4e0a\u6d77"}},{id:r.Shenzhen,country:"CN",name:{en:"Shenzhen",zh:"\u6df1\u5733"}},{id:r.Singapore,country:"SG",name:{en:"Singapore",zh:"\u65b0\u52a0\u5761"}},{id:r.Stockholm,country:"SE",name:{en:"Stockholm","zh-Hans":"\u65af\u5fb7\u54e5\u5c14\u6469","zh-Hant":"\u65af\u5fb7\u54e5\u723e\u6469"}},{id:r.Taipei,country:"TW",name:{en:"Taipei",zh:"\u53f0\u5317"}},{id:r.Tianjin,country:"CN",name:{en:"Tianjin",zh:"\u5929\u6d25"}},{id:r.Tokyo,country:"JP",name:{en:"Tokyo (Greater Tokyo Area)",ja:"\u6771\u4eac\uff08\u9996\u90fd\u570f\uff09","zh-Hans":"\u4e1c\u4eac\uff08\u9996\u90fd\u5708\uff09","zh-Hant":"\u6771\u4eac\uff08\u9996\u90fd\u5708\uff09"}},{id:r.Toronto,country:"CA",name:{en:"Toronto","zh-Hans":"\u591a\u4f26\u591a","zh-Hant":"\u591a\u502b\u591a"}},{id:r.TyneAndWear,country:"GBENG",name:{en:"Tyne and Wear","zh-Hans":"\u6cf0\u6069-\u5a01\u5c14","zh-HK":"\u6cf0\u5a01","zh-TW":"\u6cf0\u6069-\u5a01\u723e"}},{id:r.Xian,country:"CN",name:{en:"Xi'an",zh:"\u897f\u5b89"}},{id:r.Other,country:"UN",name:{en:"Customise","zh-Hans":"\u81ea\u5b9a\u4e49","zh-Hant":"\u81ea\u8a02"}}]},,,function(n,e){n.exports=ReactDOM},function(n,e){n.exports=i18nextXHRBackend},function(n,e){n.exports=i18nextBrowserLanguageDetector},function(n,e){n.exports=ReduxThunk},,function(n,e,t){},,function(n,e,t){"use strict";t.r(e);var r=t(6),a=t.n(r),i=t(9),c=t(13),o=t(3),s=t.n(o),u=t(28),l=(t(33),t(22)),d=t.n(l),h=t(12),f=t(29),b=t.n(f),g=t(30),p=t.n(g);d.a.use(b.a).use(p.a).use(h.initReactI18next).init({fallbackLng:{"zh-CN":["zh-Hans","en"],"zh-Hant":["zh-HK","en"],"zh-HK":["zh-Hant","en"],"zh-TW":["zh-HK","zh-Hant"],default:["en"]},backend:{loadPath:"/RailMapGenerator/locale/{{lng}}.json"},interpolation:{escapeValue:!1}}).then((function(n){document.title=n("title"),document.documentElement.setAttribute("lang",d.a.language)}));var j,m,O,v,y=t(15),_=t(11),w=t(4),S=t(2),x=t(10),T=t(8),z=t(0),k=Object(w.makeStyles)((function(n){return Object(w.createStyles)({rootLight:{backgroundColor:n.palette.primary.main},rootDark:{backgroundColor:n.palette.background.paper},title:{flexGrow:1,color:"#fff"},menuButton:{color:"#fff"}})})),N=function(){var n=Object(h.useTranslation)(),e=n.t,t=n.i18n,r=k(),a=Object(w.useMediaQuery)("(prefers-color-scheme: dark)");return o.useMemo((function(){return Object(z.jsx)(w.AppBar,{position:"sticky",className:a?r.rootDark:r.rootLight,children:Object(z.jsxs)(w.Toolbar,{variant:"dense",children:[Object(z.jsx)(w.Typography,{variant:"h6",className:r.title,color:"textPrimary",children:"/RailMapGenerator".includes("uat")?e("titleUAT"):e("title")}),Object(z.jsx)(M,{}),Object(z.jsx)(E,{})]})})}),[a,t.language])},M=function(){var n=Object(h.useTranslation)().t,e=k(),t=Object(x.useDispatch)(),r=Object(x.useSelector)((function(n){return n.app.rmgStyle})),a=o.useState(null),i=Object(_.a)(a,2),c=i[0],s=i[1],u=function(n){return function(){t(Object(T.f)(n)),s(null)}};return o.useMemo((function(){return Object(z.jsxs)(z.Fragment,{children:[Object(z.jsx)(w.Tooltip,{title:n("toggle.tooltip"),children:Object(z.jsx)(w.IconButton,{onClick:function(n){return s(n.currentTarget)},className:e.menuButton,children:Object(z.jsx)(w.Icon,{children:"photo_library"})})}),Object(z.jsxs)(w.Menu,{anchorEl:c,open:Boolean(c),onClose:function(){return s(null)},children:[S.n[r].map((function(e){return Object(z.jsx)(w.MenuItem,{onClick:u(e),children:n("toggle."+e)},e)})),Object(z.jsx)(w.Divider,{style:{margin:"6px 0"}}),Object(z.jsx)(w.MenuItem,{onClick:u(S.a),children:n("toggle.all")})]})]})}),[r,c,e.menuButton])},E=function(){var n=Object(h.useTranslation)().t,e=k(),t=Object(x.useDispatch)();return o.useMemo((function(){return Object(z.jsxs)(z.Fragment,{children:[Object(z.jsx)(w.Tooltip,{title:n("zoom.out"),children:Object(z.jsx)(w.IconButton,{onClick:function(){return t(Object(T.k)())},className:e.menuButton,children:Object(z.jsx)(w.Icon,{children:"zoom_out"})})}),Object(z.jsx)(w.Tooltip,{title:n("zoom.in"),children:Object(z.jsx)(w.IconButton,{onClick:function(){return t(Object(T.j)())},className:e.menuButton,children:Object(z.jsx)(w.Icon,{children:"zoom_in"})})})]})}),[e.menuButton])},C=t(1),R=t(5),I=t(17),H=t(19),P=t(27),D=t(26),F=function(n){Object(P.a)(t,n);var e=Object(D.a)(t);function t(n){var r;return Object(I.a)(this,t),(r=e.call(this,n)).state={hasError:!1},r}return Object(H.a)(t,[{key:"componentDidCatch",value:function(n,e){}},{key:"render",value:function(){return this.state.hasError?Object(z.jsx)("h1",{children:"Something went wrong."}):this.props.children}}],[{key:"getDerivedStateFromError",value:function(n){return{hasError:!0}}}]),t}(s.a.Component),B=Object(w.makeStyles)((function(){return Object(w.createStyles)({root:{display:"flex",flexDirection:"row",overflowX:"scroll","&::before, &::after":{content:'""',margin:"auto"},"& > svg":{flex:"0 0 auto",border:"1px solid black"}}})})),A=function(){var n=B(),e=Object(x.useSelector)((function(n){return n.app.canvasScale})),t=Object(x.useSelector)((function(n){return n.param.svg_height})),r=Object(x.useSelector)((function(n){return n.param.svgWidth})),a=Object(x.useSelector)((function(n){return n.param.theme})),i=s.a.useCallback((function(n){var i;return{id:n,xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",height:t*e,viewBox:"0 0 ".concat(r[n]," ").concat(t),colorInterpolationFilters:"sRGB",style:(i={},Object(R.a)(i,"--rmg-svg-width",r[n]+"px"),Object(R.a)(i,"--rmg-svg-height",t+"px"),Object(R.a)(i,"--rmg-theme-colour",a[2]),Object(R.a)(i,"--rmg-theme-fg",a[3]),i)}}),[t,JSON.stringify(r),a,e]);return Object(z.jsx)("div",{className:n.root,children:Object(z.jsxs)(y.Switch,{children:[Object.values(S.k).map((function(n){return Object(z.jsx)(y.Route,{path:"/".concat(n),children:Object(z.jsx)(G,{style:n,canvasAvailable:Y[n],svgProps:i})},n)})),Object(z.jsx)(y.Redirect,{to:"/"+S.k.MTR})]})})},G=Object(o.memo)((function(n){var e=Object(x.useDispatch)(),t=Object(x.useSelector)((function(n){return n.app.canvasToShow}));return e(Object(T.i)(n.style)),Object(o.useEffect)((function(){["share"].concat(Object(c.a)(Object.values(S.c))).forEach((function(e){e in n.canvasAvailable||"share"===e?document.getElementById("css_"+e).href="/RailMapGenerator"+"/styles/".concat(e,"_").concat(n.style,".css"):document.getElementById("css_"+e).href=""})),![].concat(Object(c.a)(S.n[n.style]),[S.a]).includes(t)&&e(Object(T.f)(S.a))}),[]),Object(z.jsx)(z.Fragment,{children:Object.keys(n.canvasAvailable).map((function(e){return[S.a,e].includes(t)&&Object(z.jsx)(s.a.Suspense,{fallback:Object(z.jsx)(w.CircularProgress,{}),children:Object(z.jsx)(F,{children:Object(z.jsxs)("svg",Object(C.a)(Object(C.a)({},n.svgProps(e)),{},{children:[Object(z.jsx)("rect",{id:"canvas-bg",fill:"white",style:{height:"var(--rmg-svg-height)",width:"var(--rmg-svg-width)"}}),n.canvasAvailable[e],Object(z.jsx)("rect",{id:"canvas-border",fill:"none",strokeWidth:3,stroke:"none",style:{height:"var(--rmg-svg-height)",width:"var(--rmg-svg-width)"}})]}))})},e)}))})})),W=Object(o.lazy)((function(){return t.e(96).then(t.bind(null,141))})),L=Object(o.lazy)((function(){return t.e(93).then(t.bind(null,135))})),K=Object(o.lazy)((function(){return t.e(74).then(t.bind(null,121))})),Z=Object(o.lazy)((function(){return t.e(94).then(t.bind(null,136))})),J=Object(o.lazy)((function(){return t.e(75).then(t.bind(null,122))})),U=Object(o.lazy)((function(){return t.e(97).then(t.bind(null,123))})),X=Object(o.lazy)((function(){return t.e(95).then(t.bind(null,137))})),V=Object(o.lazy)((function(){return t.e(76).then(t.bind(null,142))})),Y=(v={},Object(R.a)(v,S.k.GZMTR,(j={},Object(R.a)(j,S.c.RunIn,Object(z.jsx)(W,{})),Object(R.a)(j,S.c.RailMap,Object(z.jsx)(L,{})),j)),Object(R.a)(v,S.k.MTR,(m={},Object(R.a)(m,S.c.Destination,Object(z.jsx)(K,{})),Object(R.a)(m,S.c.RailMap,Object(z.jsx)(Z,{})),m)),Object(R.a)(v,S.k.SHMetro,(O={},Object(R.a)(O,S.c.Destination,Object(z.jsx)(J,{})),Object(R.a)(O,S.c.RunIn,Object(z.jsx)(U,{})),Object(R.a)(O,S.c.RailMap,Object(z.jsx)(X,{})),Object(R.a)(O,S.c.Indoor,Object(z.jsx)(V,{})),O)),v),q=A,Q=o.lazy((function(){return t.e(86).then(t.bind(null,134))})),$=o.lazy((function(){return t.e(83).then(t.bind(null,138))})),nn=o.lazy((function(){return t.e(78).then(t.bind(null,139))})),en=o.lazy((function(){return t.e(88).then(t.bind(null,133))})),tn=o.lazy((function(){return t.e(82).then(t.bind(null,124))})),rn=Object(w.makeStyles)((function(n){var e;return Object(w.createStyles)({root:Object(R.a)({display:"flex",flexDirection:"row",height:"100%"},n.breakpoints.down("xs"),{flexDirection:"column"}),typography:{background:n.palette.background.default},tab:(e={padding:"6px 24px",height:48,"& .MuiTab-wrapper":{flexDirection:"row"}},Object(R.a)(e,n.breakpoints.up("sm"),{"& .MuiTab-wrapper":{justifyContent:"flex-start"}}),Object(R.a)(e,n.breakpoints.down("xs"),{minWidth:"calc(100% / 5)"}),Object(R.a)(e,"&.MuiTab-labelIcon",{minHeight:"unset","& .MuiTab-wrapper":{"& > *:first-child":{marginBottom:0},"& > *:not(first-child)":{paddingLeft:8}}}),e),tabs:{overflow:"auto","&::-webkit-scrollbar":{width:0},scrollbarWidth:"none",WebkitOverflowScrolling:"touch"},tabpanel:{overflow:"auto",flex:1,padding:n.spacing(3),paddingBottom:0,height:"calc(100% - ".concat(n.spacing(3),"px)"),display:"flex",justifyContent:"center",alignItems:"flex-start"}})}));function an(){var n=Object(h.useTranslation)(),e=n.t,t=n.i18n,r=rn(),a=Object(w.useTheme)(),i=Object(w.useMediaQuery)(a.breakpoints.down("xs")),c=o.useState(0),s=Object(_.a)(c,2),u=s[0],l=s[1],d=o.useMemo((function(){return Object(z.jsx)(w.Typography,{className:"".concat(r.typography," ").concat(r.tabs),component:"div",children:Object(z.jsx)(w.Tabs,{value:u,orientation:i?"horizontal":"vertical",indicatorColor:"primary",textColor:"primary",onChange:function(n,e){return l(e)},variant:"scrollable",scrollButtons:"off",children:[["file","insert_drive_file"],["layout","panorama"],["design","brush"],["stations","directions_transit"],["info","info"]].map((function(n,t){return Object(z.jsx)(w.Tab,{label:Object(z.jsx)("span",{children:e("tab."+n[0])}),icon:Object(z.jsx)(w.Icon,{children:n[1]}),className:r.tab},t)}))})})}),[u,t.language,r.tab,i]);return Object(z.jsxs)("div",{className:r.root,children:[d,Object(z.jsx)(w.Typography,{className:"".concat(r.typography," ").concat(r.tabpanel),component:"div",role:"tabpanel",children:Object(z.jsx)(o.Suspense,{fallback:Object(z.jsx)(w.CircularProgress,{}),children:function(n){switch(n){case 0:return Object(z.jsx)(Q,{});case 1:return Object(z.jsx)($,{});case 2:return Object(z.jsx)(nn,{});case 3:return Object(z.jsx)(en,{});case 4:return Object(z.jsx)(tn,{});default:return Object(z.jsx)(Q,{})}}(u)})})]})}function cn(){return Object(z.jsx)(o.Suspense,{fallback:Object(z.jsx)(w.CircularProgress,{}),children:Object(z.jsx)(an,{})})}var on=t(18),sn=t(23),un=Object(w.createMuiTheme)({palette:{type:"dark",primary:{main:"#bb86fc"},secondary:{main:"#018786"},error:{main:"#cf6679"}},overrides:{MuiDialog:{paper:{minWidth:280}}}}),ln=Object(w.createMuiTheme)({palette:{primary:{light:"#bb86fc",main:"#6200ee"},secondary:{main:"#018786"},error:{main:"#b00020"}},overrides:{MuiDialog:{paper:{minWidth:280}}}});function dn(){var n=Object(w.useMediaQuery)("(prefers-color-scheme: dark)")?un:ln;return Object(z.jsx)(y.BrowserRouter,{basename:"/RailMapGenerator",children:Object(z.jsxs)(w.ThemeProvider,{theme:n,children:[Object(z.jsx)(s.a.Suspense,{fallback:Object(z.jsx)(w.LinearProgress,{}),children:Object(z.jsx)(N,{})}),Object(z.jsx)(hn,{})]})})}var hn=function(){var n=Object(x.useSelector)((function(n){return n.param})),e=JSON.stringify(n);Object(o.useEffect)((function(){window.rmgStorage.writeFile("rmgParam",e).then()}),[e]);var t=Object.keys(n.stn_list).reduce((function(e,t){return e+t+function(){for(var n=arguments.length,e=new Array(n),t=0;t<n;t++)e[t]=arguments[t];return function(n){return e.reduce((function(e,t){return e+JSON.stringify(n[t])}),"")}}("parents","children","branch")(n.stn_list[t])}),""),r=Object(o.useMemo)((function(){return Object(on.a)(n.stn_list)}),[t]),a=Object(o.useMemo)((function(){return Object(on.b)(n.stn_list)}),[t]),i=Object(on.d)(r);return Object(z.jsxs)(z.Fragment,{children:[Object(z.jsxs)(sn.a.Provider,{value:{branches:r,routes:a,deps:t,tpo:i},children:[Object(z.jsx)("div",{style:{overflowY:"auto"},children:Object(z.jsx)(q,{})}),Object(z.jsx)("div",{style:{flex:1,overflow:"hidden"},children:Object(z.jsx)(cn,{})})]}),Object(z.jsx)("canvas",{style:{display:"none"}})]})},fn=t(21);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var bn=function(){function n(){Object(I.a)(this,n),this.currentBusyFilename=void 0,this.currentBusyFilename=!1}return Object(H.a)(n,[{key:"init",value:function(){var n=Object(i.a)(a.a.mark((function n(){return a.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(console.warn("Using localStorage, please update your browser"),window.localStorage){n.next=4;break}throw alert("Local storage is not available! Please upgrade to a newer browser!"),new Error("LocalStorage unavailable");case 4:n.prev=4,window.localStorage.setItem("storage_test","1"),window.localStorage.removeItem("storage_test"),n.next=13;break;case 9:throw n.prev=9,n.t0=n.catch(4),alert("Local storage is not accessible! Please modify your browser's settings or try with another browser!"),new Error("LocalStorage no write permission");case 13:case"end":return n.stop()}}),n,null,[[4,9]])})));return function(){return n.apply(this,arguments)}}()},{key:"writeFile",value:function(){var n=Object(i.a)(a.a.mark((function n(e,t){return a.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:this.currentBusyFilename===e&&console.warn("Attempt to write",e,"while write process is not finished!"),this.currentBusyFilename=e,window.localStorage.setItem(e,t),this.currentBusyFilename=!1;case 4:case"end":return n.stop()}}),n,this)})));return function(e,t){return n.apply(this,arguments)}}()},{key:"readFile",value:function(){var n=Object(i.a)(a.a.mark((function n(e){var t;return a.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(this.currentBusyFilename===e&&console.warn("Attempt to read",e,"while write process is not finished!"),t=window.localStorage.getItem(e)){n.next=4;break}throw new Error("FILE_NOT_FOUND");case 4:return n.abrupt("return",t);case 5:case"end":return n.stop()}}),n,this)})));return function(e){return n.apply(this,arguments)}}()},{key:"deleteFile",value:function(){var n=Object(i.a)(a.a.mark((function n(e){return a.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:this.currentBusyFilename===e&&console.warn("Attempt to delete",e,"while write process is not finished!"),this.currentBusyFilename=e,window.localStorage.removeItem(e),this.currentBusyFilename=!1;case 4:case"end":return n.stop()}}),n,this)})));return function(e){return n.apply(this,arguments)}}()}]),n}();function gn(){return(gn=Object(i.a)(a.a.mark((function n(){return a.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(window.indexedDB){n.next=3;break}return console.log("IndexedDB not supported"),n.abrupt("return",new bn);case 3:return n.next=5,new Promise((function(n){try{var e=window.indexedDB.open("indexeddb_feature_detection",1);e.onerror=function(e){console.log("IndexedDB can NOT be accessed:",e),console.log("Fallback to LocalStorage"),n(new bn)},e.onsuccess=function(){console.log("IndexedDB can be accessed"),n(new bn)}}catch(t){console.warn("Error while opening IndexedDB:",t),n(new bn)}}));case 5:return n.abrupt("return",n.sent);case 6:case"end":return n.stop()}}),n)})))).apply(this,arguments)}var pn=t(20),jn=t(31),mn=t.n(jn),On={rmgStyle:S.k.MTR,canvasScale:1,canvasScaleStatus:S.g.init,canvasToShow:S.a,canvasToShowStatus:S.g.init};var vn=t(25),yn=t(7),_n={svgWidth:{destination:100,runin:100,railmap:100,indoor:100},svg_height:100,y_pc:50,padding:10,branch_spacing:10,direction:S.m.left,platform_num:"1",theme:[vn.a.HongKong,"twl","#E2231A",S.h.white],line_name:["\u7dda","line"],current_stn_idx:"",stn_list:{},namePosMTR:{isStagger:!0,isFlip:!0},customiseMTRDest:{isLegacy:!1,terminal:!1},line_num:"1",psd_num:"1",info_panel_type:S.i.gz1,notesGZMTR:[],direction_gz_x:0,direction_gz_y:0};var wn,Sn=Object(pn.combineReducers)({app:function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:On,e=arguments.length>1?arguments[1]:void 0;switch(e.type){case T.e:n.rmgStyle=e.rmgStyle;break;case T.a:n.canvasScale=e.canvasScale;break;case T.b:n.canvasScaleStatus=e.canvasScaleStatus;break;case T.c:n.canvasToShow=e.canvasToShow;break;case T.d:n.canvasToShowStatus=e.canvasToShowStatus}return Object(C.a)({},n)},param:function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:_n,e=arguments.length>1?arguments[1]:void 0;switch(e.type){case yn.g:return e.fullParam;case yn.r:n.svg_height=e.svgHeight;break;case yn.s:n.svgWidth[e.canvas]=e.svgWidth;break;case yn.u:n.y_pc=e.yPercentage;break;case yn.a:n.branch_spacing=e.branchSpacing;break;case yn.l:n.padding=e.paddingPercentage;break;case yn.e:n.direction_gz_x=e.directionIndicatorX;break;case yn.f:n.direction_gz_y=e.directionIndicatorY;break;case yn.t:n.theme=e.theme;break;case yn.h:n.line_name=e.lineName;break;case yn.d:n.direction=e.direction;break;case yn.n:n.platform_num=e.platform;break;case yn.i:n.line_num=e.lineNum;break;case yn.o:n.psd_num=e.psdNum;break;case yn.m:n.info_panel_type=e.panelType;break;case yn.k:n.notesGZMTR=e.notes;break;case yn.j:n.namePosMTR=e.namePosition;break;case yn.c:n.customiseMTRDest=e.customisedMtrDestination;break;case yn.b:n.current_stn_idx=e.currentStation;break;case yn.p:n.stn_list[e.stationId]=e.station;break;case yn.q:n.stn_list=e.stations}return Object(C.a)({},n)}}),xn=Object(pn.createStore)(Sn,Object(pn.applyMiddleware)(mn.a));"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(n){n.unregister()})).catch((function(n){console.error(n.message)})),(wn=document.head).append.apply(wn,Object(c.a)(["share"].concat(Object(c.a)(Object.values(S.c))).map((function(n){var e=document.createElement("link");return e.rel="stylesheet",e.id="css_"+n,e}))));(function(){return gn.apply(this,arguments)})().then(function(){var n=Object(i.a)(a.a.mark((function n(e){var r,i,c,o;return a.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,e.init();case 2:return n.prev=2,n.next=5,e.readFile("rmgParam");case 5:return r=n.sent,i=Object(fn.c)(JSON.parse(r)),n.next=9,e.writeFile("rmgParam",JSON.stringify(i));case 9:n.next=20;break;case 11:return n.prev=11,n.t0=n.catch(2),console.warn("Error in reading rmgParam",n.t0),n.next=16,t.e(0).then(t.bind(null,81));case 16:return c=n.sent,o=Object(fn.c)(c.default),n.next=20,e.writeFile("rmgParam",JSON.stringify(o));case 20:return n.prev=20,window.rmgStorage=e,n.finish(20);case 23:case"end":return n.stop()}}),n,null,[[2,11,20,23]])})));return function(e){return n.apply(this,arguments)}}()).then(Object(i.a)(a.a.mark((function n(){var e;return a.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,window.rmgStorage.readFile("rmgParam");case 2:e=n.sent,xn.dispatch(Object(yn.K)(JSON.parse(e)));case 4:case"end":return n.stop()}}),n)})))).then(Object(i.a)(a.a.mark((function n(){var e,t,r;return a.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,window.rmgStorage.readFile("rmgScale");case 3:e=n.sent,(t=Number(e))>=.1&&xn.dispatch(Object(T.g)(t)),n.next=15;break;case 8:return n.prev=8,n.t0=n.catch(0),console.warn("Error in reading rmgScale file",n.t0),console.log("Initiating rmgScale as 1"),n.next=14,window.rmgStorage.writeFile("rmgScale","1");case 14:xn.dispatch(Object(T.g)(1));case 15:return n.prev=15,n.next=18,window.rmgStorage.readFile("rmgCanvas");case 18:r=n.sent,xn.dispatch(Object(T.h)(r)),n.next=29;break;case 22:return n.prev=22,n.t1=n.catch(15),console.warn("Error in reading rmgCanvas file",n.t1),console.log('Initiating rmgCanvas as "all"'),n.next=28,window.rmgStorage.writeFile("rmgCanvas",S.a);case 28:xn.dispatch(Object(T.h)(S.a));case 29:window.rmgStore=xn;case 30:case"end":return n.stop()}}),n,null,[[0,8],[15,22]])})))).then((function(){u.render(Object(z.jsx)(x.Provider,{store:xn,children:Object(z.jsx)(dn,{})}),document.getElementById("root"))})).then((function(){setInterval(Object(i.a)(a.a.mark((function n(){return a.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,window.rmgStorage.writeFile("rmgParamRedux",JSON.stringify(window.rmgStore.getState().param));case 2:console.log("Parameter auto saved!");case 3:case"end":return n.stop()}}),n)}))),6e4)}))}],[[35,98,99]]]);
//# sourceMappingURL=main.b320a203.chunk.js.map