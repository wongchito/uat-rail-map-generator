{"version":3,"file":"static/js/railmapSHMetro.aea8937f.chunk.js","mappings":"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","sources":["svgs/railmap/methods/share.ts","svgs/railmap/methods/shmetro-coline.ts","svgs/railmap/main/station/station-shmetro.tsx","svgs/railmap/main/coline/coline-shmetro.tsx","svgs/railmap/main/main-shmetro.tsx","svgs/railmap/railmap-shmetro.tsx"],"sourcesContent":["import * as Global from '../../../methods';\nimport { RMGParam, ShortDirection, StationDict, StationInfo } from '../../../constants/constants';\n\n/**\n * Compute the adjacency list of the graph.\n * @param stnList Key-value pairs of station info\n * @param leftW Callback of left wide factor\n * @param rightW Callback of right wide factor\n */\nexport const adjacencyList = (\n    stnList: { [stnId: string]: StationInfo },\n    leftW: (stnList: { [stnId: string]: StationInfo }, stnId: string) => number,\n    rightW: (stnList: { [stnId: string]: StationInfo }, stnId: string) => number\n) => {\n    return Object.keys(stnList).reduce(\n        (acc, cur) => ({\n            ...acc,\n            [cur]: stnList[cur].children.reduce(\n                (a, c) => ({ ...a, [c]: 1 + leftW(stnList, c) + rightW(stnList, cur) }),\n                {}\n            ),\n        }),\n        {} as { [from: string]: { [to: string]: number } }\n    );\n};\n\n/**\n * Compute critical path and its length from `from` node to `to` node with critical path method.\n * @param from ID of station on the left\n * @param to ID of station on the right\n * @param adjMat Adjacency matrix in the form of `Object` returned from `adjacencyList` method.\n */\nexport const criticalPathMethod = (from: string, to: string, adjMat: ReturnType<typeof adjacencyList>) => {\n    if (from === to) {\n        return { len: 0, nodes: [from] };\n    }\n    let allLengths: number[] = [];\n    let criticalPaths: string[][] = [];\n    Object.keys(adjMat[from]).forEach(child => {\n        let cp = criticalPathMethod(child, to, adjMat);\n        if (cp.len < 0) return;\n        allLengths.push(adjMat[from][child] + cp.len);\n        cp.nodes.unshift(from);\n        criticalPaths.push(cp.nodes);\n    });\n    let maxLength = Math.max(...allLengths);\n    return {\n        len: maxLength,\n        nodes: criticalPaths[allLengths.indexOf(maxLength)],\n    };\n};\n\nexport const getXShareMTR = (stnId: string, adjMat: ReturnType<typeof adjacencyList>, branches: string[][]) => {\n    let criticalPath = criticalPathMethod('linestart', 'lineend', adjMat);\n    if (criticalPath.nodes.includes(stnId)) {\n        return criticalPathMethod(criticalPath.nodes[1], stnId, adjMat).len;\n    } else {\n        // must has 1 parent and 1 child only\n        let branchOfStn = branches.filter(branch => branch.includes(stnId))[0];\n\n        let partSource = stnId;\n        while (!criticalPath.nodes.includes(partSource)) {\n            partSource = branchOfStn[branchOfStn.indexOf(partSource) - 1];\n        }\n        let partSink = stnId;\n        while (!criticalPath.nodes.includes(partSink)) {\n            partSink = branchOfStn[branchOfStn.indexOf(partSink) + 1];\n        }\n\n        let leftOpenJaw = partSource === 'linestart';\n        let rightOpenJaw = partSink === 'lineend';\n\n        // expand to fit\n        let lens = [];\n        if (!leftOpenJaw && !rightOpenJaw) {\n            lens[0] = criticalPathMethod(criticalPath.nodes[1], partSource, adjMat).len;\n            lens[1] = criticalPathMethod(partSource, partSink, adjMat).len;\n            lens[2] = criticalPathMethod(partSource, stnId, adjMat).len;\n            lens[3] = criticalPathMethod(stnId, partSink, adjMat).len;\n        } else if (leftOpenJaw) {\n            lens[0] = 0;\n            lens[1] = criticalPathMethod(criticalPath.nodes[1], partSink, adjMat).len;\n            lens[2] = criticalPathMethod(branchOfStn[1], stnId, adjMat).len;\n            lens[3] = criticalPathMethod(stnId, partSink, adjMat).len;\n        } else {\n            // right open jaw\n            lens[0] = criticalPathMethod(criticalPath.nodes[1], partSource, adjMat).len;\n            lens[1] = criticalPathMethod(partSource, criticalPath.nodes.slice(-2)[0], adjMat).len;\n            lens[2] = criticalPathMethod(partSource, stnId, adjMat).len;\n            lens[3] = criticalPathMethod(stnId, branchOfStn.slice(-2)[0], adjMat).len;\n        }\n        return lens[0] + (lens[2] * lens[1]) / (lens[2] + lens[3]);\n    }\n};\n\nconst getYShare = (stnId: string, stnList: { [stnId: string]: StationInfo }) => {\n    return Global.getYShareMTR(stnId, stnList);\n};\n\n/**\n * Vertical position (in pixels) of station icon related to vertical position of line.\n */\nexport const getYReal = (stnId: string, param: RMGParam) => {\n    return -getYShare(stnId, param.stn_list) * param.branch_spacing;\n};\n\nconst _isPredecessor = (stnId1: string, stnId2: string, routes: string[][]) => {\n    for (let route of routes) {\n        let idx1 = route.indexOf(stnId1);\n        let idx2 = route.indexOf(stnId2);\n        if (idx2 !== -1 && idx2 < idx1) return true;\n    }\n    return false;\n};\n\nconst _isSuccessor = (stnId1: string, stnId2: string, routes: string[][]) => {\n    for (let route of routes) {\n        let idx1 = route.indexOf(stnId1);\n        let idx2 = route.indexOf(stnId2);\n        if (idx1 !== -1 && idx1 < idx2) return true;\n    }\n    return false;\n};\n\nexport const getStnState = (\n    currentId: string,\n    routes: string[][],\n    direction: 'l' | 'r'\n): { [stnId: string]: -1 | 0 | 1 } => {\n    console.log(\"computing stations' states\");\n    return [...new Set(([] as string[]).concat(...routes))].reduce(\n        (acc, cur: string) => ({\n            ...acc,\n            [cur]:\n                cur === currentId\n                    ? 0\n                    : (\n                          direction === ShortDirection.right\n                              ? _isSuccessor(currentId, cur, routes)\n                              : _isPredecessor(currentId, cur, routes)\n                      )\n                    ? 1\n                    : -1,\n        }),\n        {}\n    );\n};\n\nexport class Stations {\n    yShares = {} as { [stnId: string]: number };\n    xShares = {} as { [stnId: string]: number };\n    namePoss = {} as { [stnId: string]: boolean };\n    stnList = {} as StationDict;\n    criticalPath = {} as { len: number; nodes: string[] };\n\n    constructor(data: { stnList?: any; criticalPath?: any }) {\n        this.stnList = data.stnList;\n        this.criticalPath = data.criticalPath;\n    }\n\n    /**\n     * Increment of the weight of in-bound edge of a station, which increases the horizontal interval from its parents.\n     */\n    protected leftWideFactor = (stnId: string) => {\n        return 0;\n    };\n\n    /**\n     * Increment of the weight of out-bound edge of a station, which increases the horizontal interval from its children.\n     */\n    protected rightWideFactor = (stnId: string) => {\n        return 0;\n    };\n\n    /**\n     * Path weight from station 1 to station 2 (station 2 must be a child of station 1, otherwise return `-Infinity`).\n     */\n    public pathWeight = (stnId1: string, stnId2: string) => {\n        if (!this.stnList[stnId1].children.includes(stnId2)) {\n            return -Infinity;\n        }\n        return 1 + this.rightWideFactor(stnId1) + this.leftWideFactor(stnId2);\n    };\n\n    protected getYShare(stnId: string, branches?: string[][]): number {\n        if (stnId in this.yShares) return this.yShares[stnId];\n\n        if (\n            ['linestart', 'lineend'].includes(stnId) ||\n            this.stnList[stnId].parents.length > 1 ||\n            this.stnList[stnId].children.length > 1\n        ) {\n            this.yShares[stnId] = 0;\n            return 0;\n        }\n        var stnPred = this.stnList[stnId].parents[0];\n        if (stnPred) {\n            // parent exist\n            if (this.stnList[stnPred].children.length === 1) {\n                // no sibling, then y same as parent\n                let res = this.getYShare(stnPred);\n                this.yShares[stnId] = res;\n                return res;\n            } else {\n                // sibling exists, then y depends on its idx of being children\n                let res: 1 | -1 = this.stnList[stnPred].children.indexOf(stnId) === 0 ? 1 : -1;\n                this.yShares[stnId] = res;\n                return res;\n            }\n        } else {\n            // no parent, must be linestart\n            this.yShares[stnId] = 0;\n            return 0;\n        }\n    }\n\n    static getYShares(stnList: StationDict, branches?: string[][]) {\n        console.log('computing y shares');\n        let stations = new this({ stnList });\n\n        Object.keys(stnList).forEach(stnId => {\n            if (['linestart', 'lineend'].includes(stnId)) return;\n            if (stnId in stations.yShares) return;\n            stations.getYShare(stnId, branches);\n        });\n\n        return stations.yShares;\n    }\n\n    /**\n     * Parameters of the arcs involved in the `<path>` element.\n     */\n    private pathTurnParams = (branchSpacing: number) => {\n        let tr = 35; // turning radius\n        let dx_a = tr / 2; // dx of a\n        let dy_a = tr - dx_a * Math.sqrt(3); // dy of a\n        let dy_l = branchSpacing - 2 * dy_a; // dy of l\n        let dx_l = dy_l * Math.sqrt(3); // dx of l\n        return { tr, dx_a, dy_a, dx_l, dy_l };\n    };\n\n    /**\n     * Path segment from a station towards its southeast (lower-right).\n     */\n    private pathTurnSE = (branchSpacing: number) => {\n        let { tr, dx_a, dy_a, dx_l, dy_l } = this.pathTurnParams(branchSpacing);\n        return `a ${tr},${tr} 0 0,1 ${dx_a},${dy_a} l ${dx_l},${dy_l} a ${tr},${tr} 0 0,0 ${dx_a},${dy_a}`;\n    };\n\n    /**\n     * Path segment from a station towards its northeast (upper-right).\n     */\n    private pathTurnNE = (branchSpacing: number) => {\n        let { tr, dx_a, dy_a, dx_l, dy_l } = this.pathTurnParams(branchSpacing);\n        return `a ${tr},${tr} 0 0,0 ${dx_a},${-dy_a} l ${dx_l},${-dy_l} a ${tr},${tr} 0 0,1 ${dx_a},${-dy_a}`;\n    };\n\n    /**\n     * Generate `d` attribute of `<path>` element through all stations input.\n     */\n    protected _linePath(\n        stnIds: string[],\n        lineXs: [number, number],\n        branches: string[][],\n        realXs: { [stnId: string]: number },\n        realYs: { [stnId: string]: number },\n        branchSpacing: number,\n        cp: { len: number; nodes: string[] },\n        e: number\n    ) {\n        var [prevId, prevY, prevX] = [] as unknown as [string, number, number];\n        var path = [] as string[];\n\n        let { dx_a, dx_l } = this.pathTurnParams(branchSpacing);\n        let stnDX = dx_a + dx_l / 2;\n        let stnExtraH = ((lineXs[1] - lineXs[0]) / cp.len) * 2;\n        let stnSpareH = ((lineXs[1] - lineXs[0]) / cp.len - 2 * stnDX) / 2;\n        if (stnSpareH + stnExtraH < 0) {\n            console.warn(`SVG width too small! ${stnSpareH + stnExtraH}`);\n        }\n\n        stnIds.forEach(stnId => {\n            let x = realXs[stnId];\n            let y = realYs[stnId];\n            if (!prevY && prevY !== 0) {\n                [prevId, prevX, prevY] = [stnId, x, y];\n                if (stnIds.length === 1) {\n                    path.push(`M ${x},${y}`);\n                } else if (!branches[0].includes(stnId)) {\n                    // started from branch\n                    path.push(`M ${x},${y}`);\n                } else if (branches[0].includes(stnIds[1])) {\n                    // started from branching station, this is main line\n                    path.push(`M ${x},${y}`);\n                } else {\n                    // started form branching station, this is branch line\n                    if (realXs[stnIds[1]] > 0) {\n                        path.push(`M ${x},${y + e}`);\n                    }\n                    if (realYs[stnIds[1]] < 0) {\n                        path.push(`M ${x},${y - e}`);\n                    }\n                }\n                return;\n            }\n            if (y > prevY) {\n                path.push(\n                    y === 0\n                        ? `h ${x - prevX - stnExtraH * this.leftWideFactor(stnId) - stnSpareH - stnDX * 2}`\n                        : `h ${stnExtraH * this.rightWideFactor(prevId) + stnSpareH}`\n                );\n                path.push(this.pathTurnSE(branchSpacing));\n            } else if (y < prevY) {\n                path.push(\n                    y === 0\n                        ? `h ${x - prevX - stnExtraH * this.leftWideFactor(stnId) - stnSpareH - stnDX * 2}`\n                        : `h ${stnExtraH * this.rightWideFactor(prevId) + stnSpareH}`\n                );\n                path.push(this.pathTurnNE(branchSpacing));\n            }\n            path.push(`H ${x}`);\n            [prevId, prevX, prevY] = [stnId, x, y];\n        });\n\n        // simplify path\n        return path.join(' ').replace(/( H ([\\d.]+))+/g, ' H $2');\n    }\n\n    static drawLine(\n        branches: string[][],\n        stnStates: { [stnId: string]: -1 | 0 | 1 },\n        stnList: { [stnId: string]: StationInfo },\n        lineXs: [number, number],\n        xs: { [stnId: string]: number },\n        ys: { [stnId: string]: number },\n        branchSpacing: number,\n        cp: { len: number; nodes: string[] },\n        e: number = 9.68\n    ) {\n        let linePaths = { main: [] as string[], pass: [] as string[] };\n        branches.forEach((branch, i) => {\n            branch = branch.filter(stnId => !['linestart', 'lineend'].includes(stnId));\n            var lineMainStns = branch.filter(stnId => stnStates[stnId] >= 0);\n            var linePassStns = branch.filter(stnId => stnStates[stnId] <= 0);\n\n            if (lineMainStns.length === 1) {\n                linePassStns = branch;\n            }\n\n            if (lineMainStns.filter(stnId => linePassStns.indexOf(stnId) !== -1).length === 0 && lineMainStns.length) {\n                // if two set disjoint\n                if (linePassStns[0] === branch[0]) {\n                    // -1 -1 1 1\n                    linePassStns.push(lineMainStns[0]);\n                } else if (\n                    lineMainStns[0] === branch[0] &&\n                    lineMainStns[lineMainStns.length - 1] === branch[branch.length - 1] &&\n                    linePassStns.length\n                ) {\n                    linePassStns = branch;\n                    lineMainStns = [];\n                } else {\n                    // 1 1 -1 -1\n                    linePassStns.unshift(lineMainStns[lineMainStns.length - 1]);\n                }\n            }\n\n            linePaths.main.push(\n                new this({ stnList, criticalPath: cp })._linePath(\n                    lineMainStns,\n                    lineXs,\n                    branches,\n                    xs,\n                    ys,\n                    branchSpacing,\n                    cp,\n                    e\n                )\n            );\n            linePaths.pass.push(\n                new this({ stnList, criticalPath: cp })._linePath(\n                    linePassStns,\n                    lineXs,\n                    branches,\n                    xs,\n                    ys,\n                    branchSpacing,\n                    cp,\n                    e\n                )\n            );\n        });\n\n        return linePaths;\n    }\n}\n\nexport const drawLine = (branch: string[], stnStates: { [stnId: string]: -1 | 0 | 1 }) => {\n    branch = branch.filter(stnId => !['linestart', 'lineend'].includes(stnId));\n    let lineMainStns = branch.filter(stnId => stnStates[stnId] >= 0);\n    let linePassStns = branch.filter(stnId => stnStates[stnId] <= 0);\n\n    if (lineMainStns.length === 1) {\n        linePassStns = branch;\n    }\n\n    if (lineMainStns.filter(stnId => linePassStns.indexOf(stnId) !== -1).length === 0 && lineMainStns.length) {\n        // if two set disjoint\n        if (linePassStns[0] === branch[0]) {\n            // -1 -1 1 1\n            linePassStns.push(lineMainStns[0]);\n        } else if (\n            lineMainStns[0] === branch[0] &&\n            lineMainStns[lineMainStns.length - 1] === branch[branch.length - 1] &&\n            linePassStns.length\n        ) {\n            linePassStns = branch;\n            lineMainStns = [];\n        } else {\n            // 1 1 -1 -1\n            linePassStns.unshift(lineMainStns[lineMainStns.length - 1]);\n        }\n    }\n\n    return {\n        main: lineMainStns,\n        pass: linePassStns,\n    };\n};\n","import { ColineInfo, InterchangeInfo } from '../../../constants/constants';\nimport { drawLine } from './share';\n\nexport interface ColineLinePath {\n    main: {\n        linePath: string[];\n        colors: InterchangeInfo[];\n    }[];\n    pass: {\n        linePath: string[];\n        colors: InterchangeInfo[];\n    }[];\n}\n\n/**\n * Return all stations from ColineInfo's `from` and `to` with coline color preserved.\n */\nexport const calculateColineStations = (colineInfo: ColineInfo[], branches: string[][]) =>\n    colineInfo\n        .map(coLine => {\n            const involvedBranches = branches.filter(\n                branch => branch.includes(coLine.from) && branch.includes(coLine.to)\n            );\n\n            // the current coLineInfo fall on two separate branches,\n            // which should not be possible in current design.\n            if (involvedBranches.length !== 1) return { linePath: [], colors: coLine.colors };\n\n            const branch = involvedBranches.flat();\n            const a = branch.indexOf(coLine.from);\n            const b = branch.indexOf(coLine.to);\n            const linePath = a < b ? branch.slice(a, b + 1) : branch.slice(b, a + 1);\n            return {\n                linePath: linePath,\n                colors: coLine.colors,\n            };\n        })\n        .filter(branchWithColine => branchWithColine.linePath.length !== 0);\n\n/**\n * Return coline segments with stations in main/pass order.\n */\nexport const calculateColine = (\n    branchWithColine: ReturnType<typeof calculateColineStations>,\n    stnStates: {\n        [stnId: string]: 0 | 1 | -1;\n    }\n) =>\n    branchWithColine\n        .map(branchWithColine => {\n            const linePaths = drawLine(branchWithColine.linePath, stnStates);\n            return {\n                main: [\n                    {\n                        linePath: linePaths.main,\n                        colors: branchWithColine.colors,\n                    },\n                ],\n                pass: [\n                    {\n                        linePath: linePaths.pass,\n                        colors: branchWithColine.colors,\n                    },\n                ],\n            };\n        })\n        // .map(branchWithColine =>\n        //     (\n        //         Object.entries(drawLine(branchWithColine.linePath, stnStates)) as [\n        //             keyof ReturnType<typeof drawLine>,\n        //             string[]\n        //         ][]\n        //     )\n        //         .map(([type, linePath]) => ({ [type]: { linePath: linePath, colors: branchWithColine.colors } }))\n        //         .reduce((acc, cur) => ({ ...acc, ...cur }), { main: [], pass: [] } as ColineLinePath)\n        // )\n        .reduce(\n            (acc, cur) => {\n                acc.main = [...acc.main, ...cur.main];\n                acc.pass = [...acc.pass, ...cur.pass];\n                return acc;\n            },\n            { main: [], pass: [] } as ColineLinePath\n        );\n","import React, { useRef, memo } from 'react';\nimport {\n    InterchangeInfo,\n    Name,\n    PanelTypeGZMTR,\n    PanelTypeShmetro,\n    Facilities,\n    ColourHex,\n} from '../../../../constants/constants';\nimport { useAppSelector } from '../../../../redux';\n\ninterface Props {\n    stnId: string;\n    stnState: -1 | 0 | 1;\n    color?: ColourHex; // control the station color if coline is in effect\n}\n\nconst StationSHMetro = (props: Props) => {\n    const { stnId, stnState, color } = props;\n    const param = useAppSelector(store => store.param);\n    const stnInfo = param.stn_list[stnId];\n\n    // shift station name if the line bifurcate here\n    const branchNameDX =\n        ([...stnInfo.branch.left, ...stnInfo.branch.right].length ? 8 + 12 * stnInfo.name[1].split('\\\\').length : 0) *\n        (param.direction === 'r' ? -1 : 1);\n\n    let stationIconStyle = '';\n    let stationIconColor: { [pos: string]: string } = {};\n    if (param.info_panel_type === 'sh2020') {\n        if (stnInfo.services.length === 3) stationIconStyle = 'stn_sh_2020_direct';\n        else if (stnInfo.services.length === 2) stationIconStyle = 'stn_sh_2020_express';\n        else stationIconStyle = 'stn_sh_2020';\n        stationIconColor.fill = stnState === -1 ? 'gray' : color ? color : 'var(--rmg-theme-colour)';\n    } else {\n        // param.info_panel_type === 'sh' or others (from other styles)\n        if (stnInfo.services.length === 3) stationIconStyle = 'direct_sh';\n        else if (stnInfo.services.length === 2) stationIconStyle = 'express_sh';\n        else if ([...stnInfo.transfer.info[0], ...(stnInfo.transfer.info[1] || [])].length > 0)\n            stationIconStyle = 'int2_sh';\n        else stationIconStyle = 'stn_sh';\n        stationIconColor.stroke = stnState === -1 ? 'gray' : color ? color : 'var(--rmg-theme-colour)';\n    }\n\n    return (\n        <>\n            <use\n                xlinkHref={`#${stationIconStyle}`}\n                {...stationIconColor} // different styles use either `fill` or `stroke`\n            />\n            <g transform={`translate(${branchNameDX},0)`}>\n                <StationNameGElement\n                    name={stnInfo.name}\n                    infos={stnInfo.transfer.info}\n                    stnState={stnState}\n                    direction={param.direction}\n                    info_panel_type={param.info_panel_type}\n                    facility={stnInfo.facility}\n                />\n            </g>\n        </>\n    );\n};\n\nexport default StationSHMetro;\n\ninterface StationNameGElementProps {\n    name: Name;\n    infos: InterchangeInfo[][];\n    stnState: -1 | 0 | 1;\n    direction: 'l' | 'r';\n    info_panel_type: PanelTypeGZMTR | PanelTypeShmetro;\n    facility: Facilities;\n}\n\nconst StationNameGElement = (props: StationNameGElementProps) => {\n    const { name, infos, stnState, info_panel_type, direction, facility } = props;\n    const nameENLn = props.name[1].split('\\\\').length;\n\n    // get the exact station name width so that the\n    // interchange station icon can be right after the station name\n    const stnNameEl = useRef<SVGGElement | null>(null);\n    // the original name position\n    const [bBox, setBBox] = React.useState({ width: 0 } as DOMRect);\n    React.useEffect(\n        () => setBBox(stnNameEl.current!.getBBox()),\n        // eslint-disable-next-line react-hooks/exhaustive-deps\n        [...name]\n    );\n    // the original name position's right x\n    const x = bBox.width + 5;\n\n    // rotate the station info now\n    // other wise the bcr will be inaccurate due to the rotation\n    // Chito: so, use BBox instead\n\n    // simplify the calculation times\n    const directionPolarity = direction === 'l' ? 1 : -1;\n\n    // main elements icon's dx will change if there is a facility icon or not\n    const mainDx = facility !== Facilities.none ? 30 : 0;\n\n    return (\n        <g\n            transform={`translate(${direction === 'l' ? 6 : -6},${info_panel_type === 'sh2020' ? -20 : -6})rotate(${\n                props.direction === 'l' ? -45 : 45\n            })`}\n        >\n            {infos.flat().length > 0 && (\n                <>\n                    <line\n                        x1={mainDx * directionPolarity}\n                        x2={(mainDx + x) * directionPolarity}\n                        stroke={stnState === -1 ? 'gray' : 'black'}\n                        strokeWidth={0.5}\n                    />\n                    <IntBoxGroup\n                        intInfos={infos}\n                        transform={`translate(${(mainDx + x) * directionPolarity},-10.75)`}\n                        direction={direction}\n                    />\n                </>\n            )}\n\n            {facility !== Facilities.none && <use xlinkHref={'#' + facility} x={10 * directionPolarity} y={-30} />}\n\n            <g\n                textAnchor={direction === 'l' ? 'start' : 'end'}\n                transform={`translate(${mainDx * directionPolarity},${-14.15625 - 2 - 12 * (nameENLn - 1)})`}\n            >\n                <StationName\n                    ref={stnNameEl}\n                    stnName={name}\n                    fill={stnState === -1 ? 'gray' : stnState === 0 ? 'red' : 'black'}\n                />\n\n                {/* deal out-of-station here as it is a y axis element. leave out-of-system in IntBoxGroup*/}\n                {infos[1]?.length > 0 && (\n                    <g\n                        transform={`translate(${\n                            (x + infos.reduce((sum, infos) => sum + infos.length, 0) * 15) * directionPolarity\n                        },-30)`}\n                    >\n                        <OSIText osiInfos={infos[1]} />\n                    </g>\n                )}\n            </g>\n        </g>\n    );\n};\n\nconst StationName = React.forwardRef(\n    (props: { stnName: Name } & React.SVGProps<SVGGElement>, ref: React.Ref<SVGGElement>) => {\n        const { stnName, ...others } = props;\n\n        return (\n            <g ref={ref} {...others}>\n                {React.useMemo(\n                    () => (\n                        <>\n                            {stnName[0].split('\\\\').map((txt, i, array) => (\n                                <text key={i} className=\"rmg-name__zh\" dy={(array.length - 1 - i) * -15}>\n                                    {txt}\n                                </text>\n                            ))}\n                            <g fontSize={9.6}>\n                                {stnName[1].split('\\\\').map((txt, i) => (\n                                    <text key={i} className=\"rmg-name__en\" dy={12 * (i + 1)}>\n                                        {txt}\n                                    </text>\n                                ))}\n                            </g>\n                        </>\n                    ),\n                    // eslint-disable-next-line react-hooks/exhaustive-deps\n                    [...stnName]\n                )}\n            </g>\n        );\n    }\n);\n\nconst IntBoxGroup = (props: { intInfos: InterchangeInfo[][]; direction: 'l' | 'r' } & React.SVGProps<SVGGElement>) => {\n    const { intInfos, direction, ...others } = props;\n\n    // also known as non out-of-system transfers\n    const boxInfos = [\n        ...intInfos[0],\n        ...(intInfos[1] || []),\n        // some dirty tricks here as shmetro shows maglev icon even it is a out-of-system transfer\n        // and display a maglev icon is much easier in boxInfos than in OSysIText\n        ...(intInfos[2]?.filter(info => Boolean(info[4].match(/^磁(悬)*浮/))) || []),\n    ];\n\n    let dx = 0; // update in every boxInfos\n\n    return (\n        <g fontSize={14} textAnchor=\"middle\" {...others}>\n            {boxInfos.map((info, i) => {\n                const isLineNumber = Boolean(info[4].match(/^\\d.*$/));\n                const isMaglev = Boolean(info[4].match(/^磁(悬)*浮/));\n\n                if (props.direction === 'r') {\n                    dx -= (isLineNumber || isMaglev ? 20 : info[4].length * 14 + 12 + 0) + (i === 0 ? 0 : 5);\n                }\n\n                let el = <g />;\n                if (isMaglev) {\n                    el = (\n                        <g transform={`translate(${dx},-16)scale(0.1428571429)`} key={i}>\n                            <IntBoxMaglev info={info} />\n                        </g>\n                    );\n                } else if (isLineNumber) {\n                    el = (\n                        <g transform={`translate(${dx},0)`} key={i}>\n                            <IntBoxNumber info={info} />\n                        </g>\n                    );\n                } else {\n                    el = (\n                        <g transform={`translate(${dx},0)`} key={i}>\n                            <IntBoxLetter info={info} />\n                        </g>\n                    );\n                }\n\n                if (props.direction === 'l') {\n                    dx += isLineNumber || isMaglev ? 20 + 5 : info[4].length * 14 + 12 + 5;\n                }\n                return el;\n            })}\n\n            {[...(intInfos[2] || [])].length > 0 && (\n                <g transform={`translate(${dx - (props.direction === 'r' ? 5 : 0)},0)`} key={boxInfos.length + 1}>\n                    <OSysIText osysiInfos={intInfos[2]} direction={props.direction} />\n                </g>\n            )}\n        </g>\n    );\n};\n\nconst IntBoxMaglev = memo(\n    (props: { info: InterchangeInfo }) => (\n        <>\n            <use xlinkHref=\"#intbox_maglev\" fill={props.info[2]} stroke={props.info[2]} />\n        </>\n    ),\n    (prevProps, nextProps) => prevProps.info.toString() === nextProps.info.toString()\n);\n\nconst IntBoxNumber = memo(\n    (props: { info: InterchangeInfo }) => (\n        <>\n            <use xlinkHref=\"#intbox_number\" fill={props.info[2]} />\n            <text x={10} className=\"rmg-name__zh\" fill={props.info[3]} dominantBaseline=\"central\">\n                {/* // line starts with numbers */}\n                {props.info[4].match(/(\\d*)\\w+/)![0]}\n            </text>\n        </>\n    ),\n    (prevProps, nextProps) => prevProps.info.toString() === nextProps.info.toString()\n);\n\nconst IntBoxLetter = memo(\n    (props: { info: InterchangeInfo }) => {\n        // box width: 16 * number of characters + 12\n        const textCount = props.info[4].split('\\\\')[0].length;\n        return (\n            <>\n                <rect height={22} width={textCount * 14 + 12} y={-11} fill={props.info[2]} />\n                <text x={textCount * 7 + 6} className=\"rmg-name__zh\" fill={props.info[3]} dominantBaseline=\"central\">\n                    {props.info[4].split('\\\\')[0]}\n                </text>\n            </>\n        );\n    },\n    (prevProps, nextProps) => prevProps.info.toString() === nextProps.info.toString()\n);\n\nconst OSIText = (props: { osiInfos: InterchangeInfo[] }) => {\n    // get the all names from the out of station interchanges\n    const lineNames = props.osiInfos.map(info => info[4]).join('，');\n    return React.useMemo(\n        () => (\n            <g textAnchor=\"middle\" fontSize=\"50%\">\n                <text className=\"rmg-name__zh\" dy={-5}>\n                    {`换乘${lineNames}`}\n                </text>\n                <text className=\"rmg-name__zh\" dy={5}>\n                    仅限公共交通卡\n                </text>\n                <text className=\"rmg-name__en\" dy={12.5} fontSize=\"75%\">\n                    Only for Public Transportation Card\n                </text>\n            </g>\n        ),\n        // eslint-disable-next-line react-hooks/exhaustive-deps\n        [lineNames.toString()]\n    );\n};\n\nconst OSysIText = (props: { osysiInfos: InterchangeInfo[]; direction: 'l' | 'r' }) => {\n    // get the all names from out of system transfers\n    const lineNames = props.osysiInfos.map(info => info[4]).join('，');\n    const lineNamesEn = props.osysiInfos.map(info => info[5]).join(', ');\n\n    return React.useMemo(\n        () => (\n            <g textAnchor={props.direction === 'l' ? 'start' : 'end'} fontSize=\"50%\">\n                <text className=\"rmg-name__zh\" dy={3}>\n                    转乘{lineNames}\n                </text>\n                <text className=\"rmg-name__en\" dy={10} fontSize=\"75%\">\n                    To {lineNamesEn}\n                </text>\n            </g>\n        ),\n        // eslint-disable-next-line react-hooks/exhaustive-deps\n        [props.osysiInfos.toString(), props.direction]\n    );\n};\n","import React from 'react';\nimport { drawLine } from '../../methods/share';\nimport { calculateColineStations, calculateColine } from '../../methods/shmetro-coline';\nimport { AtLeastOneOfPartial, Services, InterchangeInfo } from '../../../../constants/constants';\nimport { useAppSelector } from '../../../../redux';\nimport { _linePath, StationGroupProps } from '../main-shmetro';\nimport StationSHMetro from '../station/station-shmetro';\n\ninterface Props {\n    xs: { [stnId: string]: number };\n    servicesPresent: Services[];\n    stnStates: { [stnId: string]: -1 | 0 | 1 };\n}\n\ninterface ColineServicesPath {\n    main: {\n        path: string;\n        colors: InterchangeInfo[];\n    }[];\n    pass: {\n        path: string;\n        colors: InterchangeInfo[];\n    }[];\n    service: Services;\n}\n\ntype ColinePath = AtLeastOneOfPartial<Record<Services, ColineServicesPath>>;\nconst defaultTheme = ['shanghai', 'sh4', '#5F259F', '#fff', '4号线', 'Line 4'] as InterchangeInfo;\n\nexport const ColineSHMetro = (props: Props) => {\n    const { xs, servicesPresent, stnStates } = props;\n\n    const {\n        direction,\n        stn_list,\n        current_stn_idx,\n        branch_spacing,\n        info_panel_type,\n        coline: colineInfo,\n    } = useAppSelector(store => store.param);\n    const { branches, depsStr: deps } = useAppSelector(store => store.helper);\n\n    const yShares = React.useMemo(\n        () => {\n            console.log('computing y shares');\n            return Object.keys(stn_list).reduce((acc, cur) => {\n                if (branches[0].includes(cur)) {\n                    return { ...acc, [cur]: 0 };\n                } else {\n                    const branchOfStn = branches.slice(1).filter(branch => branch.includes(cur))[0];\n                    return { ...acc, [cur]: stn_list[branchOfStn[0]].children.indexOf(branchOfStn[1]) ? -3 : 3 };\n                }\n            }, {} as { [stnId: string]: number });\n        },\n        // eslint-disable-next-line react-hooks/exhaustive-deps\n        [deps]\n    );\n    // filter out all positive yShares to draw the railmap w/ coline and its branches\n    const colineYShares = Object.entries(yShares)\n        .filter(([k, v]) => v <= 0)\n        .reduce((acc, [k, v]) => ({ ...acc, [k]: v }), {} as typeof yShares);\n    const colineYs = Object.keys(colineYShares).reduce(\n        (acc, cur) => ({ ...acc, [cur]: -colineYShares[cur] * branch_spacing }),\n        {} as typeof yShares\n    );\n\n    // coline color and all stations in the coline segments\n    const colineStns = React.useMemo(\n        () =>\n            calculateColine(\n                calculateColineStations(\n                    colineInfo.filter(co => co.display),\n                    branches\n                ),\n                stnStates\n            ),\n        [JSON.stringify(colineInfo), current_stn_idx, direction, deps]\n    );\n\n    const colinePaths = servicesPresent.reduce(\n        (acc, service) => ({\n            ...acc,\n            [service]: (Object.keys(colineStns) as (keyof ReturnType<typeof drawLine>)[]).reduce(\n                (acc, cur) => ({\n                    ...acc,\n                    [cur]: colineStns[cur]\n                        .map(colineStn => ({\n                            path: _linePath(\n                                colineStn.linePath,\n                                cur,\n                                xs,\n                                colineYs,\n                                direction,\n                                service,\n                                servicesPresent.length,\n                                stn_list,\n                                'diagonal'\n                            ),\n                            colors: colineStn.colors,\n                        }))\n                        .filter(colineStn => colineStn.path !== ''),\n                }),\n                {} as ColineServicesPath\n            ),\n        }),\n        {} as ColinePath\n    );\n\n    // only display coline stations when coline in effect\n    const colineStations = calculateColineStations(\n        colineInfo.filter(co => co.display),\n        branches\n    )\n        .map(co => co.linePath)\n        .flat();\n\n    const LINE_WIDTH = 12;\n    const COLINE_GAP = info_panel_type === 'sh2020' ? 3 : 0;\n    return (\n        <>\n            <g id=\"coline\" transform={`translate(0,${LINE_WIDTH + COLINE_GAP})`}>\n                <CoLine paths={colinePaths} direction={direction} />\n                <ColineStationInMainLine\n                    colineStns={colineStns}\n                    branches={branches}\n                    xs={xs}\n                    ys={colineYs}\n                    stnStates={stnStates}\n                    lineWidth={LINE_WIDTH}\n                    colineGap={COLINE_GAP}\n                />\n                <ColineStationGroup\n                    stnIds={Object.entries(yShares)\n                        .filter(([k, v]) => v < 0)\n                        .reduce((acc, [k, v]) => [...acc, k], [] as string[])\n                        .filter(stnId => !['linestart', 'lineend'].includes(stnId))\n                        .filter(stnId => stn_list[stnId].services.length !== 0)\n                        .filter(stnId => colineStations.includes(stnId))}\n                    xs={xs}\n                    ys={colineYs}\n                    stnStates={stnStates}\n                />\n            </g>\n        </>\n    );\n};\n\nexport default ColineSHMetro;\n\nconst CoLine = (props: { paths: ColinePath; direction: 'l' | 'r' }) => {\n    const { paths, direction } = props;\n\n    return (\n        <>\n            {(Object.keys(paths) as Services[]).map((service, i) => (\n                <g key={`servicePath${i}`} transform={`translate(0,${i * 25})`}>\n                    <g>\n                        {paths[service]?.pass.map((colinePath, j) => (\n                            <React.Fragment key={j}>\n                                <path\n                                    key={j}\n                                    stroke=\"var(--rmg-grey)\"\n                                    strokeWidth={12}\n                                    fill=\"none\"\n                                    d={colinePath.path}\n                                    strokeLinejoin=\"round\"\n                                    filter={service === Services.local ? undefined : `url(#contrast-${service})`}\n                                />\n                            </React.Fragment>\n                        ))}\n\n                        {paths[service]?.main.map((colinePath, j) => (\n                            <React.Fragment key={j}>\n                                {colinePath.colors.length > 1 && (\n                                    <linearGradient\n                                        id={`grad${j}`}\n                                        y1=\"-100%\"\n                                        y2=\"100%\"\n                                        x1=\"0\"\n                                        x2=\"0\"\n                                        // gradientTransform=\"rotate(90)\"\n                                        gradientUnits=\"userSpaceOnUse\"\n                                    >\n                                        {colinePath.colors.map((color, i) => (\n                                            <React.Fragment key={i}>\n                                                {/* more about React.Fragment on https://stackoverflow.com/a/59390967 */}\n                                                <stop // from\n                                                    offset={`${(100 / colinePath.colors.length) * (i + 0)}%`}\n                                                    stopColor={color[2]}\n                                                />\n                                                <stop // to\n                                                    offset={`${(100 / colinePath.colors.length) * (i + 1)}%`}\n                                                    stopColor={color[2]}\n                                                />\n                                            </React.Fragment>\n                                        ))}\n                                    </linearGradient>\n                                )}\n\n                                {direction === 'l' && (\n                                    <marker\n                                        id={`arrow_left_${j}_${colinePath.colors.map(c => c[2]).join('_')}`}\n                                        refY={0.5}\n                                        refX={1}\n                                    >\n                                        <path\n                                            d=\"M1,0L0,1H1z\"\n                                            fill={\n                                                colinePath.colors.length > 1\n                                                    ? `url(#grad${j})`\n                                                    : colinePath.colors[0][2]\n                                            }\n                                        />\n                                    </marker>\n                                )}\n                                {direction === 'r' && (\n                                    <marker\n                                        id={`arrow_right_${j}_${colinePath.colors.map(c => c[2]).join('_')}`}\n                                        refY={0.5}\n                                    >\n                                        <path\n                                            d=\"M0,0L1,1H-1z\"\n                                            fill={\n                                                colinePath.colors.length > 1\n                                                    ? `url(#grad${j})`\n                                                    : colinePath.colors[0][2]\n                                            }\n                                        />\n                                    </marker>\n                                )}\n\n                                <path\n                                    key={j}\n                                    // stroke={colinePath.colors.length > 1 ? `url(#grad${j})` : colinePath.colors[0][2]}\n                                    stroke={(colinePath.colors.at(-1) ?? defaultTheme)[2]}\n                                    strokeWidth={12}\n                                    fill=\"none\"\n                                    d={colinePath.path}\n                                    markerStart={\n                                        direction === 'l'\n                                            ? `url(#arrow_left_${j}_${colinePath.colors.map(c => c[2]).join('_')})`\n                                            : undefined\n                                    }\n                                    markerEnd={\n                                        direction === 'r'\n                                            ? `url(#arrow_right_${j}_${colinePath.colors.map(c => c[2]).join('_')})`\n                                            : undefined\n                                    }\n                                    strokeLinejoin=\"round\"\n                                    filter={service === Services.local ? undefined : `url(#contrast-${service})`}\n                                />\n                            </React.Fragment>\n                        ))}\n                    </g>\n                </g>\n            ))}\n        </>\n    );\n};\n\ninterface ColineStationInMainLineProps {\n    colineStns: ReturnType<typeof calculateColine>;\n    branches: string[][];\n    xs: { [stnId: string]: number };\n    ys: { [stnId: string]: number };\n    stnStates: { [stnId: string]: -1 | 0 | 1 };\n    lineWidth: number;\n    colineGap: number;\n}\n\n/**\n * A small rect overlay on the main branch where coline is present.\n */\nconst ColineStationInMainLine = (props: ColineStationInMainLineProps) => {\n    const { colineStns, branches, xs, ys, stnStates, lineWidth: LINE_WIDTH, colineGap: COLINE_GAP } = props;\n    const { line_name, theme, info_panel_type } = useAppSelector(store => store.param);\n\n    // data to draw the station elements.\n    const colineStations = [...colineStns.main, ...colineStns.pass]\n        // Merge main and pass station together to minimize the code duplication\n        // and its state can obtained by stnStates.\n        .map(stns =>\n            stns.linePath.map(stnId => ({\n                curStn: stnId,\n                x: xs[stnId],\n                y: ys[stnId],\n                color: stns.colors.at(-1) ?? [...theme, ...line_name],\n            }))\n        )\n        .flat()\n        .reduce(\n            // remove current station as it appears in both main and pass\n            (acc, cur) => (acc.find(x => x.curStn === cur.curStn) ? acc : acc.concat(cur)),\n            [] as {\n                curStn: string;\n                x: number;\n                y: number;\n                color: InterchangeInfo;\n            }[]\n        )\n        // only take the coline stations in the first branch(general main line)\n        // as coline stations in lower branches will be taken care by ColineStationGroup\n        .filter(stn => branches[0].includes(stn.curStn));\n    console.log(colineStations);\n\n    return (\n        <g id=\"stations_in_mainline\">\n            {colineStations.map(colineStation => {\n                const { curStn, x, y, color } = colineStation;\n                const height = (stnStates[curStn] === -1 ? 0 : LINE_WIDTH) + COLINE_GAP + LINE_WIDTH;\n                const dy = (stnStates[curStn] === -1 ? 0 : -LINE_WIDTH) - COLINE_GAP - LINE_WIDTH / 2;\n                return (\n                    <g key={curStn} transform={`translate(${x},${y})`}>\n                        {info_panel_type === 'sh2020' ? (\n                            <rect\n                                stroke=\"none\"\n                                height={height}\n                                width={12}\n                                x={-6}\n                                y={dy}\n                                fill={stnStates[curStn] === -1 ? 'var(--rmg-grey)' : color[2]}\n                            />\n                        ) : (\n                            <use\n                                xlinkHref=\"#int2_sh\"\n                                stroke=\"var(--rmg-theme-colour)\"\n                                transform={`translate(0,${-LINE_WIDTH})`}\n                            />\n                        )}\n                    </g>\n                );\n            })}\n        </g>\n    );\n};\n\n/**\n * Complete station component for stations in lower branches.\n */\nconst ColineStationGroup = (props: StationGroupProps) => {\n    const { xs, ys, stnStates, stnIds } = props;\n    const { branches, depsStr: deps } = useAppSelector(store => store.helper);\n    const { line_name, theme, coline } = useAppSelector(store => store.param);\n\n    // get colors of stations in coline branches, they use different colors than var(--rmg-theme-colour)\n    const colines = React.useMemo(() => calculateColineStations(coline, branches), [JSON.stringify(coline), deps]);\n    const colors = stnIds.reduce(\n        (acc, stnId) => ({\n            ...acc,\n            [stnId]: colines\n                .filter(coline => coline.linePath.includes(stnId))\n                .map(coline => coline.colors)\n                .flat()\n                // TODO-coline: support multiple colines\n                .at(0) ?? [...theme, ...line_name],\n        }),\n        {} as { [stnId: string]: InterchangeInfo }\n    );\n\n    return (\n        <g id=\"stations_in_coline\">\n            {stnIds.map(stnId => (\n                <g key={stnId} transform={`translate(${xs[stnId]},${ys[stnId]})`}>\n                    <StationSHMetro stnId={stnId} stnState={stnStates[stnId]} color={colors[stnId][2]} />\n                </g>\n            ))}\n        </g>\n    );\n};\n","import React from 'react';\nimport { adjacencyList, getXShareMTR, criticalPathMethod, drawLine, getStnState } from '../methods/share';\nimport StationSHMetro from './station/station-shmetro';\nimport ColineSHMetro from './coline/coline-shmetro';\nimport { AtLeastOneOfPartial, Services, StationDict } from '../../../constants/constants';\nimport { useAppSelector } from '../../../redux';\n\ninterface servicesPath {\n    main: string[];\n    pass: string[];\n    service: Services;\n}\n\ntype Paths = AtLeastOneOfPartial<Record<Services, servicesPath>>;\n\nconst MainSHMetro = () => {\n    const { routes, branches, depsStr: deps } = useAppSelector(store => store.helper);\n    const param = useAppSelector(store => store.param);\n    const { stn_list, branch_spacing, coline, direction } = useAppSelector(store => store.param);\n\n    const adjMat = adjacencyList(\n        param.stn_list,\n        () => 0,\n        () => 0\n    );\n\n    const criticalPath = criticalPathMethod('linestart', 'lineend', adjMat);\n    const realCP = criticalPathMethod(criticalPath.nodes[1], criticalPath.nodes.slice(-2)[0], adjMat);\n\n    const xShares = React.useMemo(\n        () => {\n            console.log('computing x shares');\n            return Object.keys(param.stn_list).reduce(\n                (acc, cur) => ({ ...acc, [cur]: getXShareMTR(cur, adjMat, branches) }),\n                {} as { [stnId: string]: number }\n            );\n        },\n        // eslint-disable-next-line react-hooks/exhaustive-deps\n        [branches.toString(), JSON.stringify(adjMat)]\n    );\n    const lineXs: [number, number] = [\n        (param.svgWidth.railmap * param.padding) / 100,\n        param.svgWidth.railmap * (1 - param.padding / 100),\n    ];\n    const xs = Object.keys(xShares).reduce(\n        (acc, cur) => ({ ...acc, [cur]: lineXs[0] + (xShares[cur] / realCP.len) * (lineXs[1] - lineXs[0]) }),\n        {} as typeof xShares\n    );\n\n    // const yShares = React.useMemo(\n    //     () => {\n    //         console.log('computing y shares');\n    //         return Object.keys(param.stn_list).reduce(\n    //             (acc, cur) => ({ ...acc, [cur]: branches[0].includes(cur) ? 0 : 3 }),\n    //             {} as { [stnId: string]: number }\n    //         );\n    //     },\n    //     // eslint-disable-next-line react-hooks/exhaustive-deps\n    //     [deps]\n    // );\n    const yShares = React.useMemo(\n        () => {\n            console.log('computing y shares');\n            return Object.keys(stn_list).reduce((acc, cur) => {\n                if (branches[0].includes(cur)) {\n                    return { ...acc, [cur]: 0 };\n                } else {\n                    const branchOfStn = branches.slice(1).filter(branch => branch.includes(cur))[0];\n                    return { ...acc, [cur]: stn_list[branchOfStn[0]].children.indexOf(branchOfStn[1]) ? -3 : 3 };\n                }\n            }, {} as { [stnId: string]: number });\n        },\n        // eslint-disable-next-line react-hooks/exhaustive-deps\n        [deps]\n    );\n\n    // filter out all negative yShares to draw the traditional railmap w/o coline and its branches\n    const lineYShares = Object.entries(yShares)\n        .filter(([k, v]) => v >= 0)\n        .reduce((acc, [k, v]) => ({ ...acc, [k]: v }), {} as typeof yShares);\n    const lineYs = Object.keys(lineYShares).reduce(\n        (acc, cur) => ({ ...acc, [cur]: -lineYShares[cur] * branch_spacing }),\n        {} as typeof yShares\n    );\n\n    const stnStates = React.useMemo(\n        () => getStnState(param.current_stn_idx, routes, param.direction),\n        // eslint-disable-next-line react-hooks/exhaustive-deps\n        [param.current_stn_idx, param.direction, routes.toString()]\n    );\n\n    const servicesAll = Object.values(Services);\n    const servicesPresent = Object.values(param.stn_list)\n        .map(stationInfo => stationInfo.services)\n        .flat() // all services in all stations\n        .reduce(\n            (acc, cur) => {\n                acc[servicesAll.indexOf(cur)] = true;\n                return acc;\n            },\n            [false, false, false] as [boolean, boolean, boolean]\n        ) // set the flag in order\n        .map((bool, i) => [servicesAll[i], bool] as [Services, boolean]) // zip\n        .filter(s => s[1]) // get the existing service\n        .map(s => s[0]); // maintain the services' order\n\n    const linePaths = branches\n        .map(branch => drawLine(branch, stnStates))\n        .reduce(\n            (acc, cur) => {\n                acc.main.push(cur.main);\n                acc.pass.push(cur.pass);\n                return acc;\n            },\n            { main: [], pass: [] } as { main: string[][]; pass: string[][] }\n        );\n\n    const paths = servicesPresent.reduce(\n        (acc, service) => ({\n            ...acc,\n            [service]: (Object.keys(linePaths) as (keyof ReturnType<typeof drawLine>)[]).reduce(\n                (acc, cur) => ({\n                    ...acc,\n                    [cur]: linePaths[cur]\n                        .map(stns =>\n                            _linePath(\n                                stns,\n                                cur,\n                                xs,\n                                lineYs,\n                                direction,\n                                service,\n                                servicesPresent.length,\n                                stn_list\n                                // info_panel_type === 'sh2020' ? 'rightangle' : 'diagonal'\n                            )\n                        )\n                        .filter(path => path !== ''),\n                }),\n                {} as servicesPath\n            ),\n        }),\n        {} as Paths\n    );\n\n    return (\n        <g id=\"main\" transform={`translate(0,${param.svg_height * (coline?.length > 0 ? 0.5 : 0.7 + 0.1)})`}>\n            <Line paths={paths} direction={param.direction} />\n            <StationGroup\n                stnIds={Object.keys(lineYShares)\n                    .filter(stnId => !['linestart', 'lineend'].includes(stnId))\n                    .filter(stnId => stn_list[stnId].services.length !== 0)}\n                xs={xs}\n                ys={lineYs}\n                stnStates={stnStates}\n            />\n            {coline?.length > 0 && <ColineSHMetro xs={xs} servicesPresent={servicesPresent} stnStates={stnStates} />}\n            <ServicesElements servicesLevel={servicesPresent} lineXs={lineXs} />\n            <DirectionElements />\n        </g>\n    );\n};\n\nexport default MainSHMetro;\n\nconst Line = (props: { paths: Paths; direction: 'l' | 'r' }) => {\n    const { theme } = useAppSelector(store => store.param);\n    const { paths, direction } = props;\n\n    return (\n        <>\n            {(Object.keys(paths) as Services[]).map((service, i) => (\n                <g\n                    key={`servicePath${i}`}\n                    transform={`translate(0,${i * 25})`}\n                    // the following line is a special case for pujiang line\n                    // where its pass line color should be white with outline\n                    // surrounding it, see #161 for details.\n                    filter={theme[2] === '#999999' ? 'url(#pujiang_outline_railmap)' : undefined}\n                >\n                    <g>\n                        {paths[service]?.pass.map((path, j) => (\n                            <path\n                                key={j}\n                                stroke=\"var(--rmg-grey)\"\n                                strokeWidth={12}\n                                fill=\"none\"\n                                d={path}\n                                markerStart={props.direction === 'l' ? 'url(#arrow_gray)' : undefined}\n                                markerEnd={props.direction === 'r' ? 'url(#arrow_gray)' : undefined}\n                                strokeLinejoin=\"round\"\n                            />\n                        ))}\n                    </g>\n                    <g>\n                        {paths[service]?.main.map((path, j) => (\n                            <path\n                                key={j}\n                                stroke=\"var(--rmg-theme-colour)\"\n                                strokeWidth={12}\n                                fill=\"none\"\n                                d={path}\n                                markerStart={direction === 'l' ? 'url(#arrow_theme_left)' : undefined}\n                                markerEnd={direction === 'r' ? 'url(#arrow_theme_right)' : undefined}\n                                strokeLinejoin=\"round\"\n                                filter={service === Services.local ? undefined : `url(#contrast-${service})`}\n                            />\n                        ))}\n                    </g>\n                </g>\n            ))}\n        </>\n    );\n};\n\nexport const _linePath = (\n    stnIds: string[],\n    type: 'main' | 'pass',\n    xs: { [stnId: string]: number },\n    ys: { [stnId: string]: number },\n    direction: 'l' | 'r',\n    services: Services,\n    servicesMax: number,\n    stn_list: StationDict, // only used to determine startFromTerminal or endAtTerminal\n    bend: 'rightangle' | 'diagonal' = 'rightangle'\n) => {\n    var [prevY, prevX] = [] as number[];\n    var path: { [key: string]: number[] } = {};\n\n    const servicesDelta = {\n        local: 0,\n        express: 20,\n        direct: 40,\n    }[services]; // TODO: enum Services could be a better idea?\n    const servicesPassDelta = servicesMax > 1 ? 50 : 0;\n\n    // extra short line on either end\n    let e1 = 30;\n    // check if path starts from or ends at the terminal\n    // and change e1 to 0 if it matches\n    if (stnIds.length > 0) {\n        let startFromTerminal = false,\n            endAtTerminal = false;\n        if (stn_list[stnIds.at(-1) || 0].children.some(stnId => ['linestart', 'lineend'].includes(stnId))) {\n            endAtTerminal = true;\n        } else if (stn_list[stnIds.at(0) || 0].parents.some(stnId => ['linestart', 'lineend'].includes(stnId))) {\n            startFromTerminal = true;\n        }\n        e1 = startFromTerminal || endAtTerminal ? e1 : 0;\n    }\n\n    // diagonal use e2 to make soft line\n    const e2 = 30;\n\n    stnIds.forEach(stnId => {\n        var x = xs[stnId];\n        var y = ys[stnId];\n        if (!prevY && prevY !== 0) {\n            [prevX, prevY] = [x, y];\n            path['start'] = [x, y];\n            return;\n        }\n        if (y === 0) {\n            // merge back to main line\n            if (y !== prevY) {\n                path['bifurcate'] = [prevX, prevY];\n            }\n        } else {\n            // on the branch line\n            if (y !== prevY) {\n                path['bifurcate'] = [x, y];\n            }\n        }\n        path['end'] = [x, y];\n        [prevX, prevY] = [x, y];\n    });\n\n    // generate path\n    if (!path.hasOwnProperty('start')) {\n        // no line generated\n        // keys in path: none\n        return '';\n    } else if (!path.hasOwnProperty('end')) {\n        // little line (only beyond terminal station)\n        // keys in path: start\n        let [x, y] = path['start'];\n        if (type === 'main') {\n            // current at terminal(end) station, draw the litte main line\n            if (direction === 'l') {\n                return `M ${x - e1 - servicesDelta},${y} H ${x}`;\n            } else {\n                return `M ${x},${y} H ${x + e1 + servicesDelta}`;\n            }\n        } else {\n            // type === 'pass'\n            // current at terminal(start) station, draw the litte pass line\n            if (direction === 'l') {\n                return `M ${x},${y} L ${x + e1 + servicesPassDelta},${y}`;\n            } else {\n                return `M ${x - e1 - servicesPassDelta},${y} L ${x},${y}`;\n            }\n        }\n    } else if (!path.hasOwnProperty('bifurcate')) {\n        // general main line\n        // keys in path: start, end\n        let [x, y] = path['start'],\n            h = path['end'][0];\n        if (type === 'main') {\n            if (direction === 'l') {\n                return `M ${x - e1 - servicesDelta},${y} H ${h}`;\n            } else {\n                return `M ${x},${y} H ${h + e1 + servicesDelta}`;\n            }\n        } else {\n            // type === 'pass'\n            if (direction === 'l') {\n                return `M ${x - e1},${y} H ${h + e1 + servicesPassDelta}`;\n            } else {\n                return `M ${x - e1 - servicesPassDelta},${y} H ${h + e1}`;\n            }\n        }\n    } else {\n        // main line bifurcate here to become the branch line\n        // and path return here are only branch line\n        // keys in path: start, bifurcate, end\n        // TODO: make diagonal available to `sh`\n\n        let [x, y] = path['start'];\n        let xb = path['bifurcate'][0];\n        let [xm, ym] = path['end'];\n        if (type === 'main') {\n            if (direction === 'l') {\n                if (ym > y) {\n                    console.log(path);\n                    // main line, left direction, center to upper\n                    if (bend === 'rightangle') return `M ${x - e1},${y} H ${xm} V ${ym}`;\n                    // center to upper/rightangle, lower to center/diagonal\n                    else return `M ${x},${y} H ${x + e2} L ${xb - e2},${ym} H ${xm}`;\n                } else {\n                    // wrong marker\n                    // main line, left direction, upper to center\n                    if (bend === 'rightangle') return `M ${x},${y} V ${ym} H ${xm}`;\n                    // upper to center/rightangle, center to lower/diagonal\n                    else return `M ${x - e1},${y} H ${xb + e2} L ${xm - e2},${ym} H ${xm}`;\n                }\n            } else {\n                if (ym > y) {\n                    // wrong marker\n                    // main line, right direction, upper to center\n                    if (bend === 'rightangle') return `M ${x},${y} H ${xm} V ${ym}`;\n                    // upper to center/rightangle, center to lower/diagonal\n                    else return `M ${x},${y} H ${x + e2} L ${xb - e2},${ym} H ${xm + e1}`;\n                } else {\n                    // main line, right direction, center to upper\n                    if (bend === 'rightangle') return `M ${x},${y} V ${ym} H ${xm + e1}`;\n                    // center to upper/rightangle, lower to center/diagonal\n                    else return `M ${x},${y} H ${xb + e2} L ${xm - e2},${ym} H ${xm}`;\n                }\n            }\n        } else {\n            // type === 'pass'\n            if (direction === 'l') {\n                if (ym > y) {\n                    // pass line, left direction, center to upper\n                    if (bend === 'rightangle') return `M ${x - e1},${y} H ${xm} V ${ym}`;\n                    // center to upper/rightangle, lower to center/diagonal\n                    else return `M ${x},${y} H ${x + e2} L ${xb - e2},${ym} H ${xm + e1}`;\n                } else {\n                    // pass line, left direction, upper to center\n                    if (bend === 'rightangle') return `M ${x},${y} V ${ym} H ${xm + e1}`;\n                    // upper to center/rightangle, center to lower/diagonal\n                    else return `M ${x - e1},${y} H ${xb + e2} L ${xm - e2},${ym} H ${xm}`;\n                }\n            } else {\n                if (ym > y) {\n                    // pass line, right direction, upper to center\n                    if (bend === 'rightangle') return `M ${x - e1},${y} H ${xm} V ${ym}`;\n                    // upper to center/rightangle, center to lower/diagonal\n                    return `M ${x},${y} H ${x + e2} L ${xb - e2},${ym} H ${xm + e1}`;\n                } else {\n                    // pass line, right direction, center to upper\n                    if (bend === 'rightangle') return `M ${x},${y} V ${ym} H ${xm + e1}`;\n                    // center to upper/rightangle, lower to center/diagonal\n                    return `M ${x - e1},${y} H ${xb + e2} L ${xm - e2},${ym} H ${xm}`;\n                }\n            }\n        }\n    }\n};\n\nexport interface StationGroupProps {\n    stnIds: string[];\n    xs: { [stnId: string]: number };\n    ys: { [stnId: string]: number };\n    stnStates: { [stnId: string]: -1 | 0 | 1 };\n}\n\nconst StationGroup = (props: StationGroupProps) => {\n    const { xs, ys, stnStates, stnIds } = props;\n\n    return (\n        <g>\n            {stnIds.map(stnId => (\n                <g key={stnId} transform={`translate(${xs[stnId]},${ys[stnId]})`}>\n                    <StationSHMetro stnId={stnId} stnState={stnStates[stnId]} />\n                </g>\n            ))}\n        </g>\n    );\n};\n\nconst ServicesElements = (props: { servicesLevel: Services[]; lineXs: number[] }) => {\n    const { svg_height, direction, svgWidth } = useAppSelector(store => store.param);\n    const dy = -svg_height * (0.5 + 0.1);\n\n    if (props.servicesLevel.length === 1) return <></>;\n\n    const servicesLevel = props.servicesLevel.map(\n        service =>\n            ({\n                local: '普通车',\n                express: '大站车',\n                direct: '直达车',\n            }[service])\n    );\n\n    // let dx = props.direction === 'r' ? 5 : param.svgWidth.railmap - 55;\n    const labelX = direction === 'r' ? props.lineXs[0] - 42 : props.lineXs[1] + 42;\n\n    let dx_hint = props.servicesLevel.length === 2 ? 350 : 500;\n\n    return (\n        <g>\n            {servicesLevel.map((service, i) => (\n                <g key={service} transform={`translate(${labelX},${i * 25})`}>\n                    <rect x={-27.5} height={10} width={55} fill={'white'} stroke={'black'} y={-5}></rect>\n                    <text className=\"rmg-name__zh\" fontSize={9} y={3} textAnchor=\"middle\">{`${service}运行线`}</text>\n                </g>\n            ))}\n            <g transform={`translate(${direction === 'r' ? 30 : svgWidth.railmap - dx_hint},${dy})`}>\n                <text className=\"rmg-name__zh\">图例：</text>\n                {servicesLevel.map((serviceLevel, i) => (\n                    <g key={`serviceLevel${i}`} transform={`translate(${i * 150 + 50},0)`}>\n                        <line\n                            x1=\"0\"\n                            x2=\"35\"\n                            y1=\"-5\"\n                            y2=\"-5\"\n                            stroke=\"var(--rmg-theme-colour)\"\n                            strokeWidth=\"12\"\n                            filter={i === 2 ? 'url(#contrast-direct)' : i === 1 ? 'url(#contrast-express)' : ''}\n                        />\n                        <use x=\"17.5\" y=\"-5\" xlinkHref=\"#stn_sh\" fill=\"var(--rmg-theme-colour)\" />\n                        <text x=\"40\" className=\"rmg-name__zh\">{`${serviceLevel}停靠站`}</text>\n                    </g>\n                ))}\n            </g>\n        </g>\n    );\n};\n\nconst DirectionElements = () => {\n    const { direction, svgWidth, svg_height, coline } = useAppSelector(store => store.param);\n\n    return React.useMemo(\n        () => (\n            <g\n                transform={`translate(${direction === 'l' ? 50 : svgWidth.railmap - 150},${\n                    -svg_height * (coline?.length > 0 ? 0.3 : 0.5 + 0.1)\n                })`}\n            >\n                <text className=\"rmg-name__zh\">列车前进方向</text>\n                <path\n                    d=\"M60,60L0,0L60-60H100L55-15H160V15H55L100,60z\"\n                    fill=\"var(--rmg-theme-colour)\"\n                    transform={`translate(${direction === 'l' ? -30 : 125},-5)rotate(${\n                        direction === 'l' ? 0 : 180\n                    })scale(0.15)`}\n                />\n            </g>\n        ),\n        // eslint-disable-next-line react-hooks/exhaustive-deps\n        [direction, svgWidth.railmap, svg_height]\n    );\n};\n","import * as React from 'react';\nimport MainSHMetro from './main/main-shmetro';\n\nconst RailMapSHMetro = React.memo(() => (\n    <>\n        <DefsSHMetro />\n\n        <MainSHMetro />\n    </>\n));\n\nexport default RailMapSHMetro;\n\nconst DefsSHMetro = React.memo(() => (\n    <defs>\n        <circle id=\"stn_sh\" fill=\"var(--rmg-white)\" strokeWidth={0} r={5} />\n        <path id=\"int2_sh\" fill=\"var(--rmg-white)\" strokeWidth={2} d=\"M -5,0 a 5,5 0 1 1 10,0 V10 a 5,5 0 1 1 -10,0Z\" />\n        <path\n            id=\"direct_sh\"\n            fill=\"var(--rmg-white)\"\n            strokeWidth={2}\n            d=\"M -5,0 a 5,5 0 1 1 10,0 V50 a 5,5 0 1 1 -10,0Z\"\n        />\n        <rect id=\"stn_sh_2020\" stroke=\"none\" height={24} width={12} x={-6} y={-18} />\n        <rect id=\"stn_sh_2020_express\" stroke=\"none\" height={49} width={12} x={-6} y={-18} />\n        <rect id=\"stn_sh_2020_direct\" stroke=\"none\" height={74} width={12} x={-6} y={-18} />\n\n        <rect id=\"intbox_number\" height={22} width={20} y={-11} />\n\n        <g id=\"airport\" transform=\"scale(0.5)\">\n            <circle cx=\"0\" cy=\"29.33899\" r=\"29.33899\" fill=\"var(--rmg-grey)\" />\n            <path\n                id=\"airport\"\n                d=\"M28.9769,6.60134c1.711.013,3.111,2.53205,3.111,4.241v10.337s17.106,15.435,17.358,15.666a1.145,1.145,0,0,1,.488,1.152v2.833c0,.651-.451.61-.695.467-.334-.119-17.151-8.863-17.151-8.863-.004,1.458-.797,9.006-1.326,13.304,0,0,4.61,2.457,4.699,2.521.334.268.352.359.352.852v2.001c0,.477-.352.428-.51.324-.183-.062-5.693-1.921-5.693-1.921a2.56018,2.56018,0,0,0-.633-.127,2.31654,2.31654,0,0,0-.666.127s-5.477,1.859-5.672,1.921c-.185.104-.523.153-.523-.324v-2.001c0-.493.029-.584.367-.852.086-.064,4.678-2.521,4.678-2.521-.524-4.298-1.307-11.846-1.325-13.304,0,0-16.822,8.744-17.148,8.863-.217.143-.69.184-.69-.467v-2.833a1.16206,1.16206,0,0,1,.473-1.152c.276-.231,17.365-15.666,17.365-15.666v-10.337c0-1.709,1.403-4.228,3.14105-4.241\"\n                transform=\"translate(-28.9697,0.14347)\"\n                fill=\"var(--rmg-white)\"\n            />\n        </g>\n        <g id=\"disney\" transform=\"scale(0.5)\">\n            <circle cx=\"0\" cy=\"29.33899\" r=\"29.33899\" fill=\"var(--rmg-grey)\" />\n            <path\n                fill=\"var(--rmg-white)\"\n                d=\"M45.6152,7.85015a9.80248,9.80248,0,0,0-9.79907,9.801,9.70059,9.70059,0,0,0,.342,2.582c.002.026.002.055.002.093a.31815.31815,0,0,1-.31494.318.67741.67741,0,0,1-.12806-.02,15.71521,15.71521,0,0,0-13.498,0,.61.61,0,0,1-.122.02.31841.31841,0,0,1-.322-.318v-.067a9.62553,9.62553,0,0,0,.35608-2.608,9.803,9.803,0,1,0-9.797,9.8,10.10364,10.10364,0,0,0,2.308-.271h.05493a.31113.31113,0,0,1,.31409.318.32433.32433,0,0,1-.019.12,15.72588,15.72588,0,1,0,29.703,7.216,15.83676,15.83676,0,0,0-1.746-7.23.18417.18417,0,0,1-.0271-.106.31612.31612,0,0,1,.32007-.318h.057a10.15953,10.15953,0,0,0,2.316.271,9.80051,9.80051,0,0,0,0-19.601\"\n                transform=\"translate(-28.9697 0.13398)\"\n            />\n        </g>\n        {/* Special thanks to Wikimedia Commons, see https://commons.wikimedia.org/wiki/File:China_Railways.svg */}\n        <g id=\"railway\">\n            <circle cx=\"0\" cy=\"29.33899\" r=\"29.33899\" fill=\"var(--rmg-grey)\" transform=\"translate(0,-2)scale(0.5)\" />\n            <path\n                fill=\"var(--rmg-white)\"\n                d=\"M169,273.5c0-19,14.7-34.8,33.7-36.3c18.9-1.5,38.1-2.2,57.4-2.2c19.3,0,38.4,0.8,57.3,2.2  c19,1.5,33.7,17.3,33.7,36.3v47.3l-51.3,14.7c-11.2,3.2-18.9,13.4-18.9,25v147.8c0,17.4,12.2,32.3,29.3,35.7l110.6,22.1  c4.9,1,8.4,5.2,8.4,10.2V599H91v-22.7c0-5,3.5-9.2,8.4-10.2L209.9,544c17-3.4,29.3-18.3,29.3-35.7V360.5c0-11.6-7.7-21.8-18.9-25  L169,320.8V273.5z M309.4,31.7c0.2-1.2,0.3-2.4,0.3-3.6c0-14-11.1-25.4-24.9-26C276.6,1.4,268.3,1,260,1c-8.3,0-16.6,0.4-24.7,1.1  c-13.9,0.6-24.9,12-24.9,26c0,1.2,0.1,2.5,0.3,3.6C90.6,54.8,0,160.3,0,287c0,97.2,53.4,182,132.4,226.6l36.8-48.1  C104.3,432.4,59.8,364.9,59.8,287c0-110.6,89.6-200.2,200.2-200.2S460.2,176.4,460.2,287c0,77.9-44.5,145.4-109.4,178.5  c15,19.6,25.6,33.5,36.8,48.1C466.6,469,520,384.2,520,287C520,160.3,429.4,54.8,309.4,31.7z\"\n                transform=\"translate(-10,0)scale(0.04)\"\n            />\n        </g>\n\n        {/* An extension of the line/path. Remember to minus the stroke-width.  */}\n        <marker id=\"arrow_gray\" viewBox=\"-1.5 0 3 1.5\" refY={0.5}>\n            <path d=\"M0,0L1,1H-1z\" fill=\"var(--rmg-grey)\" />\n        </marker>\n        <marker id=\"arrow_theme_left\" refX={1} refY={0.5}>\n            <path d=\"M1,0L0,1H1z\" fill=\"var(--rmg-theme-colour)\" />\n        </marker>\n        <marker id=\"arrow_theme_right\" refY={0.5}>\n            <path d=\"M0,0L1,1H-1z\" fill=\"var(--rmg-theme-colour)\" />\n        </marker>\n\n        {/* Contrast filters for lines. */}\n        <filter id=\"contrast-direct\" filterUnits=\"userSpaceOnUse\">\n            <feComponentTransfer>\n                <feFuncR type=\"linear\" slope={0.5} intercept={0.25} />\n                <feFuncG type=\"linear\" slope={0.5} intercept={0.25} />\n                <feFuncB type=\"linear\" slope={0.5} intercept={0.25} />\n            </feComponentTransfer>\n        </filter>\n        <filter id=\"contrast-express\" filterUnits=\"userSpaceOnUse\">\n            <feComponentTransfer>\n                <feFuncR type=\"linear\" slope={0.75} intercept={0.125} />\n                <feFuncG type=\"linear\" slope={0.75} intercept={0.125} />\n                <feFuncB type=\"linear\" slope={0.75} intercept={0.125} />\n            </feComponentTransfer>\n        </filter>\n\n        <filter\n            id=\"pujiang_outline_railmap\"\n            colorInterpolationFilters=\"sRGB\"\n            // TODO: remove the absolute value while make the filter works correctly\n            filterUnits=\"userSpaceOnUse\"\n            x=\"0\"\n            y=\"-1000\"\n            width=\"5000\"\n            height=\"2000\"\n        >\n            {/* Replace pass gray color with white.\n                https://stackoverflow.com/questions/41639049/replace-one-color-using-svg-filters */}\n            <feComponentTransfer in=\"SourceGraphic\">\n                <feFuncR\n                    type=\"discrete\"\n                    tableValues=\"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0\"\n                />\n                <feFuncG\n                    type=\"discrete\"\n                    tableValues=\"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0\"\n                />\n                <feFuncB\n                    type=\"discrete\"\n                    tableValues=\"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0\"\n                />\n            </feComponentTransfer>\n            <feColorMatrix\n                type=\"matrix\"\n                values=\"1 0 0 0 0\n                                                 0 1 0 0 0\n                                                 0 0 1 0 0\n                                                 1 1 1 1 -3\"\n                result=\"selectedColor1\"\n            />\n\n            {/* Draw an outline line around the pass line.\n                https://stackoverflow.com/questions/49693471/svg-border-outline-for-group-of-elements\n                Also see #181 why we do not simply outline the pass line element. */}\n            <feMorphology operator=\"erode\" in=\"selectedColor1\" radius=\"0\" result=\"e1\" />\n            <feMorphology operator=\"erode\" in=\"selectedColor1\" radius=\"1\" result=\"e2\" />\n            <feComposite in=\"e1\" in2=\"e2\" operator=\"xor\" result=\"uncoloredOutline\" />\n            {/* As the pass line is colored in white, we need to recolor the outline with black. */}\n            <feFlood floodColor=\"rgb(0,0,0)\" />\n            <feComposite operator=\"in\" in2=\"uncoloredOutline\" result=\"outline\" />\n            {/* Put the outline on the white not gray pass line. */}\n            <feComposite in=\"outline\" in2=\"selectedColor1\" operator=\"over\" result=\"result\" />\n            {/* Put the white pass line with outline on the original line. */}\n            <feComposite in=\"result\" in2=\"SourceGraphic\" operator=\"over\" />\n        </filter>\n    </defs>\n));\n"],"names":["adjacencyList","stnList","leftW","rightW","Object","keys","reduce","acc","cur","children","a","c","criticalPathMethod","from","to","adjMat","len","nodes","allLengths","criticalPaths","forEach","child","cp","push","unshift","maxLength","Math","max","indexOf","getXShareMTR","stnId","branches","criticalPath","includes","branchOfStn","filter","branch","partSource","partSink","leftOpenJaw","lens","slice","getStnState","currentId","routes","direction","console","log","Set","concat","ShortDirection","stnId1","stnId2","route","idx1","idx2","_isSuccessor","_isPredecessor","Stations","data","yShares","xShares","namePoss","leftWideFactor","rightWideFactor","pathWeight","Infinity","pathTurnParams","branchSpacing","dy_a","tr","sqrt","dy_l","dx_a","dx_l","pathTurnSE","pathTurnNE","this","parents","length","stnPred","res","getYShare","stnIds","lineXs","realXs","realYs","e","prevId","prevY","prevX","path","stnDX","stnExtraH","stnSpareH","warn","x","y","join","replace","stations","stnStates","xs","ys","linePaths","main","pass","i","lineMainStns","linePassStns","_linePath","drawLine","calculateColineStations","colineInfo","map","coLine","involvedBranches","linePath","colors","flat","b","branchWithColine","calculateColine","props","stnState","color","param","useAppSelector","store","stnInfo","stn_list","branchNameDX","left","right","name","split","stationIconStyle","stationIconColor","info_panel_type","services","fill","transfer","info","stroke","xlinkHref","transform","StationNameGElement","infos","facility","nameENLn","stnNameEl","useRef","React","width","bBox","setBBox","current","getBBox","directionPolarity","mainDx","Facilities","x1","x2","strokeWidth","IntBoxGroup","intInfos","textAnchor","StationName","ref","stnName","sum","OSIText","osiInfos","others","txt","array","className","dy","fontSize","boxInfos","Boolean","match","dx","isLineNumber","isMaglev","el","IntBoxMaglev","IntBoxNumber","IntBoxLetter","OSysIText","osysiInfos","memo","prevProps","nextProps","toString","dominantBaseline","textCount","height","lineNames","lineNamesEn","defaultTheme","servicesPresent","current_stn_idx","branch_spacing","coline","helper","deps","depsStr","colineYShares","entries","k","v","colineYs","colineStns","co","display","JSON","stringify","colinePaths","service","colineStn","colineStations","COLINE_GAP","id","CoLine","paths","ColineStationInMainLine","lineWidth","colineGap","ColineStationGroup","colinePath","j","d","strokeLinejoin","Services","undefined","y1","y2","gradientUnits","offset","stopColor","refY","refX","at","markerStart","markerEnd","LINE_WIDTH","line_name","theme","stns","curStn","find","stn","colineStation","colines","realCP","svgWidth","railmap","padding","lineYShares","lineYs","servicesAll","values","stationInfo","bool","s","svg_height","Line","StationGroup","ServicesElements","servicesLevel","DirectionElements","type","servicesMax","bend","servicesDelta","local","express","direct","servicesPassDelta","e1","startFromTerminal","endAtTerminal","some","e2","hasOwnProperty","xb","xm","ym","h","labelX","dx_hint","serviceLevel","DefsSHMetro","r","cx","cy","viewBox","filterUnits","slope","intercept","colorInterpolationFilters","in","tableValues","result","operator","radius","in2","floodColor"],"sourceRoot":""}