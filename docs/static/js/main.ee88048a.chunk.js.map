{"version":3,"sources":["constants/constants.ts","../external \"React\"","../external \"MaterialUI\"","redux/app/action.ts","../external \"ReactRedux\"","../external \"ReactI18next\"","../external \"ReactRouterDOM\"","context.ts","methods.ts","../external \"Redux\"","utils.ts","../external \"i18next\"","constants/city-config.ts","../external \"ReactDOM\"","../external \"i18nextXHRBackend\"","../external \"i18nextBrowserLanguageDetector\"","../external \"ReduxThunk\"","i18n.ts","app-appbar.tsx","error-boundary.tsx","svgs/svg.tsx","svgs/index.ts","panels/panels.tsx","panels/index.tsx","App.tsx","serviceWorker.ts","util/storage/storageService.ts","util/storage/storageLocalStorage.ts","util/storage/index.ts","redux/app/reducer.ts","redux/param/action.ts","redux/param/reducer.ts","redux/index.ts","index.tsx"],"names":["LoadingStatus","RmgStyle","CanvasType","Direction","ShortDirection","BranchStyle","MonoColour","Services","Facilities","PanelTypeGZMTR","PanelTypeShmetro","LanguageCode","AllCanvas","canvasConfig","MTR","Destination","RailMap","GZMTR","RunIn","SHMetro","module","exports","React","MaterialUI","SET_RMG_STYLE","SET_CANVAS_SCALE","SET_CANVAS_SCALE_STATUS","SET_CANVAS_TO_SHOW","SET_CANVAS_TO_SHOW_STATUS","setRmgStyle","rmgStyle","type","setCanvasScale","canvasScale","setCanvasScaleStatus","canvasScaleStatus","zoomIn","dispatch","getState","a","loading","newScale","Number","app","toFixed","window","rmgStorage","writeFile","toString","loaded","failed","zoomOut","setCanvasToShow","canvasToShow","setCanvasToShowStatus","canvasToShowStatus","selectCanvas","canvas","ReactRedux","ReactI18next","ReactRouterDOM","ParamContext","createContext","paramReducer","state","action","data","key","svg_height","value","svgWidth","targetId","y_pc","branch_spacing","padding","direction_gz_x","direction_gz_y","line_name","name","theme","direction","left","right","platform_num","platform","namePosMTR","isStagger","checked","isFlip","customiseMTRDest","isLegacy","terminal","line_num","num","psd_num","info_panel_type","variant","notesGZMTR","concat","filter","_","i","idx","map","note","current_stn_idx","stnId","stn_list","Object","keys","reduce","acc","id","lineend","parents","children","slice","reverse","branch","linestart","secondaryName","transfer","info","setIdx","nextInfo","infos","intIdx","int","j","k","undefined","osi_names","tick_direc","paid_area","isPaid","branchType","branches","first","facility","services","Array","from","isChecked","Set","add","serviceId","s","stnList","getYShareMTR","includes","length","stnPred","indexOf","getBranches","console","log","stack","branchCount","curId","shift","prevId","push","branchNextId","getRoutes","useTpo","useState","tpo","setTpo","useEffect","res","cur","Redux","updateParam","param","dest_legacy","fontZH","fontEN","weightZH","weightEN","entries","stnInfo","style","interchange","arr","forEach","intInfo","splice","change_type","split","usage","destination","svg_dest_width","runin","railmap","svg_width","char_form","show_outer","strip_pc","txt_bg_gap","txt_flip","join","getTransText2","obj","langs","l","English","formatStnName","replace","i18next","CityCode","cityList","Barcelona","country","en","Beijing","zh","Changsha","Chengdu","Chongqing","Dongguan","Edinburgh","ga","Foshan","Glasgow","Guangzhou","Hangzhou","HongKong","Kansai","ja","Kaohsiung","London","Macao","pt","Madrid","Nanjing","NewTaipei","Osaka","Oslo","Paris","Qingdao","SanFrancisco","Seoul","ko","Shanghai","Shenzhen","Singapore","Stockholm","Taipei","Tianjin","Tokyo","Toronto","TyneAndWear","Xian","Other","ReactDOM","i18nextXHRBackend","i18nextBrowserLanguageDetector","ReduxThunk","i18n","use","Backend","LanguageDetector","initReactI18next","init","fallbackLng","default","backend","loadPath","process","interpolation","escapeValue","then","t","document","title","documentElement","setAttribute","language","useStyles","makeStyles","createStyles","rootLight","backgroundColor","palette","primary","main","rootDark","background","paper","flexGrow","color","menuButton","AppAppBar","useTranslation","classes","prefersDarkMode","useMediaQuery","position","className","CanvasToggle","useDispatch","useSelector","store","canvasButtonEl","setCanvasButtonEl","handleClick","onClick","e","currentTarget","anchorEl","open","Boolean","onClose","c","margin","ZoomToggles","ErrorBoundary","props","hasError","error","errorInfo","this","Component","root","display","flexDirection","overflowX","content","flex","border","SVGs","useContext","sharedProps","useCallback","xmlns","xmlnsXlink","height","viewBox","colorInterpolationFilters","JSON","stringify","path","StyleSpecificSVGs","canvasAvailable","canvasList","svgProps","to","memo","values","getElementById","href","Suspense","fallback","fill","width","strokeWidth","stroke","RunInGZMTR","lazy","RailMapGZMTR","DestinationMTR","RailMapMTR","DestinationSHMetro","RunInSHMetro","RailMapSHMetro","PanelSave","PanelLayout","PanelDesign","PanelStations","PanelInfo","breakpoints","down","typography","tab","up","justifyContent","minWidth","minHeight","marginBottom","paddingLeft","tabs","overflow","scrollbarWidth","WebkitOverflowScrolling","tabpanel","spacing","paddingBottom","alignItems","PanelTab","useTheme","isMobile","setValue","tabNav","component","orientation","indicatorColor","textColor","onChange","val","scrollButtons","label","icon","role","index","panel","Panel","darkTheme","createMuiTheme","secondary","overrides","MuiDialog","lightTheme","light","App","basename","AppBody","useReducer","parse","localStorage","rmgParam","paramString","deps","o","useMemo","routes","Provider","overflowY","location","hostname","match","StorageLocalStorage","currentBusyFilename","warn","alert","Error","setItem","removeItem","filename","contents","getItem","indexedDB","Promise","resolve","request","onerror","err","onsuccess","initialState","SET_FULL_PARAM","white","gz1","rootReducer","combineReducers","fullParam","createStore","applyMiddleware","thunk","navigator","serviceWorker","ready","registration","unregister","catch","message","head","append","tag","link","createElement","rel","getRmgStorage","readFile","updatedParam","canvasScaleString","rmgStore"],"mappings":"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","file":"static/js/main.ee88048a.chunk.js","sourcesContent":["import { CityCode } from './city-config';\n\nexport enum LoadingStatus {\n    init = 'init',\n    loading = 'loading',\n    loaded = 'loaded',\n    failed = 'failed',\n}\n\nexport enum RmgStyle {\n    MTR = 'mtr',\n    GZMTR = 'gzmtr',\n    SHMetro = 'shmetro',\n}\n\nexport enum CanvasType {\n    Destination = 'destination',\n    RunIn = 'runin',\n    RailMap = 'railmap',\n}\n\nexport const AllCanvas = 'all';\n\nexport const canvasConfig: { [s in RmgStyle]: CanvasType[] } = {\n    [RmgStyle.MTR]: [CanvasType.Destination, CanvasType.RailMap],\n    [RmgStyle.GZMTR]: [CanvasType.RunIn, CanvasType.RailMap],\n    [RmgStyle.SHMetro]: [CanvasType.Destination, CanvasType.RunIn, CanvasType.RailMap],\n};\n\n/**\n * @property {string} 0 - Chinese characters\n * @property {string} 1 - Latin characters\n */\nexport type Name = [string, string];\n\nexport enum Direction {\n    left = 'left',\n    right = 'right',\n}\n\nexport enum ShortDirection {\n    left = 'l',\n    right = 'r',\n}\n\nexport enum BranchStyle {\n    through = 'through',\n    nonThrough = 'nonthrough',\n}\n\n/**\n * Information of branch on both side.\n * @property 0 - branch type\n * @property 1 - ID of the first station of the branch (should also be one of the station's parents/children) or empty\n */\nexport type BranchInfo = Record<Direction, [BranchStyle, string] | []>;\n\nexport enum MonoColour {\n    black = '#000',\n    white = '#fff',\n}\n\nexport type ColourHex = `#${string}`;\n\n/**\n * Colour theme of line, derived from `LineEntry`.\n * @property 0 - city id\n * @property 1 - line id\n * @property 2 - background colour\n * @property 3 - foreground colour\n */\nexport type Theme = [CityCode, string, ColourHex, MonoColour];\n\nexport type InterchangeInfo = [...Theme, ...Name];\n\nexport interface StationTransfer {\n    /**\n     * Direction of text/tick of interchanges.\n     */\n    tick_direc: ShortDirection;\n    /**\n     * Flag of paid area within out-of-station interchange.\n     */\n    paid_area: boolean;\n    /**\n     * Array of name (in two languages) of all out-of-station interchange stations.\n     */\n    osi_names: Name[];\n    /**\n     * Array of arrays of interchange info.\n     * @property 0 - array of within-station interchange info\n     * @property remaining - arrays of out-of-station interchange info (from the nearest to the furthest station)\n     */\n    info: InterchangeInfo[][];\n}\n\nexport enum Services {\n    local = 'local',\n    express = 'express',\n    direct = 'direct',\n}\n\nexport enum Facilities {\n    airport = 'airport',\n    disney = 'disney',\n    hsr = 'hsr',\n    none = '',\n}\n\nexport interface StationInfo {\n    /**\n     * Station name in two languages.\n     */\n    name: Name;\n    secondaryName: false | Name;\n    /**\n     * Station number. (GZMTR specific)\n     */\n    num: string;\n    /**\n     * Dictionary of the information of branch on the station's both side.\n     */\n    branch: BranchInfo;\n    /**\n     * Array of parents' IDs.\n     */\n    parents: string[];\n    /**\n     * Array of children's IDs.\n     */\n    children: string[];\n    /**\n     * Detail of interchanges.\n     */\n    transfer: StationTransfer;\n    /**\n     * Array of services at this station.\n     */\n    services: Services[];\n    /**\n     * Facility near the station\n     */\n    facility: Facilities;\n}\n\nexport type StationDict = Record<string, StationInfo>;\n\nexport enum PanelTypeGZMTR {\n    gz1 = 'gz1',\n    gz28 = 'gz28',\n    gz2otis = 'gz2otis',\n    gz3 = 'gz3',\n    gz4 = 'gz4',\n    gz5 = 'gz5',\n    gz1421 = 'gz1421',\n    gz6 = 'gz6',\n    gzgf = 'gzgf',\n}\n\nexport enum PanelTypeShmetro {\n    sh = 'sh',\n    sh2020 = 'sh2020',\n}\n\n/**\n * Dictionary of configuration parameters for RMG, stored in `localStorage` as string.\n */\nexport interface RMGParam {\n    svgWidth: Record<CanvasType, number>;\n    svg_height: number;\n    /**\n     * Vertical position (in percentage) of line.\n     */\n    y_pc: number;\n    /**\n     * Left and right margin of line (in percentage).\n     */\n    padding: number;\n    /**\n     * Branch spacing (in pixels) of line.\n     */\n    branch_spacing: number;\n    direction: ShortDirection;\n    platform_num: string | false;\n    theme: Theme;\n    line_name: Name;\n    current_stn_idx: keyof StationDict;\n    /**\n     * Key-value pairs of the information of each station.\n     */\n    stn_list: StationDict;\n    namePosMTR: {\n        /**\n         * Flag of whether station names staggered. If false, place name above line.\n         */\n        isStagger: boolean;\n        /**\n         * Flag of flipping station names.\n         * When `isStagger === false`, names are above line if `isFlip === false`.\n         */\n        isFlip: boolean;\n    };\n    /**\n     * Customise destination sign of MTR style.\n     */\n    customiseMTRDest: {\n        /**\n         * Flag of legacy style. (Show line name before 'to').\n         */\n        isLegacy: boolean;\n        /**\n         * Customise terminal stations.\n         */\n        terminal: false | Name;\n    };\n    line_num: string;\n    psd_num: string;\n    info_panel_type: PanelTypeGZMTR | PanelTypeShmetro;\n    notesGZMTR: Note[];\n    direction_gz_x: number;\n    direction_gz_y: number;\n}\n\n/**\n * Array of a single note entry for Guangzhou Metro style.\n * @property 0 - text in Chinese characters\n * @property 1 - text in Latin characters\n * @property 2 - percentage of horizontal position\n * @property 3 - percentage of vertical position\n * @property 4 - flag of showing border\n */\nexport type Note = [string, string, number, number, boolean];\n\nexport enum LanguageCode {\n    Catalan = 'ca',\n    English = 'en',\n    Spanish = 'es',\n    French = 'fr',\n    Gaelic = 'ga',\n    Japanese = 'ja',\n    Korean = 'ko',\n    Norwegian = 'no',\n    Portuguese = 'pt',\n    Swedish = 'sv',\n    Chinese = 'zh',\n    ChineseCN = 'zh-CN',\n    ChineseSimp = 'zh-Hans',\n    ChineseTrad = 'zh-Hant',\n    ChineseHK = 'zh-HK',\n    ChineseTW = 'zh-TW',\n}\n\nexport type Translation = { [l in LanguageCode]?: string };\n\nexport interface PaletteEntry {\n    /**\n     * ID of line.\n     */\n    id: string;\n    /**\n     * Key-value pairs of multi-lingual names of the line.\n     */\n    name: Translation;\n    /**\n     * Background colour (in #HEX).\n     */\n    colour: ColourHex;\n    /**\n     * Foreground colour. Mandatory field if foreground colour is black.\n     */\n    fg?: MonoColour;\n    /**\n     * Pantone colour. If defined, colour is converted with Pantone Color Finder (https://www.pantone.com/color-finder).\n     */\n    pantone?: string;\n}","module.exports = React;","module.exports = MaterialUI;","import { AllCanvas, CanvasType, LoadingStatus, RmgStyle } from \"../../constants/constants\";\nimport { Dispatch } from 'redux';\nimport { RootState } from '../index';\n\nexport const SET_RMG_STYLE = 'SET_RMG_STYLE';\nexport const SET_CANVAS_SCALE = 'SET_CANVAS_SCALE';\nexport const SET_CANVAS_SCALE_STATUS = 'SET_CANVAS_SCALE_STATUS';\nexport const SET_CANVAS_TO_SHOW = 'SET_CANVAS_TO_SHOW';\nexport const SET_CANVAS_TO_SHOW_STATUS = 'SET_CANVAS_TO_SHOW_STATUS';\n\nexport interface setRmgStyleAction {\n    type: typeof SET_RMG_STYLE;\n    rmgStyle: RmgStyle;\n}\n\nexport interface setCanvasScaleAction {\n    type: typeof SET_CANVAS_SCALE;\n    canvasScale: number;\n}\n\nexport interface setCanvasScaleStatusAction {\n    type: typeof SET_CANVAS_SCALE_STATUS;\n    canvasScaleStatus: LoadingStatus;\n}\n\nexport interface setCanvasToShowAction {\n    type: typeof SET_CANVAS_TO_SHOW;\n    canvasToShow: CanvasType | typeof AllCanvas;\n}\n\nexport interface setCanvasToShowStatusAction {\n    type: typeof SET_CANVAS_TO_SHOW_STATUS;\n    canvasToShowStatus: LoadingStatus;\n}\n\nexport const setRmgStyle = (rmgStyle: RmgStyle) => {\n    return { type: SET_RMG_STYLE, rmgStyle } as setRmgStyleAction;\n};\n\nexport const setCanvasScale = (canvasScale: number) => {\n    return { type: SET_CANVAS_SCALE, canvasScale } as setCanvasScaleAction;\n};\n\nconst setCanvasScaleStatus = (canvasScaleStatus: LoadingStatus) => {\n    return { type: SET_CANVAS_SCALE_STATUS, canvasScaleStatus } as setCanvasScaleStatusAction;\n};\n\nexport const zoomIn = () => {\n    return async (dispatch: Dispatch<any>, getState: () => RootState) => {\n        dispatch(setCanvasScaleStatus(LoadingStatus.loading));\n        try {\n            const newScale = Number((getState().app.canvasScale + 0.1).toFixed(1));\n            dispatch(setCanvasScale(newScale));\n            await window.rmgStorage.writeFile('rmgScale', newScale.toString());\n            dispatch(setCanvasScaleStatus(LoadingStatus.loaded));\n        } catch (err) {\n            dispatch(setCanvasScaleStatus(LoadingStatus.failed));\n        }\n    };\n};\n\nexport const zoomOut = () => {\n    return async (dispatch: Dispatch<any>, getState: () => RootState) => {\n        dispatch(setCanvasScaleStatus(LoadingStatus.loading));\n        try {\n            const { canvasScale } = getState().app;\n            const newScale =\n                Number(canvasScale.toFixed(1)) <= 0.1\n                    ? Number(canvasScale.toFixed(1))\n                    : Number((canvasScale - 0.1).toFixed(1));\n            dispatch(setCanvasScale(newScale));\n            await window.rmgStorage.writeFile('rmgScale', newScale.toString());\n            dispatch(setCanvasScaleStatus(LoadingStatus.loaded));\n        } catch (err) {\n            dispatch(setCanvasScaleStatus(LoadingStatus.failed));\n        }\n    };\n};\n\nexport const setCanvasToShow = (canvasToShow: CanvasType | typeof AllCanvas) => {\n    return { type: SET_CANVAS_TO_SHOW, canvasToShow } as setCanvasToShowAction;\n};\n\n\nconst setCanvasToShowStatus = (canvasToShowStatus: LoadingStatus) => {\n    return { type: SET_CANVAS_TO_SHOW_STATUS, canvasToShowStatus } as setCanvasToShowStatusAction;\n};\n\nexport const selectCanvas = (canvas: CanvasType | typeof AllCanvas) => {\n    return async (dispatch: Dispatch<any>) => {\n        dispatch(setCanvasToShowStatus(LoadingStatus.loading));\n        try {\n            dispatch(setCanvasToShow(canvas));\n            await window.rmgStorage.writeFile('rmgCanvas', canvas);\n            dispatch(setCanvasToShowStatus(LoadingStatus.loaded));\n        } catch (err) {\n            dispatch(setCanvasToShowStatus(LoadingStatus.failed));\n        }\n    }\n}","module.exports = ReactRedux;","module.exports = ReactI18next;","module.exports = ReactRouterDOM;","import React, { createContext } from 'react';\nimport {\n    CanvasType,\n    RMGParam,\n    ShortDirection,\n    Theme,\n    PanelTypeShmetro,\n    PanelTypeGZMTR,\n    StationDict,\n    InterchangeInfo,\n    Facilities,\n    Services,\n    Note,\n    Name,\n    MonoColour,\n} from './constants/constants';\n\ninterface IParamContext {\n    param: RMGParam;\n    dispatch: React.Dispatch<ReducerAction>;\n    branches: string[][];\n    routes: string[][];\n    deps: string;\n    tpo: string[];\n}\n\nexport const ParamContext = createContext<IParamContext>({} as IParamContext);\n\ntype ReducerAction =\n    | { type: 'GLOBAL'; data: RMGParam }\n    | {\n          type: 'ANY';\n          key: string;\n          data: any;\n      }\n    | {\n          type: 'SET_HEIGHT';\n          value: number;\n      }\n    | {\n          type: 'SET_WIDTH';\n          targetId: CanvasType;\n          value: number;\n      }\n    | {\n          type: 'SET_Y';\n          value: number;\n      }\n    | {\n          type: 'SET_BRANCH_SPACING';\n          value: number;\n      }\n    | {\n          type: 'SET_PADDING';\n          value: number;\n      }\n    | {\n          type: 'SET_DIRECTION_GZ_X';\n          value: number;\n      }\n    | {\n          type: 'SET_DIRECTION_GZ_Y';\n          value: number;\n      }\n    | {\n          type: 'SET_LINE_NAME';\n          name: Name;\n      }\n    | {\n          type: 'SET_THEME';\n          theme: [string, string, string, MonoColour];\n      }\n    | {\n          type: 'SET_DIRECTION';\n      }\n    | {\n          type: 'SET_PLATFORM';\n          platform: string | false;\n      }\n    | {\n          type: 'SET_TEXT_STAGGER';\n          checked: boolean;\n      }\n    | {\n          type: 'SET_TEXT_FLIP';\n      }\n    | {\n          type: 'SET_DEST_LEGACY';\n          isLegacy: boolean;\n      }\n    | {\n          type: 'SET_TERMINAL_OVERRIDE';\n          terminal: Name | false;\n      }\n    | {\n          type: 'SET_LINE_NUM';\n          num: string;\n      }\n    | {\n          type: 'SET_PSD_NUM';\n          num: string;\n      }\n    | {\n          type: 'SET_PANEL_TYPE';\n          variant: PanelTypeGZMTR | PanelTypeShmetro;\n      }\n    | {\n          type: 'ADD_NOTE_GZMTR';\n      }\n    | {\n          type: 'REMOVE_NOTE_GZMTR';\n          idx: number;\n      }\n    | {\n          type: 'UPDATE_NOTE_GZMTR';\n          idx: number;\n          note: Note;\n      }\n    | {\n          type: 'SET_CURRENT_STATION';\n          stnId: string;\n      }\n    | {\n          type: 'REVERSE_STATIONS';\n      }\n    | {\n          type: 'UPDATE_STATION_NAME';\n          stnId: string;\n          name: Name;\n      }\n    | {\n          type: 'UPDATE_STATION_SECONDARY_NAME';\n          stnId: string;\n          name: false | Name;\n      }\n    | {\n          type: 'UPDATE_STATION_NUM';\n          stnId: string;\n          num: string;\n      }\n    | {\n          type: 'ADD_STATION_INTERCHANGE_INFO';\n          stnId: string;\n          setIdx: number;\n          info: InterchangeInfo;\n      }\n    | {\n          type: 'REMOVE_STATION_INTERCHANGE_INFO';\n          stnId: string;\n          setIdx: number;\n          intIdx: number;\n      }\n    | {\n          type: 'UPDATE_STATION_INTERCHANGE_INFO';\n          stnId: string;\n          setIdx: number;\n          intIdx: number;\n          info: InterchangeInfo;\n      }\n    | {\n          type: 'UPDATE_STATION_OSI_NAME';\n          stnId: string;\n          name: Name;\n      }\n    | {\n          type: 'UPDATE_STATION_TICK_DIREC';\n          stnId: string;\n          direction: 'l' | 'r';\n      }\n    | {\n          type: 'UPDATE_STATION_PAID_AREA';\n          stnId: string;\n          isPaid: boolean;\n      }\n    | {\n          type: 'UPDATE_STATION_BRANCH_TYPE';\n          stnId: string;\n          direction: 'left' | 'right';\n          branchType: 'through' | 'nonthrough';\n      }\n    | {\n          type: 'UPDATE_STATION_BRANCH_FIRST';\n          branches: [\n              {\n                  stnId: string;\n                  direction: 'left' | 'right';\n                  first: string;\n              },\n              {\n                  stnId: string;\n                  direction: 'left' | 'right';\n                  first: string;\n              }\n          ];\n      }\n    | {\n          type: 'UPDATE_STATION_BRANCH_POS';\n          left: string;\n          right: string;\n      }\n    | {\n          type: 'UPDATE_STATION_FACILITY';\n          stnId: string;\n          facility: '' | 'airport' | 'hsr' | 'disney';\n      }\n    | {\n          type: 'UPDATE_STATION_SERVICES';\n          stnId: string;\n          serviceId: Services;\n          isChecked: boolean;\n      }\n    | {\n          type: 'UPDATE_STATION_LIST';\n          stnList: StationDict;\n      };\n\nexport const paramReducer = (state: RMGParam, action: ReducerAction): RMGParam => {\n    switch (action.type) {\n        case 'GLOBAL':\n            return action.data;\n        case 'ANY':\n            return {\n                ...state,\n                [action.key]: action.data,\n            };\n        case 'SET_HEIGHT':\n            return {\n                ...state,\n                svg_height: action.value,\n            };\n        case 'SET_WIDTH':\n            return {\n                ...state,\n                svgWidth: {\n                    ...state.svgWidth,\n                    [action.targetId]: action.value,\n                },\n            };\n        case 'SET_Y':\n            return {\n                ...state,\n                y_pc: action.value,\n            };\n        case 'SET_BRANCH_SPACING':\n            return {\n                ...state,\n                branch_spacing: action.value,\n            };\n        case 'SET_PADDING':\n            return {\n                ...state,\n                padding: action.value,\n            };\n        case 'SET_DIRECTION_GZ_X':\n            return {\n                ...state,\n                direction_gz_x: action.value,\n            };\n        case 'SET_DIRECTION_GZ_Y':\n            return {\n                ...state,\n                direction_gz_y: action.value,\n            };\n        case 'SET_LINE_NAME':\n            return {\n                ...state,\n                line_name: action.name,\n            };\n        case 'SET_THEME':\n            return {\n                ...state,\n                theme: action.theme as Theme,\n            };\n        case 'SET_DIRECTION':\n            return {\n                ...state,\n                direction: state.direction === ShortDirection.left ? ShortDirection.right : ShortDirection.left,\n            };\n        case 'SET_PLATFORM':\n            return {\n                ...state,\n                platform_num: action.platform,\n            };\n        case 'SET_TEXT_STAGGER':\n            return {\n                ...state,\n                namePosMTR: {\n                    ...state.namePosMTR,\n                    isStagger: action.checked,\n                },\n            };\n        case 'SET_TEXT_FLIP':\n            return {\n                ...state,\n                namePosMTR: {\n                    ...state.namePosMTR,\n                    isFlip: !state.namePosMTR.isFlip,\n                },\n            };\n        case 'SET_DEST_LEGACY':\n            return {\n                ...state,\n                customiseMTRDest: {\n                    ...state.customiseMTRDest,\n                    isLegacy: action.isLegacy,\n                },\n            };\n        case 'SET_TERMINAL_OVERRIDE':\n            return {\n                ...state,\n                customiseMTRDest: {\n                    ...state.customiseMTRDest,\n                    terminal: action.terminal,\n                },\n            };\n        case 'SET_LINE_NUM':\n            return {\n                ...state,\n                line_num: action.num,\n            };\n        case 'SET_PSD_NUM':\n            return {\n                ...state,\n                psd_num: action.num,\n            };\n        case 'SET_PANEL_TYPE':\n            return {\n                ...state,\n                info_panel_type: action.variant as  PanelTypeGZMTR | PanelTypeShmetro,\n            };\n        case 'ADD_NOTE_GZMTR':\n            return {\n                ...state,\n                notesGZMTR: state.notesGZMTR?.concat([['', '', 0, 0, false]]),\n            };\n        case 'REMOVE_NOTE_GZMTR':\n            return {\n                ...state,\n                notesGZMTR: state.notesGZMTR?.filter((_, i) => i !== action.idx),\n            };\n        case 'UPDATE_NOTE_GZMTR':\n            return {\n                ...state,\n                notesGZMTR: state.notesGZMTR?.map((note, i) => (i === action.idx ? action.note : note)),\n            };\n        case 'SET_CURRENT_STATION':\n            return {\n                ...state,\n                current_stn_idx: action.stnId,\n            };\n        case 'REVERSE_STATIONS':\n            return {\n                ...state,\n                stn_list: Object.keys(state.stn_list).reduce(\n                    (acc, stnId) => ({\n                        ...acc,\n                        [stnId]: (id => {\n                            switch (id) {\n                                case 'linestart':\n                                    return {\n                                        ...state.stn_list.lineend,\n                                        parents: [],\n                                        children: state.stn_list.lineend.parents.slice().reverse(),\n                                        branch: { left: [] as [], right: state.stn_list.lineend.branch.left },\n                                    };\n                                case 'lineend':\n                                    return {\n                                        ...state.stn_list.linestart,\n                                        parents: state.stn_list.linestart.children.slice().reverse(),\n                                        children: [],\n                                        branch: { left: state.stn_list.linestart.branch.right, right: [] as [] },\n                                    };\n                                default:\n                                    return {\n                                        ...state.stn_list[id],\n                                        parents: state.stn_list[id].children\n                                            .map(id =>\n                                                id === 'linestart' ? 'lineend' : id === 'lineend' ? 'linestart' : id\n                                            )\n                                            .reverse(),\n                                        children: state.stn_list[id].parents\n                                            .map(id =>\n                                                id === 'linestart' ? 'lineend' : id === 'lineend' ? 'linestart' : id\n                                            )\n                                            .reverse(),\n                                        branch: {\n                                            left: state.stn_list[id].branch.right,\n                                            right: state.stn_list[id].branch.left,\n                                        },\n                                    };\n                            }\n                        })(stnId),\n                    }),\n                    {} as StationDict\n                ),\n            };\n        case 'UPDATE_STATION_NAME':\n            // window.myLine.updateStnName(action.stnId, action.name);\n            return {\n                ...state,\n                stn_list: {\n                    ...state.stn_list,\n                    [action.stnId]: {\n                        ...state.stn_list[action.stnId],\n                        name: action.name,\n                    },\n                },\n            };\n        case 'UPDATE_STATION_SECONDARY_NAME':\n            return {\n                ...state,\n                stn_list: {\n                    ...state.stn_list,\n                    [action.stnId]: {\n                        ...state.stn_list[action.stnId],\n                        secondaryName: action.name,\n                    },\n                },\n            };\n        case 'UPDATE_STATION_NUM':\n            // (window.myLine as RMGLineGZ).updateStnNum(action.stnId, action.num);\n            return {\n                ...state,\n                stn_list: {\n                    ...state.stn_list,\n                    [action.stnId]: {\n                        ...state.stn_list[action.stnId],\n                        num: action.num,\n                    },\n                },\n            };\n        case 'ADD_STATION_INTERCHANGE_INFO':\n            return {\n                ...state,\n                stn_list: {\n                    ...state.stn_list,\n                    [action.stnId]: {\n                        ...state.stn_list[action.stnId],\n                        transfer: {\n                            ...state.stn_list[action.stnId].transfer,\n                            info: (({ setIdx, info }) => {\n                                let nextInfo = state.stn_list[action.stnId].transfer.info.slice();\n                                nextInfo[setIdx] = (nextInfo[setIdx] || ([] as InterchangeInfo[])).concat([info]);\n                                return nextInfo;\n                            })(action),\n                        },\n                    },\n                },\n            };\n        case 'REMOVE_STATION_INTERCHANGE_INFO':\n            return {\n                ...state,\n                stn_list: {\n                    ...state.stn_list,\n                    [action.stnId]: {\n                        ...state.stn_list[action.stnId],\n                        transfer: {\n                            ...state.stn_list[action.stnId].transfer,\n                            info: state.stn_list[action.stnId].transfer.info.map((infos, i) =>\n                                i === action.setIdx\n                                    ? infos.slice(0, action.intIdx).concat(infos.slice(action.intIdx + 1))\n                                    : infos\n                            ),\n                        },\n                    },\n                },\n            };\n        case 'UPDATE_STATION_INTERCHANGE_INFO':\n            return {\n                ...state,\n                stn_list: {\n                    ...state.stn_list,\n                    [action.stnId]: {\n                        ...state.stn_list[action.stnId],\n                        transfer: {\n                            ...state.stn_list[action.stnId].transfer,\n                            info: state.stn_list[action.stnId].transfer?.info.map((infos, i) =>\n                                i === action.setIdx\n                                    ? infos.map((int, j) =>\n                                          j === action.intIdx\n                                              ? ([0, 1, 2, 3, 4, 5].map(k =>\n                                                    action.info[k] === undefined ? int[k] : action.info[k]\n                                                ) as unknown as InterchangeInfo)\n                                              : int\n                                      )\n                                    : infos\n                            ),\n                        },\n                    },\n                },\n            };\n        case 'UPDATE_STATION_OSI_NAME':\n            return {\n                ...state,\n                stn_list: {\n                    ...state.stn_list,\n                    [action.stnId]: {\n                        ...state.stn_list[action.stnId],\n                        transfer: {\n                            ...state.stn_list[action.stnId].transfer,\n                            osi_names: [action.name],\n                        },\n                    },\n                },\n            };\n        case 'UPDATE_STATION_TICK_DIREC':\n            return {\n                ...state,\n                stn_list: {\n                    ...state.stn_list,\n                    [action.stnId]: {\n                        ...state.stn_list[action.stnId],\n                        transfer: {\n                            ...state.stn_list[action.stnId].transfer,\n                            tick_direc: action.direction as ShortDirection,\n                        },\n                    },\n                },\n            };\n        case 'UPDATE_STATION_PAID_AREA':\n            return {\n                ...state,\n                stn_list: {\n                    ...state.stn_list,\n                    [action.stnId]: {\n                        ...state.stn_list[action.stnId],\n                        transfer: {\n                            ...state.stn_list[action.stnId].transfer,\n                            paid_area: action.isPaid,\n                        },\n                    },\n                },\n            };\n        case 'UPDATE_STATION_BRANCH_TYPE':\n            return {\n                ...state,\n                stn_list: {\n                    ...state.stn_list,\n                    [action.stnId]: {\n                        ...state.stn_list[action.stnId],\n                        branch: {\n                            ...state.stn_list[action.stnId].branch,\n                            [action.direction]: [\n                                action.branchType,\n                                state.stn_list[action.stnId].branch[action.direction][1],\n                            ],\n                        },\n                    },\n                },\n            };\n        case 'UPDATE_STATION_BRANCH_FIRST':\n            return {\n                ...state,\n                stn_list: {\n                    ...state.stn_list,\n                    [action.branches[0].stnId]: {\n                        ...state.stn_list[action.branches[0].stnId],\n                        branch: {\n                            ...state.stn_list[action.branches[0].stnId].branch,\n                            [action.branches[0].direction]: [\n                                state.stn_list[action.branches[0].stnId].branch[action.branches[0].direction][0],\n                                action.branches[0].first,\n                            ],\n                        },\n                    },\n                    [action.branches[1].stnId]: {\n                        ...state.stn_list[action.branches[1].stnId],\n                        branch: {\n                            ...state.stn_list[action.branches[1].stnId].branch,\n                            [action.branches[1].direction]: [\n                                state.stn_list[action.branches[1].stnId].branch[action.branches[1].direction][0],\n                                action.branches[1].first,\n                            ],\n                        },\n                    },\n                },\n            };\n        case 'UPDATE_STATION_BRANCH_POS':\n            return {\n                ...state,\n                stn_list: {\n                    ...state.stn_list,\n                    [action.left]: {\n                        ...state.stn_list[action.left],\n                        parents: state.stn_list[action.left].parents.slice().reverse(),\n                    },\n                    [action.right]: {\n                        ...state.stn_list[action.right],\n                        children: state.stn_list[action.right].children.slice().reverse(),\n                    },\n                },\n            };\n        case 'UPDATE_STATION_FACILITY':\n            return {\n                ...state,\n                stn_list: {\n                    ...state.stn_list,\n                    [action.stnId]: {\n                        ...state.stn_list[action.stnId],\n                        facility: action.facility as Facilities,\n                    },\n                },\n            };\n        case 'UPDATE_STATION_SERVICES':\n            return {\n                ...state,\n                stn_list: {\n                    ...state.stn_list,\n                    [action.stnId]: {\n                        ...state.stn_list[action.stnId],\n                        services: Array.from(\n                            action.isChecked\n                                ? new Set(state.stn_list[action.stnId].services).add(action.serviceId as Services)\n                                : state.stn_list[action.stnId].services.filter(s => s !== action.serviceId)\n                        ),\n                    },\n                },\n            };\n        case 'UPDATE_STATION_LIST':\n            return {\n                ...state,\n                stn_list: action.stnList,\n            };\n        default:\n            return state;\n    }\n};\n","import React from 'react';\nimport { StationDict } from './constants/constants';\n\n/**\n * Vertical position (in shares) of station icon if using MTR style (for consistency of method `RMGLine.newStnPossibleLoc()`).\n */\nexport const getYShareMTR = (stnId: string, stnList: StationDict): -1 | 0 | 1 => {\n    if (\n        ['linestart', 'lineend'].includes(stnId) ||\n        stnList[stnId].parents.length > 1 ||\n        stnList[stnId].children.length > 1\n    ) {\n        return 0;\n    }\n    var stnPred = stnList[stnId].parents[0];\n    if (stnPred) {\n        // parent exist\n        if (stnList[stnPred].children.length === 1) {\n            // no sibling, then y same as parent\n            return getYShareMTR(stnPred, stnList);\n        } else {\n            // sibling exists, then y depends on its idx of being children\n            return stnList[stnPred].children.indexOf(stnId) === 0 ? 1 : -1;\n        }\n    } else {\n        // no parent, must be linestart\n        return 0;\n    }\n};\n\n/**\n * Getter of all branches (支線段) of the line (both ends included). The first branch must be the main line.\n * @example MTREastRailLine.branches\n * /*\n * [0]: [LineStart, Lo Wu, ..., Hung Hom, LineEnd]\n * [1]: [LineStart, Lok Ma Chau, Sheung Shui]\n * [2]: [University, Racecourse, Sha Tin]\n * /\n */\nexport const getBranches = (stnList: StationDict) => {\n    console.log('computing branches');\n\n    var stack = ['linestart'];\n    var branches = [['linestart']];\n    var branchCount = 0;\n\n    while (stack.length) {\n        var curId = stack.shift() as string;\n        var prevId = branches[branchCount].slice().reverse()[0] || null;\n        if (prevId && curId !== 'linestart') {\n            branches[branchCount].push(curId);\n        } else {\n            branches[branchCount] = [curId];\n        }\n        while (curId !== 'lineend') {\n            prevId = curId;\n            var children = stnList[prevId].children;\n            switch (children.length) {\n                case 1:\n                    curId = children[0];\n                    break;\n                case 2:\n                    let branchNextId = stnList[prevId].branch.right[1] as string;\n                    // if (branchCount === 0) {\n                    if (stnList[prevId].branch.right[0] === 'through') {\n                        branches.push([curId]);\n                        stack.push(branchNextId);\n                    } else {\n                        if (branchCount === 0) {\n                            branches.push([prevId]);\n                            stack.push(branchNextId);\n                            // all branching out nodes are added to stack in the first loop\n                        }\n                    }\n                    curId = children.filter(stnId => stnId !== branchNextId)[0];\n                    break;\n            }\n            branches[branchCount].push(curId);\n\n            if (prevId === stnList[curId].branch.left[1]) {\n                break;\n            }\n        }\n        // branches[branchCount] = curBranch;\n        branchCount++;\n    }\n\n    return branches;\n};\n\n/**\n * Getter of all routes (行車交路) of the line (both ends included). The first branch must be the main line.\n * @example MTREastRailLine.branches\n * /*\n * [0]: [LineStart, Lo Wu, Sheung Shui, ..., Hung Hom, LineEnd]\n * [1]: [LineStart, Lok Ma Chau, Sheung Shui, ..., Hung Hom, LineEnd]\n * [2]: [LineStart, Lo Wu, Sheung Shui, ..., University, Racecourse, Sha Tin, ..., Hung Hom, LineEnd]\n * [3]: [LineStart, Lok Ma Chau, Sheung Shui, ..., University, Racecourse, Sha Tin, ..., Hung Hom, LineEnd]\n * /\n */\nexport const getRoutes = (stnList: StationDict) => {\n    console.log('computing routes');\n\n    var stack = ['linestart'];\n    var branches = [['linestart']];\n    var branchCount = 0;\n\n    while (stack.length) {\n        var curId = stack.shift() as string;\n        var prevId = branches[branchCount].slice().reverse()[0] || null;\n        if (prevId && curId !== 'linestart') {\n            branches[branchCount].push(curId);\n        } else {\n            branches[branchCount] = [curId];\n        }\n        while (curId !== 'lineend') {\n            prevId = curId;\n            var children = stnList[prevId].children;\n            switch (children.length) {\n                case 1:\n                    curId = children[0];\n                    break;\n                case 2:\n                    let branchNextId = stnList[prevId].branch.right[1] as string;\n                    // if (branchCount === 0) {\n                    if (stnList[prevId].branch.right[0] === 'through') {\n                        branches.push(branches[branchCount].slice());\n                        stack.push(branchNextId);\n                    } else {\n                        if (branchCount === 0) {\n                            branches.push([prevId]);\n                            stack.push(branchNextId);\n                        }\n                        // branches.push([prevId]);\n                    }\n                    // stack.push(branchNextId);\n                    // }\n                    curId = children.filter(stnId => stnId !== branchNextId)[0];\n                    break;\n            }\n            branches[branchCount].push(curId);\n\n            if (prevId === stnList[curId].branch.left[1] && stnList[curId].branch.left[0] === 'nonthrough') {\n                break;\n            }\n        }\n        // branches[branchCount] = curBranch;\n        branchCount++;\n    }\n\n    return branches;\n};\n\n/**\n * Memo of topological ordering for all stations by stacking all branches into an one-dimensional array.\n * @param branches Branches from `useBranches` memo\n */\nexport const useTpo = (branches: string[][]) => {\n    const [tpo, setTpo] = React.useState([] as string[]);\n\n    React.useEffect(\n        () => {\n            console.log('computing tpo');\n            if (branches.length === 1) {\n                setTpo(branches[0].slice(1, -1));\n                return;\n            } else {\n                let res = branches\n                    .reduce(\n                        (acc, cur) => {\n                            let idx = acc.indexOf(cur.slice(-1)[0]);\n                            return acc.slice(0, idx).concat(cur.slice(1), acc.slice(idx + 1));\n                        },\n                        ['lineend']\n                    )\n                    .slice(0, -1);\n                setTpo(res);\n                return;\n            }\n        },\n        // eslint-disable-next-line react-hooks/exhaustive-deps\n        [branches.toString()]\n    );\n\n    return tpo;\n};\n","module.exports = Redux;","import { LanguageCode, Note, RmgStyle, StationInfo, Translation } from \"./constants/constants\";\n\nexport const updateParam = (param: { [x: string]: any }) => {\n    // Version 0.10\n    if (!('line_name' in param)) {\n        param.line_name = ['路線名', 'Name of Line'];\n    }\n    if (!('dest_legacy' in param)) {\n        param.dest_legacy = false;\n    }\n\n    // Version 0.11\n    delete param.fontZH;\n    delete param.fontEN;\n    delete param.weightZH;\n    delete param.weightEN;\n\n    // Version 0.12\n    for (let [stnId, stnInfo] of Object.entries(param.stn_list as { [x: string]: any })) {\n        if (!('branch' in stnInfo)) {\n            param.stn_list[stnId].branch = { left: [], right: [] };\n            if (stnInfo.children.length === 2) {\n                param.stn_list[stnId].branch.right = ['through', stnInfo.children[1]];\n            } else {\n                param.stn_list[stnId].branch.right = [];\n            }\n            if (stnInfo.parents.length === 2) {\n                param.stn_list[stnId].branch.left = ['through', stnInfo.parents[1]];\n            } else {\n                param.stn_list[stnId].branch.left = [];\n            }\n        }\n    }\n\n    // Version 1.2\n    if (!('psd_num' in param)) {\n        param.psd_num = '1';\n    } else {\n        param.psd_num = param.psd_num.toString();\n    }\n\n    if (!('line_num' in param)) {\n        param.line_num = '1';\n    }\n    delete param.style;\n    if (param.theme.length === 3) {\n        param.theme.push('#fff');\n    }\n\n    // Version 1.3\n    for (let [stnId, stnInfo] of Object.entries(param.stn_list as { [x: string]: any })) {\n        if (!('num' in stnInfo)) {\n            param.stn_list[stnId].num = '00';\n        }\n        if ('interchange' in stnInfo) {\n            stnInfo.interchange.map((arr: any) => {\n                return arr.forEach((intInfo: any) => {\n                    if (intInfo.length === 5) {\n                        intInfo.splice(3, 0, '#fff');\n                    }\n                });\n            });\n        }\n    }\n\n    // Version 1.5\n    for (let [stnId, stnInfo] of Object.entries(param.stn_list as { [x: string]: any })) {\n        if (stnInfo.change_type === 'osi22_end_p') {\n            param.stn_list[stnId].change_type = 'osi22_pr';\n        }\n        if (stnInfo.change_type === 'osi22_end_u') {\n            param.stn_list[stnId].change_type = 'osi22_ur';\n        }\n    }\n\n    // Version 2.1\n    for (let [stnId, stnInfo] of Object.entries(param.stn_list as { [x: string]: any })) {\n        if (!('interchange' in stnInfo)) {\n            param.stn_list[stnId].interchange = [[]];\n        }\n    }\n\n    // Version 1.4\n    // Version 2.2\n    // Version 2.3\n    if (!('info_panel_type' in param)) {\n        param.info_panel_type = 'gz28';\n    } else {\n        param.info_panel_type = (type => {\n            switch (type) {\n                case 'gz_1':\n                case 'panasonic':\n                    return 'gz28';\n                case 'gz_2':\n                    return 'gz6';\n                case 'gz_3':\n                    return 'gz3';\n                default:\n                    return type;\n            }\n        })(param.info_panel_type);\n    }\n\n    if (!('direction_gz_x' in param)) {\n        param.direction_gz_x = 50;\n    }\n    if (!('direction_gz_y' in param)) {\n        param.direction_gz_y = 70;\n    }\n\n    // Version 2.6\n    for (let [stnId, stnInfo] of Object.entries(param.stn_list as { [x: string]: any })) {\n        if (!('transfer' in stnInfo)) {\n            param.stn_list[stnId].transfer = {\n                // type: stnInfo.change_type?.split('_')[0] as 'none' | 'int2' | 'int3' | 'osi11' | 'osi12' | 'osi22',\n                tick_direc:\n                    stnInfo.change_type === 'none' || stnInfo.change_type === 'int2'\n                        ? 'r'\n                        : (stnInfo.change_type?.split('_')[1].split('').slice().reverse()[0] as 'l' | 'r'),\n                paid_area:\n                    stnInfo.change_type?.indexOf('osi') !== -1 ? stnInfo.change_type?.split('_')[1][0] === 'p' : true,\n                osi_names: stnInfo.change_type?.indexOf('osi') !== -1 ? [stnInfo.interchange[1][0]] : [],\n                info:\n                    stnInfo.interchange.length === 2\n                        ? [stnInfo.interchange[0], stnInfo.interchange[1].slice(1)]\n                        : stnInfo.interchange,\n            };\n        }\n        delete param.stn_list[stnId].change_type;\n        delete param.stn_list[stnId].interchange;\n    }\n\n    // Version 2.8\n    // Version 3.0\n    for (let [stnId, stnInfo] of Object.entries(param.stn_list as { [x: string]: any })) {\n        if (!('services' in stnInfo)) {\n            param.stn_list[stnId].services = ['local'];\n        }\n        if (!('facility' in stnInfo)) {\n            if ('usage' in stnInfo) {\n                param.stn_list[stnId].facility = stnInfo.usage;\n            } else {\n                param.stn_list[stnId].facility = '';\n            }\n        }\n        delete param.stn_list[stnId].usage;\n    }\n\n    // Version 3.4\n    if (!('customiseMTRDest' in param)) {\n        param.customiseMTRDest = { isLegacy: param.dest_legacy || false, terminal: false };\n    }\n    delete param.dest_legacy;\n\n    // Version 3.4\n    if (!('svgWidth' in param)) {\n        param.svgWidth = {\n            destination: param.svg_dest_width,\n            runin: param.svg_dest_width,\n            railmap: param.svg_width,\n        };\n    }\n    delete param.svg_width;\n    delete param.svg_dest_width;\n\n    if (!('notesGZMTR' in param)) {\n        param.notesGZMTR = [];\n    }\n\n    param.notesGZMTR = param.notesGZMTR?.map((note: any[]) =>\n        note.length === 4 ? note.concat([false]) : note\n    ) as Note[];\n\n    // Version 3.5.3\n    delete param.char_form;\n    delete param.show_outer;\n    delete param.strip_pc;\n    delete param.txt_bg_gap;\n\n    // Version 3.5.4\n    if (!('namePosMTR' in param)) {\n        param.namePosMTR = {\n            isStagger: true,\n            isFlip: param.txt_flip,\n        };\n    }\n    delete param.txt_flip;\n\n    // Version 3.5.6\n    // Version 3.6.2\n    Object.keys(param.stn_list).forEach(stnId => {\n        if (!('secondaryName' in param.stn_list[stnId])) {\n            param.stn_list[stnId].secondaryName = false;\n        } else {\n            if (param.stn_list[stnId].secondaryName !== false && param.stn_list[stnId].secondaryName.join() === ',') {\n                param.stn_list[stnId].secondaryName = false;\n            }\n        }\n\n        if ('type' in param.stn_list[stnId].transfer) {\n            delete param.stn_list[stnId].transfer.type;\n        }\n    });\n\n    return param;\n};\n\nexport const getTransText2 = (obj: Translation, langs: LanguageCode[]) => {\n    for (let l of langs) {\n        if (obj[l]) return obj[l];\n    }\n    return obj[LanguageCode.English];\n};\n\n/**\n * Format display style of station name as `[num: ]nameZH,nameEN`.\n */\nexport const formatStnName = (stnInfo: StationInfo, style: RmgStyle) =>\n    (style === RmgStyle.GZMTR ? (stnInfo?.num || '-') + ': ' : '') + stnInfo?.name.join().replace('\\\\', ' ');\n","module.exports = i18next;","import { Translation } from \"./constants\";\n\nexport enum CityCode {\n    Barcelona = 'barcelona',\n    Beijing = 'beijing',\n    Changsha = 'changsha',\n    Chengdu = 'chengdu',\n    Chongqing = 'chongqing',\n    Dongguan = 'dongguan',\n    Edinburgh = 'edinburgh',\n    Foshan = 'foshan',\n    Glasgow = 'glasgow',\n    Guangzhou = 'guangzhou',\n    Hangzhou = 'hangzhou',\n    HongKong = 'hongkong',\n    Kansai = 'kansai',\n    Kaohsiung = 'kaohsiung',\n    London = 'london',\n    Macao = 'macao',\n    Madrid = 'madrid',\n    Nanjing = 'nanjing',\n    NewTaipei = 'newtaipei',\n    Osaka = 'osaka',\n    Oslo = 'oslo',\n    Paris = 'paris',\n    Qingdao = 'qingdao',\n    SanFrancisco = 'sanfrancisco',\n    Seoul = 'seoul',\n    Shanghai = 'shanghai',\n    Shenzhen = 'shenzhen',\n    Singapore = 'singapore',\n    Stockholm = 'stockholm',\n    Taipei = 'taipei',\n    Tianjin = 'tianjin',\n    Tokyo = 'tokyo',\n    Toronto = 'toronto',\n    TyneAndWear = 'tyneandwear',\n    Xian = 'xian',\n    Other = 'other',\n}\n\ninterface CityEntry {\n    id: CityCode;\n    /**\n     * ISO 3166-1 alpha-2 country code. (For cities in Britain, append BS 6879 subdivision code. )\n     */\n    country: string;\n    /**\n     * Key-value pairs of multi-lingual names of the city.\n     */\n    name: Translation;\n}\n\nexport const cityList: CityEntry[] = [\n    {\n        id: CityCode.Barcelona,\n        country: 'ES',\n        name: {\n            en: 'Barcelona',\n            'zh-Hans': '巴塞罗那',\n            'zh-HK': '巴塞隆拿',\n            'zh-TW': '巴塞隆納',\n        },\n    },\n    {\n        id: CityCode.Beijing,\n        country: 'CN',\n        name: {\n            en: 'Beijing',\n            zh: '北京',\n        },\n    },\n    {\n        id: CityCode.Changsha,\n        country: 'CN',\n        name: {\n            en: 'Changsha',\n            'zh-Hans': '长沙',\n            'zh-Hant': '長沙',\n        },\n    },\n    {\n        id: CityCode.Chengdu,\n        country: 'CN',\n        name: {\n            en: 'Chengdu',\n            zh: '成都',\n        },\n    },\n    {\n        id: CityCode.Chongqing,\n        country: 'CN',\n        name: {\n            en: 'Chongqing',\n            'zh-Hans': '重庆',\n            'zh-Hant': '重慶',\n        },\n    },\n    {\n        id: CityCode.Dongguan,\n        country: 'CN',\n        name: {\n            en: 'Dongguan',\n            'zh-Hans': '东莞',\n            'zh-Hant': '東莞',\n        },\n    },\n    {\n        id: CityCode.Edinburgh,\n        country: 'GBSCT',\n        name: {\n            en: 'Edinburgh',\n            ga: 'Dùn Èideann',\n            'zh-Hans': '爱丁堡',\n            'zh-Hant': '愛丁堡',\n        },\n    },\n    {\n        id: CityCode.Foshan,\n        country: 'CN',\n        name: {\n            en: 'Foshan',\n            zh: '佛山',\n        },\n    },\n    {\n        id: CityCode.Glasgow,\n        country: 'GBSCT',\n        name: {\n            en: 'Glasgow',\n            ga: 'Glaschu',\n            zh: '格拉斯哥',\n        },\n    },\n    {\n        id: CityCode.Guangzhou,\n        country: 'CN',\n        name: {\n            en: 'Guangzhou',\n            'zh-Hans': '广州',\n            'zh-Hant': '廣州',\n        },\n    },\n    {\n        id: CityCode.Hangzhou,\n        country: 'CN',\n        name: {\n            en: 'Hangzhou',\n            zh: '杭州',\n        },\n    },\n    {\n        id: CityCode.HongKong,\n        country: 'HK',\n        name: {\n            en: 'Hong Kong',\n            zh: '香港',\n        },\n    },\n    {\n        id: CityCode.Kansai,\n        country: 'JP',\n        name: {\n            en: 'Kansai Area',\n            ja: '近畿地方',\n            'zh-Hans': '近畿地方（关西地方）',\n            'zh-Hant': '近畿地方（關西地方）',\n        },\n    },\n    {\n        id: CityCode.Kaohsiung,\n        country: 'TW',\n        name: {\n            en: 'Kaohsiung',\n            zh: '高雄',\n        },\n    },\n    {\n        id: CityCode.London,\n        country: 'GBENG',\n        name: {\n            en: 'London',\n            'zh-Hans': '伦敦',\n            'zh-Hant': '倫敦',\n        },\n    },\n    {\n        id: CityCode.Macao,\n        country: 'MO',\n        name: {\n            en: 'Macao',\n            pt: 'Macau',\n            'zh-Hans': '澳门',\n            'zh-Hant': '澳門',\n        },\n    },\n    {\n        id: CityCode.Madrid,\n        country: 'ES',\n        name: {\n            en: 'Madrid',\n            'zh-Hans': '马德里',\n            'zh-Hant': '馬德里',\n        },\n    },\n    {\n        id: CityCode.Nanjing,\n        country: 'CN',\n        name: {\n            en: 'Nanjing',\n            zh: '南京',\n        },\n    },\n    {\n        id: CityCode.NewTaipei,\n        country: 'TW',\n        name: {\n            en: 'New Taipei',\n            zh: '新北',\n        },\n    },\n    {\n        id: CityCode.Osaka,\n        country: 'JP',\n        name: {\n            en: 'Osaka',\n            ja: '大阪',\n            zh: '大阪',\n        },\n    },\n    {\n        id: CityCode.Oslo,\n        country: 'NO',\n        name: {\n            en: 'Oslo',\n            'zh-Hans': '奥斯陆',\n            'zh-Hant': '奧斯陸',\n        },\n    },\n    {\n        id: CityCode.Paris,\n        country: 'FR',\n        name: {\n            en: 'Paris',\n            zh: '巴黎',\n        },\n    },\n    {\n        id: CityCode.Qingdao,\n        country: 'CN',\n        name: {\n            en: 'Qingdao',\n            'zh-Hans': '青岛',\n            'zh-Hant': '青島',\n        },\n    },\n    {\n        id: CityCode.SanFrancisco,\n        country: 'US',\n        name: {\n            en: 'San Francisco',\n            'zh-Hans': '旧金山',\n            'zh-HK': '三藩市',\n            'zh-TW': '舊金山',\n        },\n    },\n    {\n        id: CityCode.Seoul,\n        country: 'KR',\n        name: {\n            en: 'Seoul (Metropolitan Area)',\n            ko: '서울(수도권)',\n            'zh-Hans': '首尔（首都圈）',\n            'zh-Hant': '首爾（首都圈）',\n        },\n    },\n    {\n        id: CityCode.Shanghai,\n        country: 'CN',\n        name: {\n            en: 'Shanghai',\n            zh: '上海',\n        },\n    },\n    {\n        id: CityCode.Shenzhen,\n        country: 'CN',\n        name: {\n            en: 'Shenzhen',\n            zh: '深圳',\n        },\n    },\n    {\n        id: CityCode.Singapore,\n        country: 'SG',\n        name: {\n            en: 'Singapore',\n            zh: '新加坡',\n        },\n    },\n    {\n        id: CityCode.Stockholm,\n        country: 'SE',\n        name: {\n            en: 'Stockholm',\n            'zh-Hans': '斯德哥尔摩',\n            'zh-Hant': '斯德哥爾摩',\n        },\n    },\n    {\n        id: CityCode.Taipei,\n        country: 'TW',\n        name: {\n            en: 'Taipei',\n            zh: '台北',\n        },\n    },\n    {\n        id: CityCode.Tianjin,\n        country: 'CN',\n        name: {\n            en: 'Tianjin',\n            zh: '天津',\n        },\n    },\n    {\n        id: CityCode.Tokyo,\n        country: 'JP',\n        name: {\n            en: 'Tokyo (Greater Tokyo Area)',\n            ja: '東京（首都圏）',\n            'zh-Hans': '东京（首都圈）',\n            'zh-Hant': '東京（首都圈）',\n        },\n    },\n    {\n        id: CityCode.Toronto,\n        country: 'CA',\n        name: {\n            en: 'Toronto',\n            'zh-Hans': '多伦多',\n            'zh-Hant': '多倫多',\n        },\n    },\n    {\n        id: CityCode.TyneAndWear,\n        country: 'GBENG',\n        name: {\n            en: 'Tyne and Wear',\n            'zh-Hans': '泰恩-威尔',\n            'zh-HK': '泰威',\n            'zh-TW': '泰恩-威爾',\n        },\n    },\n    {\n        id: CityCode.Xian,\n        country: 'CN',\n        name: {\n            en: \"Xi'an\",\n            zh: '西安',\n        },\n    },\n    {\n        id: CityCode.Other,\n        country: 'UN',\n        name: {\n            en: 'Customise',\n            'zh-Hans': '自定义',\n            'zh-Hant': '自訂',\n        },\n    },\n];\n","module.exports = ReactDOM;","module.exports = i18nextXHRBackend;","module.exports = i18nextBrowserLanguageDetector;","module.exports = ReduxThunk;","import i18n from 'i18next';\nimport { initReactI18next } from 'react-i18next';\nimport Backend from 'i18next-xhr-backend';\nimport LanguageDetector from 'i18next-browser-languagedetector';\n\ni18n.use(Backend)\n    .use(LanguageDetector)\n    .use(initReactI18next)\n    .init({\n        fallbackLng: {\n            'zh-CN': ['zh-Hans', 'en'],\n            'zh-Hant': ['zh-HK', 'en'],\n            'zh-HK': ['zh-Hant', 'en'],\n            'zh-TW': ['zh-HK', 'zh-Hant'],\n            default: ['en'],\n        },\n        // debug: true,\n        backend: {\n            // for all available options read the backend's repository readme file\n            loadPath: process.env.PUBLIC_URL + '/locale/{{lng}}.json',\n        },\n\n        interpolation: {\n            escapeValue: false, // not needed for react as it escapes by default\n        },\n    })\n    .then(t => {\n        document.title = t('title');\n        document.documentElement.setAttribute('lang', i18n.language);\n    });\n","import * as React from 'react';\nimport { useTranslation } from 'react-i18next';\nimport {\n    AppBar,\n    Toolbar,\n    Tooltip,\n    IconButton,\n    Typography,\n    Icon,\n    makeStyles,\n    createStyles,\n    Menu,\n    MenuItem,\n    Divider,\n    useMediaQuery,\n} from '@material-ui/core';\nimport { AllCanvas, canvasConfig, CanvasType } from \"./constants/constants\";\nimport { useDispatch, useSelector } from 'react-redux';\nimport { RootState } from './redux';\nimport { selectCanvas, zoomIn, zoomOut } from \"./redux/app/action\";\n\nconst useStyles = makeStyles(theme =>\n    createStyles({\n        rootLight: {\n            backgroundColor: theme.palette.primary.main,\n        },\n        rootDark: {\n            backgroundColor: theme.palette.background.paper,\n        },\n        title: {\n            flexGrow: 1,\n            color: '#fff',\n        },\n        menuButton: {\n            color: '#fff',\n        },\n    })\n);\n\nconst AppAppBar = () => {\n    const { t, i18n } = useTranslation();\n    const classes = useStyles();\n    const prefersDarkMode = useMediaQuery('(prefers-color-scheme: dark)');\n\n    return React.useMemo(\n        () => (\n            <AppBar position=\"sticky\" className={prefersDarkMode ? classes.rootDark : classes.rootLight}>\n                <Toolbar variant=\"dense\">\n                    <Typography variant=\"h6\" className={classes.title} color=\"textPrimary\">\n                        {process.env.PUBLIC_URL.includes('uat') ? t('titleUAT') : t('title')}\n                    </Typography>\n\n                    <CanvasToggle />\n                    <ZoomToggles />\n                </Toolbar>\n            </AppBar>\n        ),\n        // eslint-disable-next-line react-hooks/exhaustive-deps\n        [prefersDarkMode, i18n.language]\n    );\n};\n\nexport default AppAppBar;\n\nconst CanvasToggle = () => {\n    const { t } = useTranslation();\n    const classes = useStyles();\n    const dispatch = useDispatch();\n\n    const rmgStyle = useSelector((store: RootState) => store.app.rmgStyle);\n\n    const [canvasButtonEl, setCanvasButtonEl] = React.useState<null | HTMLElement>(null);\n    const handleClick = (action: CanvasType | typeof AllCanvas) => () => {\n        dispatch(selectCanvas(action));\n        setCanvasButtonEl(null);\n    };\n\n    return React.useMemo(\n        () => (\n            <>\n                <Tooltip title={t('toggle.tooltip')}>\n                    <IconButton onClick={e => setCanvasButtonEl(e.currentTarget)} className={classes.menuButton}>\n                        <Icon>photo_library</Icon>\n                    </IconButton>\n                </Tooltip>\n                <Menu anchorEl={canvasButtonEl} open={Boolean(canvasButtonEl)} onClose={() => setCanvasButtonEl(null)}>\n                    {canvasConfig[rmgStyle].map(c => (\n                        <MenuItem key={c} onClick={handleClick(c)}>\n                            {t('toggle.' + c)}\n                        </MenuItem>\n                    ))}\n                    <Divider style={{ margin: '6px 0' }} />\n                    <MenuItem onClick={handleClick(AllCanvas)}>{t('toggle.all')}</MenuItem>\n                </Menu>\n            </>\n        ),\n        // eslint-disable-next-line react-hooks/exhaustive-deps\n        [rmgStyle, canvasButtonEl, classes.menuButton]\n    );\n};\n\nconst ZoomToggles = () => {\n    const { t } = useTranslation();\n    const classes = useStyles();\n    const dispatch = useDispatch();\n\n    return React.useMemo(\n        () => (\n            <>\n                <Tooltip title={t('zoom.out')}>\n                    <IconButton\n                        onClick={() => dispatch(zoomOut())}\n                        className={classes.menuButton}\n                    >\n                        <Icon>zoom_out</Icon>\n                    </IconButton>\n                </Tooltip>\n                <Tooltip title={t('zoom.in')}>\n                    <IconButton\n                        onClick={() => dispatch(zoomIn())}\n                        className={classes.menuButton}\n                    >\n                        <Icon>zoom_in</Icon>\n                    </IconButton>\n                </Tooltip>\n            </>\n        ),\n        // eslint-disable-next-line react-hooks/exhaustive-deps\n        [classes.menuButton]\n    );\n};\n","import React from 'react';\n\nexport default class ErrorBoundary extends React.Component<{ children: React.ReactNode }, { hasError: boolean }> {\n    constructor(props: { children: React.ReactNode }) {\n        super(props);\n        this.state = { hasError: false };\n    }\n\n    static getDerivedStateFromError(error: any) {\n        // Update state so the next render will show the fallback UI.\n        return { hasError: true };\n    }\n\n    componentDidCatch(error: any, errorInfo: any) {\n        // You can also log the error to an error reporting service\n        // logErrorToMyService(error, errorInfo);\n    }\n\n    render() {\n        if (this.state.hasError) {\n            // You can render any custom fallback UI\n            return <h1>Something went wrong.</h1>;\n        }\n\n        return this.props.children;\n    }\n}\n","import React, { lazy, memo, useEffect } from 'react';\nimport { CircularProgress, createStyles, makeStyles } from '@material-ui/core';\nimport { ParamContext } from '../context';\nimport { Redirect, Route, Switch } from 'react-router-dom';\nimport ErrorBoundary from '../error-boundary';\n\nimport { AllCanvas, canvasConfig, CanvasType, RmgStyle } from '../constants/constants';\nimport { useDispatch, useSelector } from 'react-redux';\nimport { selectCanvas, setRmgStyle } from '../redux/app/action';\nimport { RootState } from '../redux';\n\nconst useStyles = makeStyles(() =>\n    createStyles({\n        root: {\n            display: 'flex',\n            flexDirection: 'row',\n            overflowX: 'scroll',\n            '&::before, &::after': {\n                content: '\"\"',\n                margin: 'auto',\n            },\n            '& > svg': {\n                flex: '0 0 auto',\n                border: '1px solid black',\n            },\n        },\n    })\n);\n\nconst SVGs = () => {\n    const classes = useStyles();\n\n    const { param } = React.useContext(ParamContext);\n\n    const canvasScale = useSelector((store: RootState) => store.app.canvasScale);\n\n    const sharedProps = React.useCallback(\n        (canvas: CanvasType): React.SVGProps<SVGSVGElement> => ({\n            id: canvas,\n            xmlns: 'http://www.w3.org/2000/svg',\n            xmlnsXlink: 'http://www.w3.org/1999/xlink',\n            height: param.svg_height * canvasScale,\n            viewBox: `0 0 ${param.svgWidth[canvas]} ${param.svg_height}`,\n            colorInterpolationFilters: 'sRGB',\n            style: {\n                ['--rmg-svg-width' as any]: param.svgWidth[canvas] + 'px',\n                ['--rmg-svg-height' as any]: param.svg_height + 'px',\n                ['--rmg-theme-colour' as any]: param.theme[2],\n                ['--rmg-theme-fg' as any]: param.theme[3],\n            },\n        }),\n        // eslint-disable-next-line react-hooks/exhaustive-deps\n        [param.svg_height, JSON.stringify(param.svgWidth), param.theme[2], param.theme[3], canvasScale]\n    );\n\n    return (\n        <div className={classes.root}>\n            <Switch>\n                {(Object.entries(canvasConfig) as [RmgStyle, CanvasType[]][]).map(([s, canvases]) => (\n                    <Route path={`/${s}`} key={s}>\n                        <StyleSpecificSVGs style={s} canvasAvailable={canvasList[s]} svgProps={sharedProps} />\n                    </Route>\n                ))}\n                <Redirect to={'/' + RmgStyle.MTR} />\n            </Switch>\n        </div>\n    );\n};\n\nexport default SVGs;\n\nconst StyleSpecificSVGs = memo(\n    (props: {\n        style: RmgStyle;\n        canvasAvailable: { [canvas in CanvasType]?: JSX.Element };\n        svgProps: (canvas: CanvasType) => React.SVGProps<SVGSVGElement>;\n    }) => {\n        const dispatch = useDispatch();\n\n        const canvasToShow = useSelector((store: RootState) => store.app.canvasToShow);\n\n        dispatch(setRmgStyle(props.style));\n\n        useEffect(\n            () => {\n                ['share', ...Object.values(CanvasType)].forEach(canvas => {\n                    if (canvas in props.canvasAvailable || canvas === 'share') {\n                        (document.getElementById('css_' + canvas) as HTMLLinkElement).href =\n                            process.env.PUBLIC_URL + `/styles/${canvas}_${props.style}.css`;\n                    } else {\n                        (document.getElementById('css_' + canvas) as HTMLLinkElement).href = '';\n                    }\n                });\n                \n                ![...canvasConfig[props.style], AllCanvas].includes(canvasToShow) && dispatch(selectCanvas(AllCanvas));\n            },\n            // eslint-disable-next-line react-hooks/exhaustive-deps\n            []\n        );\n\n        return (\n            <>\n                {(Object.keys(props.canvasAvailable) as (keyof typeof props.canvasAvailable)[]).map(\n                    canvas =>\n                        [AllCanvas, canvas].includes(canvasToShow) && (\n                            <React.Suspense key={canvas} fallback={<CircularProgress />}>\n                                <ErrorBoundary>\n                                    <svg {...props.svgProps(canvas)}>\n                                        <rect\n                                            id=\"canvas-bg\"\n                                            fill=\"white\"\n                                            style={{ height: 'var(--rmg-svg-height)', width: 'var(--rmg-svg-width)' }}\n                                        />\n                                        {props.canvasAvailable[canvas]}\n                                        <rect\n                                            id=\"canvas-border\"\n                                            fill=\"none\"\n                                            strokeWidth={3}\n                                            stroke=\"none\"\n                                            style={{ height: 'var(--rmg-svg-height)', width: 'var(--rmg-svg-width)' }}\n                                        />\n                                    </svg>\n                                </ErrorBoundary>\n                            </React.Suspense>\n                        )\n                )}\n            </>\n        );\n    }\n);\n\n// Canvas available\n\nconst RunInGZMTR = lazy(() => import(/* webpackChunkName: \"runinGZMTR\" */ './runin/runin-gzmtr'));\nconst RailMapGZMTR = lazy(() => import(/* webpackChunkName: \"railmapGZMTR\" */ './railmap/railmap-gzmtr'));\n\nconst DestinationMTR = lazy(() => import(/* webpackChunkName: \"destinationMTR\" */ './destination/destination-mtr'));\nconst RailMapMTR = lazy(() => import(/* webpackChunkName: \"railmapMTR\" */ './railmap/railmap-mtr'));\n\nconst DestinationSHMetro = lazy(() =>\n    import(/* webpackChunkName: \"destinationSHMetro\" */ './destination/destination-shmetro')\n);\nconst RunInSHMetro = lazy(() => import(/* webpackChunkName: \"runinSHMetro\" */ './runin/runin-shmetro'));\nconst RailMapSHMetro = lazy(() => import(/* webpackChunkName: \"railmapSHMetro\" */ './railmap/railmap-shmetro'));\n\n/**\n * Each value of this object is an object of ORDERED key-value pairs\n */\nconst canvasList: { [s in RmgStyle]: { [c in CanvasType]?: JSX.Element } } = {\n    [RmgStyle.GZMTR]: {\n        [CanvasType.RunIn]: <RunInGZMTR />,\n        [CanvasType.RailMap]: <RailMapGZMTR />,\n    },\n    [RmgStyle.MTR]: {\n        [CanvasType.Destination]: <DestinationMTR />,\n        [CanvasType.RailMap]: <RailMapMTR />,\n    },\n    [RmgStyle.SHMetro]: {\n        [CanvasType.Destination]: <DestinationSHMetro />,\n        [CanvasType.RunIn]: <RunInSHMetro />,\n        [CanvasType.RailMap]: <RailMapSHMetro />,\n    },\n};\n","import SVGs from './svg';\n\nexport default SVGs;","import * as React from 'react';\n\nimport {\n    Typography,\n    CircularProgress,\n    Tabs,\n    Tab,\n    Icon,\n    makeStyles,\n    createStyles,\n    useTheme,\n    useMediaQuery,\n} from '@material-ui/core';\nimport { useTranslation } from 'react-i18next';\n\nconst PanelSave = React.lazy(() => import(/* webpackChunkName: \"panelSave\" */ './save'));\nconst PanelLayout = React.lazy(() => import(/* webpackChunkName: \"panelLayout\" */ './layout'));\nconst PanelDesign = React.lazy(() => import(/* webpackChunkName: \"panelDesign\" */ './design'));\nconst PanelStations = React.lazy(() => import(/* webpackChunkName: \"panelStations\" */ './stations'));\nconst PanelInfo = React.lazy(() => import(/* webpackChunkName: \"panelInfo\" */ './panel-info'));\n\nconst useStyles = makeStyles(theme =>\n    createStyles({\n        root: {\n            display: 'flex',\n            flexDirection: 'row',\n            height: '100%',\n            [theme.breakpoints.down('xs')]: {\n                flexDirection: 'column',\n            },\n        },\n        typography: {\n            background: theme.palette.background.default,\n        },\n        tab: {\n            padding: '6px 24px',\n            height: 48,\n            '& .MuiTab-wrapper': {\n                flexDirection: 'row',\n            },\n            [theme.breakpoints.up('sm')]: {\n                '& .MuiTab-wrapper': {\n                    justifyContent: 'flex-start',\n                },\n            },\n            [theme.breakpoints.down('xs')]: {\n                minWidth: 'calc(100% / 5)',\n            },\n            '&.MuiTab-labelIcon': {\n                minHeight: 'unset',\n                '& .MuiTab-wrapper': {\n                    '& > *:first-child': {\n                        marginBottom: 0,\n                    },\n                    '& > *:not(first-child)': {\n                        paddingLeft: 8,\n                    },\n                },\n            },\n        },\n        tabs: {\n            overflow: 'auto',\n            '&::-webkit-scrollbar': {\n                width: 0,\n            },\n            scrollbarWidth: 'none',\n            WebkitOverflowScrolling: 'touch',\n        },\n        tabpanel: {\n            overflow: 'auto',\n            flex: 1,\n            padding: theme.spacing(3),\n            paddingBottom: 0,\n            height: `calc(100% - ${theme.spacing(3)}px)`,\n            display: 'flex',\n            justifyContent: 'center',\n            alignItems: 'flex-start',\n        },\n    })\n);\n\nexport default function PanelTab() {\n    const { t, i18n } = useTranslation();\n\n    const classes = useStyles();\n    const theme = useTheme();\n    const isMobile = useMediaQuery(theme.breakpoints.down('xs'));\n\n    const [value, setValue] = React.useState(0);\n\n    const panel = (index: number) => {\n        switch (index) {\n            case 0:\n                return <PanelSave />;\n            case 1:\n                return <PanelLayout />;\n            case 2:\n                return <PanelDesign />;\n            case 3:\n                return <PanelStations />;\n            case 4:\n                return <PanelInfo />;\n            default:\n                return <PanelSave />;\n        }\n    };\n\n    const tabNav = React.useMemo(\n        () => (\n            <Typography className={`${classes.typography} ${classes.tabs}`} component=\"div\">\n                <Tabs\n                    value={value}\n                    orientation={isMobile ? 'horizontal' : 'vertical'}\n                    indicatorColor=\"primary\"\n                    textColor=\"primary\"\n                    onChange={(_, val) => setValue(val)}\n                    variant=\"scrollable\"\n                    scrollButtons=\"off\"\n                >\n                    {[\n                        ['file', 'insert_drive_file'],\n                        ['layout', 'panorama'],\n                        ['design', 'brush'],\n                        ['stations', 'directions_transit'],\n                        ['info', 'info'],\n                    ].map((val, i) => (\n                        <Tab\n                            label={<span>{t('tab.' + val[0])}</span>}\n                            icon={<Icon>{val[1]}</Icon>}\n                            key={i}\n                            className={classes.tab}\n                        />\n                    ))}\n                </Tabs>\n            </Typography>\n        ),\n        // eslint-disable-next-line react-hooks/exhaustive-deps\n        [value, i18n.language, classes.tab, isMobile]\n    );\n\n    return (\n        <div className={classes.root}>\n            {tabNav}\n            <Typography className={`${classes.typography} ${classes.tabpanel}`} component=\"div\" role=\"tabpanel\">\n                <React.Suspense fallback={<CircularProgress />}>{panel(value)}</React.Suspense>\n            </Typography>\n        </div>\n    );\n}\n","import * as React from 'react';\nimport { CircularProgress } from '@material-ui/core';\n\nimport PanelTabs from './panels';\n\nexport default function Panel() {\n    return (\n        <React.Suspense fallback={<CircularProgress />}>\n            <PanelTabs />\n        </React.Suspense>\n    );\n}\n","import React, { useMemo, useEffect, useReducer } from 'react';\nimport { BrowserRouter } from 'react-router-dom';\nimport AppAppBar from './app-appbar';\nimport SVGs from './svgs';\nimport Panels from './panels';\nimport { getBranches, useTpo, getRoutes } from './methods';\nimport { ParamContext, paramReducer } from './context';\nimport { createMuiTheme, ThemeProvider, useMediaQuery, LinearProgress } from '@material-ui/core';\nimport { RMGParam, StationInfo } from \"./constants/constants\";\n\nconst darkTheme = createMuiTheme({\n    palette: {\n        type: 'dark',\n        primary: {\n            main: '#bb86fc',\n        },\n        secondary: {\n            main: '#018786',\n        },\n        error: {\n            main: '#cf6679',\n        },\n    },\n    // palette: {\n    //     type: 'dark',\n    //     primary: {\n    //         main: '#8ab4f8',\n    //     },\n    // },\n    overrides: {\n        MuiDialog: {\n            paper: {\n                minWidth: 280,\n            },\n        },\n    },\n});\n\nconst lightTheme = createMuiTheme({\n    palette: {\n        primary: {\n            light: '#bb86fc',\n            main: '#6200ee',\n        },\n        secondary: {\n            main: '#018786',\n        },\n        error: {\n            main: '#b00020',\n        },\n    },\n    // palette: {\n    //     primary: {\n    //         main: '#1a73e8',\n    //     },\n    //     text: {\n    //         primary: '#202124',\n    //         secondary: '#5f6368',\n    //     },\n    // },\n    overrides: {\n        MuiDialog: {\n            paper: {\n                minWidth: 280,\n            },\n        },\n    },\n});\n\nexport default function App() {\n    const prefersDarkMode = useMediaQuery('(prefers-color-scheme: dark)');\n    const theme = prefersDarkMode ? darkTheme : lightTheme;\n\n    return (\n        <BrowserRouter basename={process.env.PUBLIC_URL}>\n            <ThemeProvider theme={theme}>\n                <React.Suspense fallback={<LinearProgress />}>\n                    <AppAppBar />\n                </React.Suspense>\n                <AppBody />\n            </ThemeProvider>\n        </BrowserRouter>\n    );\n}\n\nconst AppBody = () => {\n    const [param, dispatch] = useReducer(paramReducer, JSON.parse(localStorage.rmgParam) as RMGParam);\n    const paramString = JSON.stringify(param);\n    useEffect(() => {\n        window.rmgStorage.writeFile('rmgParam', paramString).then()\n    }, [paramString]);\n\n    const deps = Object.keys(param.stn_list).reduce(\n        (acc, cur) =>\n            acc +\n            cur +\n            ((...k: (keyof StationInfo)[]) => (o: StationInfo) => k.reduce((a, c) => a + JSON.stringify(o[c]), ''))(\n                'parents',\n                'children',\n                'branch'\n            )(param.stn_list[cur]),\n        ''\n    );\n\n    const branches = useMemo(\n        () => getBranches(param.stn_list),\n        // eslint-disable-next-line react-hooks/exhaustive-deps\n        [deps]\n    );\n    const routes = useMemo(\n        () => getRoutes(param.stn_list),\n        // eslint-disable-next-line react-hooks/exhaustive-deps\n        [deps]\n    );\n    const tpo = useTpo(branches);\n\n    return (\n        <>\n            <ParamContext.Provider\n                value={{\n                    param,\n                    dispatch,\n                    branches,\n                    routes,\n                    deps,\n                    tpo,\n                }}\n            >\n                <div style={{ overflowY: 'auto' }}>\n                    <SVGs />\n                </div>\n                <div style={{ flex: 1, overflow: 'hidden' }}>\n                    <Panels />\n                </div>\n            </ParamContext.Provider>\n            <canvas style={{ display: 'none' }} />\n        </>\n    );\n};\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\ntype Config = {\n  onSuccess?: (registration: ServiceWorkerRegistration) => void;\n  onUpdate?: (registration: ServiceWorkerRegistration) => void;\n};\n\nexport function register(config?: Config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(\n      process.env.PUBLIC_URL,\n      window.location.href\n    );\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl: string, config?: Config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl: string, config?: Config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' }\n  })\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready\n      .then(registration => {\n        registration.unregister();\n      })\n      .catch(error => {\n        console.error(error.message);\n      });\n  }\n}\n","export const FILE_NOT_FOUND = 'FILE_NOT_FOUND';\n\nexport default interface StorageService {\n    init: () => Promise<void>;\n\n    writeFile: (filename: string, contents: string) => Promise<void>;\n\n    readFile: (filename: string) => Promise<string>;\n\n    deleteFile: (filename: string) => Promise<void>;\n}\n","import { FILE_NOT_FOUND } from './storageService';\n\nexport default class StorageLocalStorage<StorageService> {\n    private currentBusyFilename: false | string;\n\n    constructor() {\n        this.currentBusyFilename = false;\n    }\n\n    async init() {\n        console.warn('Using localStorage, please update your browser');\n\n        if (!window.localStorage) {\n            alert('Local storage is not available! Please upgrade to a newer browser!');\n            throw new Error('LocalStorage unavailable');\n        }\n\n        try {\n            window.localStorage.setItem('storage_test', '1');\n            window.localStorage.removeItem('storage_test');\n        } catch (e) {\n            alert(\n                \"Local storage is not accessible! Please modify your browser's settings or try with another browser!\"\n            );\n            throw new Error('LocalStorage no write permission');\n        }\n    }\n\n    async writeFile(filename: string, contents: string) {\n        if (this.currentBusyFilename === filename) {\n            console.warn('Attempt to write', filename, 'while write process is not finished!');\n        }\n\n        this.currentBusyFilename = filename;\n        window.localStorage.setItem(filename, contents);\n        this.currentBusyFilename = false;\n    }\n\n    async readFile(filename: string) {\n        if (this.currentBusyFilename === filename) {\n            console.warn('Attempt to read', filename, 'while write process is not finished!');\n        }\n\n        const contents = window.localStorage.getItem(filename);\n        if (!contents) {\n            throw new Error(FILE_NOT_FOUND);\n        }\n        return contents;\n    }\n\n    async deleteFile(filename: string) {\n        if (this.currentBusyFilename === filename) {\n            console.warn('Attempt to delete', filename, 'while write process is not finished!');\n        }\n\n        this.currentBusyFilename = filename;\n        window.localStorage.removeItem(filename);\n        this.currentBusyFilename = false;\n    }\n}\n","import StorageLocalStorage from './storageLocalStorage';\nimport StorageService from './storageService';\nimport StorageIndexedDB from './storageIndexedDB';\n\nexport default async function getRmgStorage(): Promise<StorageService> {\n    if (!window.indexedDB) {\n        console.log('IndexedDB not supported');\n        return new StorageLocalStorage();\n    }\n\n    return await new Promise<StorageService>(resolve => {\n        try {\n            const request = window.indexedDB.open('indexeddb_feature_detection', 1);\n\n            request.onerror = err => {\n                console.log('IndexedDB can NOT be accessed:', err);\n                console.log('Fallback to LocalStorage');\n                resolve(new StorageLocalStorage());\n            };\n\n            request.onsuccess = () => {\n                console.log('IndexedDB can be accessed');\n                // TODO: toggle on indexedDB\n                // resolve(new StorageIndexedDB());\n                resolve(new StorageLocalStorage());\n            };\n        } catch (error) {\n            console.warn('Error while opening IndexedDB:', error);\n            resolve(new StorageLocalStorage());\n        }\n    });\n}\n","import { AllCanvas, CanvasType, LoadingStatus, RmgStyle } from '../../constants/constants';\nimport {\n    SET_CANVAS_SCALE,\n    SET_CANVAS_SCALE_STATUS,\n    SET_CANVAS_TO_SHOW,\n    SET_CANVAS_TO_SHOW_STATUS,\n    SET_RMG_STYLE,\n    setCanvasScaleAction,\n    setCanvasScaleStatusAction,\n    setCanvasToShowAction, setCanvasToShowStatusAction,\n    setRmgStyleAction\n} from \"./action\";\n\ninterface AppState {\n    rmgStyle: RmgStyle;\n    canvasScale: number;\n    canvasScaleStatus: LoadingStatus;\n    canvasToShow: CanvasType | typeof AllCanvas;\n    canvasToShowStatus: LoadingStatus;\n}\n\nconst initialState: AppState = {\n    rmgStyle: RmgStyle.MTR,\n    canvasScale: 1,\n    canvasScaleStatus: LoadingStatus.init,\n    canvasToShow: AllCanvas,\n    canvasToShowStatus: LoadingStatus.init,\n};\n\nexport default function AppReducer(\n    state = initialState,\n    action: setRmgStyleAction | setCanvasScaleAction | setCanvasScaleStatusAction | setCanvasToShowAction | setCanvasToShowStatusAction\n): AppState {\n    switch (action.type) {\n        case SET_RMG_STYLE:\n            state.rmgStyle = action.rmgStyle;\n            break;\n        case SET_CANVAS_SCALE:\n            state.canvasScale = action.canvasScale;\n            break;\n        case SET_CANVAS_SCALE_STATUS:\n            state.canvasScaleStatus = action.canvasScaleStatus;\n            break;\n        case SET_CANVAS_TO_SHOW:\n            state.canvasToShow = action.canvasToShow;\n            break;\n        case SET_CANVAS_TO_SHOW_STATUS:\n            state.canvasToShowStatus = action.canvasToShowStatus;\n            break;\n        default:\n            break;\n    }\n\n    return { ...state };\n}\n","import { RMGParam } from '../../constants/constants';\n\nexport const SET_FULL_PARAM = 'SET_FULL_PARAM';\n\nexport interface setFullParamAction {\n    type: typeof SET_FULL_PARAM;\n    fullParam: RMGParam;\n}\n\nexport const setFullParam = (fullParam: RMGParam) => {\n    return { type: SET_FULL_PARAM, fullParam } as setFullParamAction;\n};\n","import { CityCode } from '../../constants/city-config';\nimport { MonoColour, PanelTypeGZMTR, RMGParam, ShortDirection } from '../../constants/constants';\nimport { SET_FULL_PARAM, setFullParamAction } from \"./action\";\n\nconst initialState: RMGParam = {\n    svgWidth: {\n        destination: 100,\n        runin: 100,\n        railmap: 100,\n    },\n    svg_height: 100,\n    y_pc: 50,\n    padding: 10,\n    branch_spacing: 10,\n    direction: ShortDirection.left,\n    platform_num: '1',\n    theme: [CityCode.HongKong, 'twl', '#E2231A', MonoColour.white],\n    line_name: ['線', 'line'],\n    current_stn_idx: '',\n    stn_list: {},\n    namePosMTR: {\n        isStagger: true,\n        isFlip: true,\n    },\n    customiseMTRDest: {\n        isLegacy: true,\n        terminal: false,\n    },\n    line_num: '1',\n    psd_num: '1',\n    info_panel_type: PanelTypeGZMTR.gz1,\n    notesGZMTR: [],\n    direction_gz_x: 0,\n    direction_gz_y: 0,\n};\n\nexport default function ParamReducer(state = initialState, action: setFullParamAction) {\n    switch (action.type) {\n        case SET_FULL_PARAM:\n            return action.fullParam;\n        default:\n            break;\n    }\n    return { ...state };\n}\n","import { applyMiddleware, combineReducers, createStore } from 'redux';\nimport thunk, { ThunkMiddleware } from 'redux-thunk';\nimport AppReducer from './app/reducer';\nimport ParamReducer from './param/reducer';\n\nconst rootReducer = combineReducers({\n    app: AppReducer,\n    param: ParamReducer,\n});\n\nexport type RootState = ReturnType<typeof rootReducer>;\nexport default createStore(rootReducer, applyMiddleware(thunk as ThunkMiddleware<RootState>));\n","import * as React from 'react';\nimport * as ReactDOM from 'react-dom';\nimport './index.css';\nimport './i18n';\nimport App from './App';\nimport { updateParam } from './utils';\nimport * as serviceWorker from './serviceWorker';\n\nimport { AllCanvas, CanvasType } from './constants/constants';\nimport StorageService from './util/storage/storageService';\nimport getRmgStorage from './util/storage';\nimport store from './redux';\nimport { Provider } from 'react-redux';\nimport { setCanvasScale, setCanvasToShow } from './redux/app/action';\nimport { setFullParam } from './redux/param/action';\n\ndeclare global {\n    interface Window {\n        gtag: any;\n        rmgStorage: StorageService;\n        rmgStore: any;\n    }\n}\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n\n// load empty stylesheet elements\ndocument.head.append(\n    ...['share', ...Object.values(CanvasType)].map(tag => {\n        let link = document.createElement('link');\n        link.rel = 'stylesheet';\n        link.id = 'css_' + tag;\n        return link;\n    })\n);\n\nconst renderApp = () => {\n    ReactDOM.render(\n        // <React.StrictMode>\n        <Provider store={store}>\n            <App />\n        </Provider>,\n        // </React.StrictMode>,\n        document.getElementById('root')\n    );\n};\n\ngetRmgStorage()\n    .then(async rmgStorage => {\n        // setup storage and param\n        await rmgStorage.init();\n        try {\n            const contents = await rmgStorage.readFile('rmgParam');\n\n            const updatedParam = updateParam(JSON.parse(contents));\n            await rmgStorage.writeFile('rmgParam', JSON.stringify(updatedParam));\n        } catch (err) {\n            console.warn('Error in reading rmgParam', err);\n            const module = await import('./constants/templates/basic/blank');\n            const updatedParam = updateParam(module.default);\n            await rmgStorage.writeFile('rmgParam', JSON.stringify(updatedParam));\n        } finally {\n            window.rmgStorage = rmgStorage;\n        }\n    })\n    .then(async () => {\n        // init param store with localStorage\n        const contents = await window.rmgStorage.readFile('rmgParam');\n        store.dispatch(setFullParam(JSON.parse(contents)));\n    })\n    .then(async () => {\n        // style being setup in SVG's router\n\n        // setup canvas scale\n        try {\n            const canvasScaleString = await window.rmgStorage.readFile('rmgScale');\n            const canvasScale = Number(canvasScaleString);\n            canvasScale >= 0.1 && store.dispatch(setCanvasScale(canvasScale));\n        } catch (err) {\n            console.warn('Error in reading rmgScale file', err);\n            console.log('Initiating rmgScale as 1');\n            await window.rmgStorage.writeFile('rmgScale', '1');\n            store.dispatch(setCanvasScale(1));\n        }\n\n        // setup canvas to show\n        try {\n            const canvasToShow = await window.rmgStorage.readFile('rmgCanvas') as CanvasType | typeof AllCanvas;\n            store.dispatch(setCanvasToShow(canvasToShow));\n        } catch(err) {\n            console.warn('Error in reading rmgCanvas file', err);\n            console.log('Initiating rmgCanvas as \"all\"');\n            await window.rmgStorage.writeFile('rmgCanvas', AllCanvas);\n            store.dispatch(setCanvasToShow(AllCanvas));\n        }\n\n        window.rmgStore = store;\n    })\n    .then(() => {\n        renderApp();\n    });\n"],"sourceRoot":""}