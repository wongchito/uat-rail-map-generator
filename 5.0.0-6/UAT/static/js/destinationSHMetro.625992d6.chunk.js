"use strict";(self.webpackChunkrail_map_generator=self.webpackChunkrail_map_generator||[]).push([[9586],{4074:function(e,n,t){t.r(n);var r=t(885),a=t(2982),i=t(2791),s=t(6169),c=t(184);n.default=(0,i.memo)((function(){return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(l,{}),(0,c.jsx)(o,{})]})}));var l=(0,i.memo)((function(){return(0,c.jsx)("defs",{children:(0,c.jsx)("marker",{id:"slope",viewBox:"-1.5 0 3 1.5",refY:.5,children:(0,c.jsx)("path",{d:"M0,0L1,1H-1z",fill:"var(--rmg-theme-colour)"})})})})),o=function(){var e=(0,s.CG)((function(e){return e.helper})),n=e.routes,t=e.branches,l=(0,s.CG)((function(e){return e.param})),o=l.line_name,h=l.current_stn_idx,x=l.direction,g=l.stn_list,j=l.platform_num,_=l.info_panel_type,p=l.svgWidth,v=l.svg_height,w=l.loop,z=w?function(){var e=t[0].filter((function(e){return!["linestart","lineend"].includes(e)})),n=[].concat((0,a.Z)("l"===x?e:e.reverse()),(0,a.Z)("l"===x?e:e.reverse()),(0,a.Z)("l"===x?e:e.reverse())),r=n.findIndex((function(e){return h===e}));return n.slice(r+1).filter((function(e){return g[e].loop_pivot})).slice(void 0,2).reverse()}():(0,a.Z)(new Set(n.filter((function(e){return e.includes(h)})).map((function(e){var n=e.filter((function(e){return!["linestart","lineend"].includes(e)}));return"l"===x?n[0]:n.reverse()[0]})))),S=w||"sh2020"===_?z.map((function(e){return g[e].name.map((function(e){return e.replace("\\"," ")}))})):[[z.map((function(e){return g[e].name[0]})).join("\uff0c"),z.map((function(e){return g[e].name[1]})).join(", ").replace("\\"," ")]],N=(0,i.useRef)(null),k=(0,i.useState)({width:0}),Z=(0,r.Z)(k,2),B=Z[0],C=Z[1];(0,i.useEffect)((function(){return C(N.current.getBBox())}),[JSON.stringify(S),JSON.stringify(h)]);var y=p.destination/2,M=y-10-36-B.width>=162.5&&y-10-36-264>=162.5?y:"l"===x?(p.destination+B.width-264)/2:(p.destination-B.width+264)/2;return(0,c.jsxs)("g",{transform:"translate(0,".concat(v-300,")"),children:[(0,c.jsx)("path",{stroke:"var(--rmg-theme-colour)",strokeWidth:12,d:"l"===x?"M".concat(p.destination-24,",16 H 36"):"M24,16 H ".concat(p.destination-36),transform:"translate(0,220)",markerEnd:"url(#slope)"}),(0,c.jsx)(m,{ref:N,destNames:S}),!1!==j&&(0,c.jsx)("g",{transform:"translate(".concat(M,",0)"),children:(0,c.jsx)(u,{})}),o[0].match(/^[\w\d]+/)?(0,c.jsx)(d,{}):(0,c.jsx)(f,{})]})},m=(0,i.forwardRef)((function(e,n){var t=e.destNames,r=(0,s.CG)((function(e){return e.param})),a=r.direction,l=r.svgWidth;return(0,c.jsxs)("g",{ref:n,transform:"translate(".concat("l"===a?36:l.destination-36,",145)"),children:[(0,c.jsx)("g",{transform:"translate(0,".concat(2===t.length?-20:20,")"),children:(0,c.jsx)("path",{d:"M60,60L0,0L60-60H100L55-15H160V15H55L100,60z",fill:"black",transform:"rotate(".concat("l"===a?0:180,")scale(0.8)")})}),(0,c.jsx)("g",{textAnchor:"l"===a?"start":"end",transform:"translate(".concat("l"===a?148:-148,",25)"),children:t.map((function(e,n){return(0,c.jsxs)(i.Fragment,{children:[(0,c.jsx)("text",{className:"rmg-name__zh",fontSize:70,dy:-100*n+7,children:"\u5f80"+e[0]},"zh".concat(n)),(0,c.jsx)("text",{className:"rmg-name__en",fontSize:25,dy:-100*n+40,children:"To "+e[1]},"en".concat(n))]},n)}))})]})})),u=function(){var e=(0,s.CG)((function(e){return e.param}));return(0,i.useMemo)((function(){return(0,c.jsxs)("g",{transform:"translate(".concat(-102.5,",150)"),children:[(0,c.jsx)("circle",{r:60,fill:"none",stroke:"black",strokeWidth:2}),(0,c.jsx)("text",{className:"rmg-name__en",dominantBaseline:"central",fontSize:120,textAnchor:"middle",children:e.platform_num}),(0,c.jsx)("text",{className:"rmg-name__zh",fontSize:100,dominantBaseline:"central",x:65,children:"\u7ad9\u53f0"})]})}),[e.platform_num])},f=function(){var e=(0,s.CG)((function(e){return e.param})),n=e.line_name,t=e.direction,l=e.svgWidth,o="l"===t?l.destination-42:42,m=(0,i.useRef)(null),u=i.useState({width:0}),f=(0,r.Z)(u,2),d=f[0],h=f[1];i.useEffect((function(){return h(m.current.getBBox())}),(0,a.Z)(n));var x=("l"===t?-d.width:0)-6,g=("l"===t?-1:1)*d.width/2;return(0,i.useMemo)((function(){return(0,c.jsxs)("g",{transform:"translate(".concat(o,",92)"),children:[(0,c.jsx)("rect",{fill:"var(--rmg-theme-colour)",x:x,width:d.width+10,height:120}),(0,c.jsxs)("g",{textAnchor:"r"===t?"start":"end",transform:"translate(0,68)",fill:"var(--rmg-theme-fg)",children:[(0,c.jsx)("g",{ref:m,children:(0,c.jsx)("text",{className:"rmg-name__zh",fontSize:68,children:n[0]})}),(0,c.jsx)("text",{className:"rmg-name__en",fontSize:30,textAnchor:"middle",x:g,dy:42,children:n[1]})]})]})}),[d,o,t,n])},d=function(){var e=(0,s.CG)((function(e){return e.param})),n=e.line_name[0].match(/^[\w\d]+|.+/g),t=(0,r.Z)(n,2),l=t[0],o=t[1],m="l"===e.direction?e.svgWidth.destination-36-210:90;return(0,i.useMemo)((function(){return(0,c.jsxs)("g",{transform:"translate(".concat(m,",92)"),children:[(0,c.jsx)("rect",{fill:"var(--rmg-theme-colour)",x:-54,width:108,height:120}),(0,c.jsx)("text",{className:"rmg-name__zh",fill:"var(--rmg-theme-fg)",fontSize:96,textAnchor:"middle",dominantBaseline:"central",transform:"translate(0,60)",letterSpacing:-5,children:l}),(0,c.jsxs)("g",{textAnchor:"start",transform:"translate(74,68)",children:[(0,c.jsx)("text",{className:"rmg-name__zh",fontSize:68,children:o}),(0,c.jsx)("text",{className:"rmg-name__en",fontSize:30,dy:42,children:e.line_name[1]})]})]})}),[m].concat((0,a.Z)(e.line_name)))}}}]);
//# sourceMappingURL=destinationSHMetro.625992d6.chunk.js.map