(this["webpackJsonprail-map-generator"]=this["webpackJsonprail-map-generator"]||[]).push([[79],[,,,function(e,t,n){"use strict";n.d(t,"g",(function(){return a})),n.d(t,"k",(function(){return c})),n.d(t,"c",(function(){return i})),n.d(t,"a",(function(){return g})),n.d(t,"n",(function(){return p})),n.d(t,"d",(function(){return o})),n.d(t,"m",(function(){return u})),n.d(t,"b",(function(){return l})),n.d(t,"h",(function(){return d})),n.d(t,"l",(function(){return b})),n.d(t,"e",(function(){return h})),n.d(t,"i",(function(){return f})),n.d(t,"j",(function(){return j})),n.d(t,"f",(function(){return O}));var r,a,c,i,s=n(2);!function(e){e.init="init",e.loading="loading",e.loaded="loaded",e.failed="failed"}(a||(a={})),function(e){e.MTR="mtr",e.GZMTR="gzmtr",e.SHMetro="shmetro"}(c||(c={})),function(e){e.Destination="destination",e.RunIn="runin",e.RailMap="railmap",e.Indoor="indoor"}(i||(i={}));var o,u,l,d,b,h,f,j,O,g="all",p=(r={},Object(s.a)(r,c.MTR,[i.Destination,i.RailMap]),Object(s.a)(r,c.GZMTR,[i.RunIn,i.RailMap]),Object(s.a)(r,c.SHMetro,[i.Destination,i.RunIn,i.RailMap,i.Indoor]),r);!function(e){e.left="left",e.right="right"}(o||(o={})),function(e){e.left="l",e.right="r"}(u||(u={})),function(e){e.through="through",e.nonThrough="nonthrough"}(l||(l={})),function(e){e.black="#000",e.white="#fff"}(d||(d={})),function(e){e.local="local",e.express="express",e.direct="direct"}(b||(b={})),function(e){e.airport="airport",e.disney="disney",e.hsr="hsr",e.none=""}(h||(h={})),function(e){e.gz1="gz1",e.gz28="gz28",e.gz2otis="gz2otis",e.gz3="gz3",e.gz4="gz4",e.gz5="gz5",e.gz1421="gz1421",e.gz6="gz6",e.gzgf="gzgf"}(f||(f={})),function(e){e.sh="sh",e.sh2020="sh2020"}(j||(j={})),function(e){e.Catalan="ca",e.English="en",e.Spanish="es",e.French="fr",e.Gaelic="ga",e.Japanese="ja",e.Korean="ko",e.Norwegian="no",e.Portuguese="pt",e.Swedish="sv",e.Chinese="zh",e.ChineseCN="zh-CN",e.ChineseSimp="zh-Hans",e.ChineseTrad="zh-Hant",e.ChineseHK="zh-HK",e.ChineseTW="zh-TW"}(O||(O={}))},function(e,t){e.exports=React},function(e,t){e.exports=MaterialUI},,function(e,t,n){"use strict";n.d(t,"g",(function(){return c})),n.d(t,"r",(function(){return i})),n.d(t,"s",(function(){return s})),n.d(t,"u",(function(){return o})),n.d(t,"a",(function(){return u})),n.d(t,"l",(function(){return l})),n.d(t,"e",(function(){return d})),n.d(t,"f",(function(){return b})),n.d(t,"t",(function(){return h})),n.d(t,"h",(function(){return f})),n.d(t,"d",(function(){return j})),n.d(t,"n",(function(){return O})),n.d(t,"i",(function(){return g})),n.d(t,"o",(function(){return p})),n.d(t,"m",(function(){return m})),n.d(t,"k",(function(){return _})),n.d(t,"j",(function(){return v})),n.d(t,"c",(function(){return T})),n.d(t,"b",(function(){return y})),n.d(t,"p",(function(){return S})),n.d(t,"q",(function(){return w})),n.d(t,"K",(function(){return x})),n.d(t,"S",(function(){return I})),n.d(t,"T",(function(){return E})),n.d(t,"V",(function(){return N})),n.d(t,"F",(function(){return k})),n.d(t,"N",(function(){return z})),n.d(t,"I",(function(){return R})),n.d(t,"J",(function(){return M})),n.d(t,"U",(function(){return A})),n.d(t,"L",(function(){return C})),n.d(t,"H",(function(){return D})),n.d(t,"P",(function(){return H})),n.d(t,"M",(function(){return P})),n.d(t,"Q",(function(){return G})),n.d(t,"O",(function(){return F})),n.d(t,"w",(function(){return L})),n.d(t,"Z",(function(){return W})),n.d(t,"C",(function(){return U})),n.d(t,"W",(function(){return K})),n.d(t,"A",(function(){return J})),n.d(t,"X",(function(){return V})),n.d(t,"y",(function(){return X})),n.d(t,"G",(function(){return q})),n.d(t,"R",(function(){return $})),n.d(t,"E",(function(){return ee})),n.d(t,"db",(function(){return te})),n.d(t,"hb",(function(){return ne})),n.d(t,"eb",(function(){return re})),n.d(t,"v",(function(){return ae})),n.d(t,"B",(function(){return ce})),n.d(t,"Y",(function(){return ie})),n.d(t,"fb",(function(){return se})),n.d(t,"ib",(function(){return oe})),n.d(t,"gb",(function(){return ue})),n.d(t,"bb",(function(){return le})),n.d(t,"ab",(function(){return de})),n.d(t,"z",(function(){return be})),n.d(t,"cb",(function(){return he})),n.d(t,"x",(function(){return fe})),n.d(t,"D",(function(){return je}));var r=n(2),a=n(0),c="SET_FULL_PARAM",i="SET_SVG_HEIGHT",s="SET_SVG_WIDTH",o="SET_Y_PERCENTAGE",u="SET_BRANCH_SPACING",l="SET_PADDING_PERCENTAGE",d="SET_DIRECTION_INDICATOR_X",b="SET_DIRECTION_INDICATOR_Y",h="SET_THEME",f="SET_LINE_NAME",j="SET_DIRECTION",O="SET_PLATFORM",g="SET_LINE_NUM",p="SET_PSD_NUM",m="SET_PANEL_TYPE",_="SET_NOTES",v="SET_NAME_POSITION",T="SET_CUSTOMISED_MTR_DESTINATION",y="SET_CURRENT_STATION",S="SET_STATION",w="SET_STATIONS_BULK",x=function(e){return{type:c,fullParam:e}},I=function(e){return{type:i,svgHeight:e}},E=function(e,t){return{type:s,svgWidth:e,canvas:t}},N=function(e){return{type:o,yPercentage:e}},k=function(e){return{type:u,branchSpacing:e}},z=function(e){return{type:l,paddingPercentage:e}},R=function(e){return{type:d,directionIndicatorX:e}},M=function(e){return{type:b,directionIndicatorY:e}},A=function(e){return{type:h,theme:e}},C=function(e){return{type:f,lineName:e}},D=function(e){return{type:j,direction:e}},H=function(e){return{type:O,platform:e}},P=function(e){return{type:g,lineNum:e}},G=function(e){return{type:p,psdNum:e}},F=function(e){return{type:m,panelType:e}},B=function(e){return{type:_,notes:e}},L=function(){return function(e,t){var n=t().param.notesGZMTR;e(B(n.concat([["","",0,0,!1]])))}},W=function(e,t){return function(n,r){var a=r().param.notesGZMTR;n(B(a.map((function(n,r){return r===e?t:n}))))}},U=function(e){return function(t,n){var r=n().param.notesGZMTR;t(B(r.filter((function(t,n){return n!==e}))))}},Z=function(e){return{type:v,namePosition:e}},K=function(e){return function(t,n){var r=n().param.namePosMTR;t(Z(Object(a.a)(Object(a.a)({},r),{},{isStagger:e})))}},J=function(){return function(e,t){var n=t().param.namePosMTR;e(Z(Object(a.a)(Object(a.a)({},n),{},{isFlip:!n.isFlip})))}},Y=function(e){return{type:T,customisedMtrDestination:e}},V=function(e){return function(t,n){var r=n().param.customiseMTRDest;t(Y(Object(a.a)(Object(a.a)({},r),{},{isLegacy:e})))}},X=function(e){return function(t,n){var r=n().param.customiseMTRDest;t(Y(Object(a.a)(Object(a.a)({},r),{},{terminal:e})))}},q=function(e){return{type:y,currentStation:e}},Q=function(e,t){return{type:S,stationId:e,station:t}},$=function(e){return{type:w,stations:e}},ee=function(){return function(e,t){var n=t().param.stn_list,c=Object.keys(n).reduce((function(e,t){return Object(a.a)(Object(a.a)({},e),{},Object(r.a)({},t,function(e){switch(e){case"linestart":return Object(a.a)(Object(a.a)({},n.lineend),{},{parents:[],children:n.lineend.parents.slice().reverse(),branch:{left:[],right:n.lineend.branch.left}});case"lineend":return Object(a.a)(Object(a.a)({},n.linestart),{},{parents:n.linestart.children.slice().reverse(),children:[],branch:{left:n.linestart.branch.right,right:[]}});default:return Object(a.a)(Object(a.a)({},n[e]),{},{parents:n[e].children.map((function(e){return"linestart"===e?"lineend":"lineend"===e?"linestart":e})).reverse(),children:n[e].parents.map((function(e){return"linestart"===e?"lineend":"lineend"===e?"linestart":e})).reverse(),branch:{left:n[e].branch.right,right:n[e].branch.left}})}}(t)))}),{});e($(c))}},te=function(e,t){return function(n,r){var c=r().param.stn_list[e];n(Q(e,Object(a.a)(Object(a.a)({},c),{},{name:t})))}},ne=function(e,t){return function(n,r){var c=r().param.stn_list[e];n(Q(e,Object(a.a)(Object(a.a)({},c),{},{secondaryName:t})))}},re=function(e,t){return function(n,r){var c=r().param.stn_list[e];n(Q(e,Object(a.a)(Object(a.a)({},c),{},{num:t})))}},ae=function(e,t,n){return function(r,c){var i=c().param.stn_list[e],s=i.transfer.info.map((function(e){return e.slice()}));s.length>t?s[t].push(n):s[t]=[n],r(Q(e,Object(a.a)(Object(a.a)({},i),{},{transfer:Object(a.a)(Object(a.a)({},i.transfer),{},{info:s})})))}},ce=function(e,t,n){return function(r,c){var i=c().param.stn_list[e];if(i.transfer.info.length>t&&i.transfer.info[t].length>n){var s=i.transfer.info.map((function(e,r){return r===t?e.filter((function(e,t){return t!==n})):e}));r(Q(e,Object(a.a)(Object(a.a)({},i),{},{transfer:Object(a.a)(Object(a.a)({},i.transfer),{},{info:s})})))}}},ie=function(e,t,n,r){return function(c,i){var s=i().param.stn_list[e];if(s.transfer.info.length>t&&s.transfer.info[t].length>n){var o=s.transfer.info.map((function(e,a){return a===t?e.map((function(e,t){return t===n?[0,1,2,3,4,5].map((function(t){return void 0===r[t]?e[t]:r[t]})):e})):e}));c(Q(e,Object(a.a)(Object(a.a)({},s),{},{transfer:Object(a.a)(Object(a.a)({},s.transfer),{},{info:o})})))}}},se=function(e,t){return function(n,r){var c=r().param.stn_list[e];n(Q(e,Object(a.a)(Object(a.a)({},c),{},{transfer:Object(a.a)(Object(a.a)({},c.transfer),{},{osi_names:[t]})})))}},oe=function(e,t){return function(n,r){var c=r().param.stn_list[e];n(Q(e,Object(a.a)(Object(a.a)({},c),{},{transfer:Object(a.a)(Object(a.a)({},c.transfer),{},{tick_direc:t})})))}},ue=function(e,t){return function(n,r){var c=r().param.stn_list[e];n(Q(e,Object(a.a)(Object(a.a)({},c),{},{transfer:Object(a.a)(Object(a.a)({},c.transfer),{},{paid_area:t})})))}},le=function(e,t,n){return function(c,i){var s=i().param.stn_list[e];c(Q(e,Object(a.a)(Object(a.a)({},s),{},{branch:Object(a.a)(Object(a.a)({},s.branch),{},Object(r.a)({},t,[n,s.branch[t][1]]))})))}},de=function(e){return function(t,n){var c,i=n().param.stn_list;t($(Object(a.a)(Object(a.a)({},i),{},(c={},Object(r.a)(c,e[0].stnId,Object(a.a)(Object(a.a)({},i[e[0].stnId]),{},{branch:Object(a.a)(Object(a.a)({},i[e[0].stnId].branch),{},Object(r.a)({},e[0].direction,[i[e[0].stnId].branch[e[0].direction][0],e[0].first]))})),Object(r.a)(c,e[1].stnId,Object(a.a)(Object(a.a)({},i[e[1].stnId]),{},{branch:Object(a.a)(Object(a.a)({},i[e[1].stnId].branch),{},Object(r.a)({},e[1].direction,[i[e[1].stnId].branch[e[1].direction][0],e[1].first]))})),c))))}},be=function(e,t){return function(n,c){var i,s=c().param.stn_list;n($(Object(a.a)(Object(a.a)({},s),{},(i={},Object(r.a)(i,e,Object(a.a)(Object(a.a)({},s[e]),{},{parents:s[e].parents.slice().reverse()})),Object(r.a)(i,t,Object(a.a)(Object(a.a)({},s[t]),{},{children:s[t].children.slice().reverse()})),i))))}},he=function(e,t){return function(n,r){var c=r().param.stn_list[e];n(Q(e,Object(a.a)(Object(a.a)({},c),{},{facility:t})))}},fe=function(e,t){return function(n,r){var c=r().param.stn_list[e];c.services.includes(t)||n(Q(e,Object(a.a)(Object(a.a)({},c),{},{services:c.services.concat(t)})))}},je=function(e,t){return function(n,r){var c=r().param.stn_list[e];c.services.includes(t)&&n(Q(e,Object(a.a)(Object(a.a)({},c),{},{services:c.services.filter((function(e){return e!==t}))})))}}},function(e,t,n){"use strict";n.d(t,"e",(function(){return s})),n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return u})),n.d(t,"c",(function(){return l})),n.d(t,"d",(function(){return d})),n.d(t,"i",(function(){return b})),n.d(t,"g",(function(){return h})),n.d(t,"j",(function(){return j})),n.d(t,"k",(function(){return O})),n.d(t,"h",(function(){return g})),n.d(t,"f",(function(){return m}));var r=n(6),a=n.n(r),c=n(9),i=n(3),s="SET_RMG_STYLE",o="SET_CANVAS_SCALE",u="SET_CANVAS_SCALE_STATUS",l="SET_CANVAS_TO_SHOW",d="SET_CANVAS_TO_SHOW_STATUS",b=function(e){return{type:s,rmgStyle:e}},h=function(e){return{type:o,canvasScale:e}},f=function(e){return{type:u,canvasScaleStatus:e}},j=function(){return function(){var e=Object(c.a)(a.a.mark((function e(t,n){var r;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t(f(i.g.loading)),e.prev=1,r=Number((n().app.canvasScale+.1).toFixed(1)),t(h(r)),e.next=6,window.rmgStorage.writeFile("rmgScale",r.toString());case 6:t(f(i.g.loaded)),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(1),t(f(i.g.failed));case 12:case"end":return e.stop()}}),e,null,[[1,9]])})));return function(t,n){return e.apply(this,arguments)}}()},O=function(){return function(){var e=Object(c.a)(a.a.mark((function e(t,n){var r,c;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t(f(i.g.loading)),e.prev=1,r=n().app.canvasScale,c=Number(r.toFixed(1))<=.1?Number(r.toFixed(1)):Number((r-.1).toFixed(1)),t(h(c)),e.next=7,window.rmgStorage.writeFile("rmgScale",c.toString());case 7:t(f(i.g.loaded)),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(1),t(f(i.g.failed));case 13:case"end":return e.stop()}}),e,null,[[1,10]])})));return function(t,n){return e.apply(this,arguments)}}()},g=function(e){return{type:l,canvasToShow:e}},p=function(e){return{type:d,canvasToShowStatus:e}},m=function(e){return function(){var t=Object(c.a)(a.a.mark((function t(n){return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n(p(i.g.loading)),t.prev=1,n(g(e)),t.next=5,window.rmgStorage.writeFile("rmgCanvas",e);case 5:n(p(i.g.loaded)),t.next=11;break;case 8:t.prev=8,t.t0=t.catch(1),n(p(i.g.failed));case 11:case"end":return t.stop()}}),t,null,[[1,8]])})));return function(e){return t.apply(this,arguments)}}()}},,,function(e,t){e.exports=ReactRedux},function(e,t){e.exports=ReactI18next},,,function(e,t){e.exports=ReactRouterDOM},,,function(e,t,n){"use strict";n.d(t,"c",(function(){return i})),n.d(t,"a",(function(){return s})),n.d(t,"b",(function(){return o})),n.d(t,"d",(function(){return u}));var r=n(10),a=n(4),c=n.n(a),i=function e(t,n){if(["linestart","lineend"].includes(t)||n[t].parents.length>1||n[t].children.length>1)return 0;var r=n[t].parents[0];return r?1===n[r].children.length?e(r,n):0===n[r].children.indexOf(t)?1:-1:0},s=function(e){console.log("computing branches");for(var t=["linestart"],n=[["linestart"]],r=0;t.length;){var a=t.shift(),c=n[r].slice().reverse()[0]||null;for(c&&"linestart"!==a?n[r].push(a):n[r]=[a];"lineend"!==a;){var i=e[c=a].children;if(function(){switch(i.length){case 1:a=i[0];break;case 2:var s=e[c].branch.right[1];"through"===e[c].branch.right[0]?(n.push([a]),t.push(s)):0===r&&(n.push([c]),t.push(s)),a=i.filter((function(e){return e!==s}))[0]}}(),n[r].push(a),c===e[a].branch.left[1])break}r++}return n},o=function(e){console.log("computing routes");for(var t=["linestart"],n=[["linestart"]],r=0;t.length;){var a=t.shift(),c=n[r].slice().reverse()[0]||null;for(c&&"linestart"!==a?n[r].push(a):n[r]=[a];"lineend"!==a;){var i=e[c=a].children;if(function(){switch(i.length){case 1:a=i[0];break;case 2:var s=e[c].branch.right[1];"through"===e[c].branch.right[0]?(n.push(n[r].slice()),t.push(s)):0===r&&(n.push([c]),t.push(s)),a=i.filter((function(e){return e!==s}))[0]}}(),n[r].push(a),c===e[a].branch.left[1]&&"nonthrough"===e[a].branch.left[0])break}r++}return n},u=function(e){var t=c.a.useState([]),n=Object(r.a)(t,2),a=n[0],i=n[1];return c.a.useEffect((function(){if(console.log("computing tpo"),1!==e.length){var t=e.reduce((function(e,t){var n=e.indexOf(t.slice(-1)[0]);return e.slice(0,n).concat(t.slice(1),e.slice(n+1))}),["lineend"]).slice(0,-1);i(t)}else i(e[0].slice(1,-1))}),[e.toString()]),a}},,function(e,t){e.exports=Redux},function(e,t,n){"use strict";n.d(t,"a",(function(){return s})),n.d(t,"b",(function(){return o}));var r=n(2),a=n(0),c=n(4),i=n(3),s=Object(c.createContext)({}),o=function(e,t){var n,c,s,o,u,l;switch(t.type){case"GLOBAL":return t.data;case"ANY":return Object(a.a)(Object(a.a)({},e),{},Object(r.a)({},t.key,t.data));case"SET_HEIGHT":return Object(a.a)(Object(a.a)({},e),{},{svg_height:t.value});case"SET_WIDTH":return Object(a.a)(Object(a.a)({},e),{},{svgWidth:Object(a.a)(Object(a.a)({},e.svgWidth),{},Object(r.a)({},t.targetId,t.value))});case"SET_Y":return Object(a.a)(Object(a.a)({},e),{},{y_pc:t.value});case"SET_BRANCH_SPACING":return Object(a.a)(Object(a.a)({},e),{},{branch_spacing:t.value});case"SET_PADDING":return Object(a.a)(Object(a.a)({},e),{},{padding:t.value});case"SET_DIRECTION_GZ_X":return Object(a.a)(Object(a.a)({},e),{},{direction_gz_x:t.value});case"SET_DIRECTION_GZ_Y":return Object(a.a)(Object(a.a)({},e),{},{direction_gz_y:t.value});case"SET_LINE_NAME":return Object(a.a)(Object(a.a)({},e),{},{line_name:t.name});case"SET_THEME":return Object(a.a)(Object(a.a)({},e),{},{theme:t.theme});case"SET_DIRECTION":return Object(a.a)(Object(a.a)({},e),{},{direction:e.direction===i.m.left?i.m.right:i.m.left});case"SET_PLATFORM":return Object(a.a)(Object(a.a)({},e),{},{platform_num:t.platform});case"SET_TEXT_STAGGER":return Object(a.a)(Object(a.a)({},e),{},{namePosMTR:Object(a.a)(Object(a.a)({},e.namePosMTR),{},{isStagger:t.checked})});case"SET_TEXT_FLIP":return Object(a.a)(Object(a.a)({},e),{},{namePosMTR:Object(a.a)(Object(a.a)({},e.namePosMTR),{},{isFlip:!e.namePosMTR.isFlip})});case"SET_DEST_LEGACY":return Object(a.a)(Object(a.a)({},e),{},{customiseMTRDest:Object(a.a)(Object(a.a)({},e.customiseMTRDest),{},{isLegacy:t.isLegacy})});case"SET_TERMINAL_OVERRIDE":return Object(a.a)(Object(a.a)({},e),{},{customiseMTRDest:Object(a.a)(Object(a.a)({},e.customiseMTRDest),{},{terminal:t.terminal})});case"SET_LINE_NUM":return Object(a.a)(Object(a.a)({},e),{},{line_num:t.num});case"SET_PSD_NUM":return Object(a.a)(Object(a.a)({},e),{},{psd_num:t.num});case"SET_PANEL_TYPE":return Object(a.a)(Object(a.a)({},e),{},{info_panel_type:t.variant});case"ADD_NOTE_GZMTR":return Object(a.a)(Object(a.a)({},e),{},{notesGZMTR:null===(n=e.notesGZMTR)||void 0===n?void 0:n.concat([["","",0,0,!1]])});case"REMOVE_NOTE_GZMTR":return Object(a.a)(Object(a.a)({},e),{},{notesGZMTR:null===(c=e.notesGZMTR)||void 0===c?void 0:c.filter((function(e,n){return n!==t.idx}))});case"UPDATE_NOTE_GZMTR":return Object(a.a)(Object(a.a)({},e),{},{notesGZMTR:null===(s=e.notesGZMTR)||void 0===s?void 0:s.map((function(e,n){return n===t.idx?t.note:e}))});case"SET_CURRENT_STATION":return Object(a.a)(Object(a.a)({},e),{},{current_stn_idx:t.stnId});case"REVERSE_STATIONS":return Object(a.a)(Object(a.a)({},e),{},{stn_list:Object.keys(e.stn_list).reduce((function(t,n){return Object(a.a)(Object(a.a)({},t),{},Object(r.a)({},n,function(t){switch(t){case"linestart":return Object(a.a)(Object(a.a)({},e.stn_list.lineend),{},{parents:[],children:e.stn_list.lineend.parents.slice().reverse(),branch:{left:[],right:e.stn_list.lineend.branch.left}});case"lineend":return Object(a.a)(Object(a.a)({},e.stn_list.linestart),{},{parents:e.stn_list.linestart.children.slice().reverse(),children:[],branch:{left:e.stn_list.linestart.branch.right,right:[]}});default:return Object(a.a)(Object(a.a)({},e.stn_list[t]),{},{parents:e.stn_list[t].children.map((function(e){return"linestart"===e?"lineend":"lineend"===e?"linestart":e})).reverse(),children:e.stn_list[t].parents.map((function(e){return"linestart"===e?"lineend":"lineend"===e?"linestart":e})).reverse(),branch:{left:e.stn_list[t].branch.right,right:e.stn_list[t].branch.left}})}}(n)))}),{})});case"UPDATE_STATION_NAME":return Object(a.a)(Object(a.a)({},e),{},{stn_list:Object(a.a)(Object(a.a)({},e.stn_list),{},Object(r.a)({},t.stnId,Object(a.a)(Object(a.a)({},e.stn_list[t.stnId]),{},{name:t.name})))});case"UPDATE_STATION_SECONDARY_NAME":return Object(a.a)(Object(a.a)({},e),{},{stn_list:Object(a.a)(Object(a.a)({},e.stn_list),{},Object(r.a)({},t.stnId,Object(a.a)(Object(a.a)({},e.stn_list[t.stnId]),{},{secondaryName:t.name})))});case"UPDATE_STATION_NUM":return Object(a.a)(Object(a.a)({},e),{},{stn_list:Object(a.a)(Object(a.a)({},e.stn_list),{},Object(r.a)({},t.stnId,Object(a.a)(Object(a.a)({},e.stn_list[t.stnId]),{},{num:t.num})))});case"ADD_STATION_INTERCHANGE_INFO":return Object(a.a)(Object(a.a)({},e),{},{stn_list:Object(a.a)(Object(a.a)({},e.stn_list),{},Object(r.a)({},t.stnId,Object(a.a)(Object(a.a)({},e.stn_list[t.stnId]),{},{transfer:Object(a.a)(Object(a.a)({},e.stn_list[t.stnId].transfer),{},{info:function(n){var r=n.setIdx,a=n.info,c=e.stn_list[t.stnId].transfer.info.slice();return c[r]=(c[r]||[]).concat([a]),c}(t)})})))});case"REMOVE_STATION_INTERCHANGE_INFO":return Object(a.a)(Object(a.a)({},e),{},{stn_list:Object(a.a)(Object(a.a)({},e.stn_list),{},Object(r.a)({},t.stnId,Object(a.a)(Object(a.a)({},e.stn_list[t.stnId]),{},{transfer:Object(a.a)(Object(a.a)({},e.stn_list[t.stnId].transfer),{},{info:e.stn_list[t.stnId].transfer.info.map((function(e,n){return n===t.setIdx?e.slice(0,t.intIdx).concat(e.slice(t.intIdx+1)):e}))})})))});case"UPDATE_STATION_INTERCHANGE_INFO":return Object(a.a)(Object(a.a)({},e),{},{stn_list:Object(a.a)(Object(a.a)({},e.stn_list),{},Object(r.a)({},t.stnId,Object(a.a)(Object(a.a)({},e.stn_list[t.stnId]),{},{transfer:Object(a.a)(Object(a.a)({},e.stn_list[t.stnId].transfer),{},{info:null===(o=e.stn_list[t.stnId].transfer)||void 0===o?void 0:o.info.map((function(e,n){return n===t.setIdx?e.map((function(e,n){return n===t.intIdx?[0,1,2,3,4,5].map((function(n){return void 0===t.info[n]?e[n]:t.info[n]})):e})):e}))})})))});case"UPDATE_STATION_OSI_NAME":return Object(a.a)(Object(a.a)({},e),{},{stn_list:Object(a.a)(Object(a.a)({},e.stn_list),{},Object(r.a)({},t.stnId,Object(a.a)(Object(a.a)({},e.stn_list[t.stnId]),{},{transfer:Object(a.a)(Object(a.a)({},e.stn_list[t.stnId].transfer),{},{osi_names:[t.name]})})))});case"UPDATE_STATION_TICK_DIREC":return Object(a.a)(Object(a.a)({},e),{},{stn_list:Object(a.a)(Object(a.a)({},e.stn_list),{},Object(r.a)({},t.stnId,Object(a.a)(Object(a.a)({},e.stn_list[t.stnId]),{},{transfer:Object(a.a)(Object(a.a)({},e.stn_list[t.stnId].transfer),{},{tick_direc:t.direction})})))});case"UPDATE_STATION_PAID_AREA":return Object(a.a)(Object(a.a)({},e),{},{stn_list:Object(a.a)(Object(a.a)({},e.stn_list),{},Object(r.a)({},t.stnId,Object(a.a)(Object(a.a)({},e.stn_list[t.stnId]),{},{transfer:Object(a.a)(Object(a.a)({},e.stn_list[t.stnId].transfer),{},{paid_area:t.isPaid})})))});case"UPDATE_STATION_BRANCH_TYPE":return Object(a.a)(Object(a.a)({},e),{},{stn_list:Object(a.a)(Object(a.a)({},e.stn_list),{},Object(r.a)({},t.stnId,Object(a.a)(Object(a.a)({},e.stn_list[t.stnId]),{},{branch:Object(a.a)(Object(a.a)({},e.stn_list[t.stnId].branch),{},Object(r.a)({},t.direction,[t.branchType,e.stn_list[t.stnId].branch[t.direction][1]]))})))});case"UPDATE_STATION_BRANCH_FIRST":return Object(a.a)(Object(a.a)({},e),{},{stn_list:Object(a.a)(Object(a.a)({},e.stn_list),{},(u={},Object(r.a)(u,t.branches[0].stnId,Object(a.a)(Object(a.a)({},e.stn_list[t.branches[0].stnId]),{},{branch:Object(a.a)(Object(a.a)({},e.stn_list[t.branches[0].stnId].branch),{},Object(r.a)({},t.branches[0].direction,[e.stn_list[t.branches[0].stnId].branch[t.branches[0].direction][0],t.branches[0].first]))})),Object(r.a)(u,t.branches[1].stnId,Object(a.a)(Object(a.a)({},e.stn_list[t.branches[1].stnId]),{},{branch:Object(a.a)(Object(a.a)({},e.stn_list[t.branches[1].stnId].branch),{},Object(r.a)({},t.branches[1].direction,[e.stn_list[t.branches[1].stnId].branch[t.branches[1].direction][0],t.branches[1].first]))})),u))});case"UPDATE_STATION_BRANCH_POS":return Object(a.a)(Object(a.a)({},e),{},{stn_list:Object(a.a)(Object(a.a)({},e.stn_list),{},(l={},Object(r.a)(l,t.left,Object(a.a)(Object(a.a)({},e.stn_list[t.left]),{},{parents:e.stn_list[t.left].parents.slice().reverse()})),Object(r.a)(l,t.right,Object(a.a)(Object(a.a)({},e.stn_list[t.right]),{},{children:e.stn_list[t.right].children.slice().reverse()})),l))});case"UPDATE_STATION_FACILITY":return Object(a.a)(Object(a.a)({},e),{},{stn_list:Object(a.a)(Object(a.a)({},e.stn_list),{},Object(r.a)({},t.stnId,Object(a.a)(Object(a.a)({},e.stn_list[t.stnId]),{},{facility:t.facility})))});case"UPDATE_STATION_SERVICES":return Object(a.a)(Object(a.a)({},e),{},{stn_list:Object(a.a)(Object(a.a)({},e.stn_list),{},Object(r.a)({},t.stnId,Object(a.a)(Object(a.a)({},e.stn_list[t.stnId]),{},{services:Array.from(t.isChecked?new Set(e.stn_list[t.stnId].services).add(t.serviceId):e.stn_list[t.stnId].services.filter((function(e){return e!==t.serviceId})))})))});case"UPDATE_STATION_LIST":return Object(a.a)(Object(a.a)({},e),{},{stn_list:t.stnList});default:return e}}},function(e,t,n){"use strict";n.d(t,"c",(function(){return i})),n.d(t,"b",(function(){return s})),n.d(t,"a",(function(){return o}));var r=n(24),a=n(10),c=n(3),i=function(e){var t;"line_name"in e||(e.line_name=["\u8def\u7dda\u540d","Name of Line"]),"dest_legacy"in e||(e.dest_legacy=!1),delete e.fontZH,delete e.fontEN,delete e.weightZH,delete e.weightEN;for(var n=0,r=Object.entries(e.stn_list);n<r.length;n++){var c=Object(a.a)(r[n],2),i=c[0],s=c[1];"branch"in s||(e.stn_list[i].branch={left:[],right:[]},2===s.children.length?e.stn_list[i].branch.right=["through",s.children[1]]:e.stn_list[i].branch.right=[],2===s.parents.length?e.stn_list[i].branch.left=["through",s.parents[1]]:e.stn_list[i].branch.left=[])}e.psd_num="psd_num"in e?e.psd_num.toString():"1","line_num"in e||(e.line_num="1"),delete e.style,3===e.theme.length&&e.theme.push("#fff");for(var o=0,u=Object.entries(e.stn_list);o<u.length;o++){var l=Object(a.a)(u[o],2),d=l[0],b=l[1];"num"in b||(e.stn_list[d].num="00"),"interchange"in b&&b.interchange.map((function(e){return e.forEach((function(e){5===e.length&&e.splice(3,0,"#fff")}))}))}for(var h=0,f=Object.entries(e.stn_list);h<f.length;h++){var j=Object(a.a)(f[h],2),O=j[0],g=j[1];"osi22_end_p"===g.change_type&&(e.stn_list[O].change_type="osi22_pr"),"osi22_end_u"===g.change_type&&(e.stn_list[O].change_type="osi22_ur")}for(var p=0,m=Object.entries(e.stn_list);p<m.length;p++){var _=Object(a.a)(m[p],2),v=_[0];"interchange"in _[1]||(e.stn_list[v].interchange=[[]])}e.info_panel_type="info_panel_type"in e?function(e){switch(e){case"gz_1":case"panasonic":return"gz28";case"gz_2":return"gz6";case"gz_3":return"gz3";default:return e}}(e.info_panel_type):"gz28","direction_gz_x"in e||(e.direction_gz_x=50),"direction_gz_y"in e||(e.direction_gz_y=70);for(var T=0,y=Object.entries(e.stn_list);T<y.length;T++){var S,w,x,I,E=Object(a.a)(y[T],2),N=E[0],k=E[1];if(!("transfer"in k))e.stn_list[N].transfer={tick_direc:"none"===k.change_type||"int2"===k.change_type?"r":null===(S=k.change_type)||void 0===S?void 0:S.split("_")[1].split("").slice().reverse()[0],paid_area:-1===(null===(w=k.change_type)||void 0===w?void 0:w.indexOf("osi"))||"p"===(null===(x=k.change_type)||void 0===x?void 0:x.split("_")[1][0]),osi_names:-1!==(null===(I=k.change_type)||void 0===I?void 0:I.indexOf("osi"))?[k.interchange[1][0]]:[],info:2===k.interchange.length?[k.interchange[0],k.interchange[1].slice(1)]:k.interchange};delete e.stn_list[N].change_type,delete e.stn_list[N].interchange}for(var z=0,R=Object.entries(e.stn_list);z<R.length;z++){var M=Object(a.a)(R[z],2),A=M[0],C=M[1];"services"in C||(e.stn_list[A].services=["local"]),"facility"in C||(e.stn_list[A].facility="usage"in C?C.usage:""),delete e.stn_list[A].usage}return"customiseMTRDest"in e||(e.customiseMTRDest={isLegacy:e.dest_legacy||!1,terminal:!1}),delete e.dest_legacy,"svgWidth"in e||(e.svgWidth={destination:e.svg_dest_width,runin:e.svg_dest_width,railmap:e.svg_width,indoor:e.svg_width}),"indoor"in e.svgWidth||(e.svgWidth.indoor=e.svgWidth.railmap),delete e.svg_width,delete e.svg_dest_width,"notesGZMTR"in e||(e.notesGZMTR=[]),e.notesGZMTR=null===(t=e.notesGZMTR)||void 0===t?void 0:t.map((function(e){return 4===e.length?e.concat([!1]):e})),delete e.char_form,delete e.show_outer,delete e.strip_pc,delete e.txt_bg_gap,"namePosMTR"in e||(e.namePosMTR={isStagger:!0,isFlip:e.txt_flip}),delete e.txt_flip,Object.keys(e.stn_list).forEach((function(t){"secondaryName"in e.stn_list[t]?!1!==e.stn_list[t].secondaryName&&","===e.stn_list[t].secondaryName.join()&&(e.stn_list[t].secondaryName=!1):e.stn_list[t].secondaryName=!1,"type"in e.stn_list[t].transfer&&delete e.stn_list[t].transfer.type})),e},s=function(e,t){var n,a=Object(r.a)(t);try{for(a.s();!(n=a.n()).done;){var i=n.value;if(e[i])return e[i]}}catch(s){a.e(s)}finally{a.f()}return e[c.f.English]},o=function(e,t){return(t===c.k.GZMTR?((null===e||void 0===e?void 0:e.num)||"-")+": ":"")+(null===e||void 0===e?void 0:e.name.join().replace("\\"," "))}},function(e,t){e.exports=i18next},,function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a})),function(e){e.Barcelona="barcelona",e.Beijing="beijing",e.Changsha="changsha",e.Chengdu="chengdu",e.Chongqing="chongqing",e.Dongguan="dongguan",e.Edinburgh="edinburgh",e.Foshan="foshan",e.Glasgow="glasgow",e.Guangzhou="guangzhou",e.Hangzhou="hangzhou",e.HongKong="hongkong",e.Kansai="kansai",e.Kaohsiung="kaohsiung",e.London="london",e.Macao="macao",e.Madrid="madrid",e.Nanjing="nanjing",e.NewTaipei="newtaipei",e.Osaka="osaka",e.Oslo="oslo",e.Paris="paris",e.Qingdao="qingdao",e.SanFrancisco="sanfrancisco",e.Seoul="seoul",e.Shanghai="shanghai",e.Shenzhen="shenzhen",e.Singapore="singapore",e.Stockholm="stockholm",e.Taipei="taipei",e.Tianjin="tianjin",e.Tokyo="tokyo",e.Toronto="toronto",e.TyneAndWear="tyneandwear",e.Xian="xian",e.Other="other"}(r||(r={}));var a=[{id:r.Barcelona,country:"ES",name:{en:"Barcelona","zh-Hans":"\u5df4\u585e\u7f57\u90a3","zh-HK":"\u5df4\u585e\u9686\u62ff","zh-TW":"\u5df4\u585e\u9686\u7d0d"}},{id:r.Beijing,country:"CN",name:{en:"Beijing",zh:"\u5317\u4eac"}},{id:r.Changsha,country:"CN",name:{en:"Changsha","zh-Hans":"\u957f\u6c99","zh-Hant":"\u9577\u6c99"}},{id:r.Chengdu,country:"CN",name:{en:"Chengdu",zh:"\u6210\u90fd"}},{id:r.Chongqing,country:"CN",name:{en:"Chongqing","zh-Hans":"\u91cd\u5e86","zh-Hant":"\u91cd\u6176"}},{id:r.Dongguan,country:"CN",name:{en:"Dongguan","zh-Hans":"\u4e1c\u839e","zh-Hant":"\u6771\u839e"}},{id:r.Edinburgh,country:"GBSCT",name:{en:"Edinburgh",ga:"D\xf9n \xc8ideann","zh-Hans":"\u7231\u4e01\u5821","zh-Hant":"\u611b\u4e01\u5821"}},{id:r.Foshan,country:"CN",name:{en:"Foshan",zh:"\u4f5b\u5c71"}},{id:r.Glasgow,country:"GBSCT",name:{en:"Glasgow",ga:"Glaschu",zh:"\u683c\u62c9\u65af\u54e5"}},{id:r.Guangzhou,country:"CN",name:{en:"Guangzhou","zh-Hans":"\u5e7f\u5dde","zh-Hant":"\u5ee3\u5dde"}},{id:r.Hangzhou,country:"CN",name:{en:"Hangzhou",zh:"\u676d\u5dde"}},{id:r.HongKong,country:"HK",name:{en:"Hong Kong",zh:"\u9999\u6e2f"}},{id:r.Kansai,country:"JP",name:{en:"Kansai Area",ja:"\u8fd1\u757f\u5730\u65b9","zh-Hans":"\u8fd1\u757f\u5730\u65b9\uff08\u5173\u897f\u5730\u65b9\uff09","zh-Hant":"\u8fd1\u757f\u5730\u65b9\uff08\u95dc\u897f\u5730\u65b9\uff09"}},{id:r.Kaohsiung,country:"TW",name:{en:"Kaohsiung",zh:"\u9ad8\u96c4"}},{id:r.London,country:"GBENG",name:{en:"London","zh-Hans":"\u4f26\u6566","zh-Hant":"\u502b\u6566"}},{id:r.Macao,country:"MO",name:{en:"Macao",pt:"Macau","zh-Hans":"\u6fb3\u95e8","zh-Hant":"\u6fb3\u9580"}},{id:r.Madrid,country:"ES",name:{en:"Madrid","zh-Hans":"\u9a6c\u5fb7\u91cc","zh-Hant":"\u99ac\u5fb7\u91cc"}},{id:r.Nanjing,country:"CN",name:{en:"Nanjing",zh:"\u5357\u4eac"}},{id:r.NewTaipei,country:"TW",name:{en:"New Taipei",zh:"\u65b0\u5317"}},{id:r.Osaka,country:"JP",name:{en:"Osaka",ja:"\u5927\u962a",zh:"\u5927\u962a"}},{id:r.Oslo,country:"NO",name:{en:"Oslo","zh-Hans":"\u5965\u65af\u9646","zh-Hant":"\u5967\u65af\u9678"}},{id:r.Paris,country:"FR",name:{en:"Paris",zh:"\u5df4\u9ece"}},{id:r.Qingdao,country:"CN",name:{en:"Qingdao","zh-Hans":"\u9752\u5c9b","zh-Hant":"\u9752\u5cf6"}},{id:r.SanFrancisco,country:"US",name:{en:"San Francisco","zh-Hans":"\u65e7\u91d1\u5c71","zh-HK":"\u4e09\u85e9\u5e02","zh-TW":"\u820a\u91d1\u5c71"}},{id:r.Seoul,country:"KR",name:{en:"Seoul (Metropolitan Area)",ko:"\uc11c\uc6b8(\uc218\ub3c4\uad8c)","zh-Hans":"\u9996\u5c14\uff08\u9996\u90fd\u5708\uff09","zh-Hant":"\u9996\u723e\uff08\u9996\u90fd\u5708\uff09"}},{id:r.Shanghai,country:"CN",name:{en:"Shanghai",zh:"\u4e0a\u6d77"}},{id:r.Shenzhen,country:"CN",name:{en:"Shenzhen",zh:"\u6df1\u5733"}},{id:r.Singapore,country:"SG",name:{en:"Singapore",zh:"\u65b0\u52a0\u5761"}},{id:r.Stockholm,country:"SE",name:{en:"Stockholm","zh-Hans":"\u65af\u5fb7\u54e5\u5c14\u6469","zh-Hant":"\u65af\u5fb7\u54e5\u723e\u6469"}},{id:r.Taipei,country:"TW",name:{en:"Taipei",zh:"\u53f0\u5317"}},{id:r.Tianjin,country:"CN",name:{en:"Tianjin",zh:"\u5929\u6d25"}},{id:r.Tokyo,country:"JP",name:{en:"Tokyo (Greater Tokyo Area)",ja:"\u6771\u4eac\uff08\u9996\u90fd\u570f\uff09","zh-Hans":"\u4e1c\u4eac\uff08\u9996\u90fd\u5708\uff09","zh-Hant":"\u6771\u4eac\uff08\u9996\u90fd\u5708\uff09"}},{id:r.Toronto,country:"CA",name:{en:"Toronto","zh-Hans":"\u591a\u4f26\u591a","zh-Hant":"\u591a\u502b\u591a"}},{id:r.TyneAndWear,country:"GBENG",name:{en:"Tyne and Wear","zh-Hans":"\u6cf0\u6069-\u5a01\u5c14","zh-HK":"\u6cf0\u5a01","zh-TW":"\u6cf0\u6069-\u5a01\u723e"}},{id:r.Xian,country:"CN",name:{en:"Xi'an",zh:"\u897f\u5b89"}},{id:r.Other,country:"UN",name:{en:"Customise","zh-Hans":"\u81ea\u5b9a\u4e49","zh-Hant":"\u81ea\u8a02"}}]},,,function(e,t){e.exports=ReactDOM},function(e,t){e.exports=i18nextXHRBackend},function(e,t){e.exports=i18nextBrowserLanguageDetector},function(e,t){e.exports=ReduxThunk},,function(e,t,n){},,function(e,t,n){"use strict";n.r(t);var r=n(6),a=n.n(r),c=n(9),i=n(13),s=n(4),o=n.n(s),u=n(28),l=(n(33),n(23)),d=n.n(l),b=n(12),h=n(29),f=n.n(h),j=n(30),O=n.n(j);d.a.use(f.a).use(O.a).use(b.initReactI18next).init({fallbackLng:{"zh-CN":["zh-Hans","en"],"zh-Hant":["zh-HK","en"],"zh-HK":["zh-Hant","en"],"zh-TW":["zh-HK","zh-Hant"],default:["en"]},backend:{loadPath:"/RailMapGenerator/locale/{{lng}}.json"},interpolation:{escapeValue:!1}}).then((function(e){document.title=e("title"),document.documentElement.setAttribute("lang",d.a.language)}));var g,p,m,_,v=n(10),T=n(15),y=n(5),S=n(3),w=n(11),x=n(8),I=n(1),E=Object(y.makeStyles)((function(e){return Object(y.createStyles)({rootLight:{backgroundColor:e.palette.primary.main},rootDark:{backgroundColor:e.palette.background.paper},title:{flexGrow:1,color:"#fff"},menuButton:{color:"#fff"}})})),N=function(){var e=Object(b.useTranslation)(),t=e.t,n=e.i18n,r=E(),a=Object(y.useMediaQuery)("(prefers-color-scheme: dark)");return s.useMemo((function(){return Object(I.jsx)(y.AppBar,{position:"sticky",className:a?r.rootDark:r.rootLight,children:Object(I.jsxs)(y.Toolbar,{variant:"dense",children:[Object(I.jsx)(y.Typography,{variant:"h6",className:r.title,color:"textPrimary",children:"/RailMapGenerator".includes("uat")?t("titleUAT"):t("title")}),Object(I.jsx)(k,{}),Object(I.jsx)(z,{})]})})}),[a,n.language])},k=function(){var e=Object(b.useTranslation)().t,t=E(),n=Object(w.useDispatch)(),r=Object(w.useSelector)((function(e){return e.app.rmgStyle})),a=s.useState(null),c=Object(v.a)(a,2),i=c[0],o=c[1],u=function(e){return function(){n(Object(x.f)(e)),o(null)}};return s.useMemo((function(){return Object(I.jsxs)(I.Fragment,{children:[Object(I.jsx)(y.Tooltip,{title:e("toggle.tooltip"),children:Object(I.jsx)(y.IconButton,{onClick:function(e){return o(e.currentTarget)},className:t.menuButton,children:Object(I.jsx)(y.Icon,{children:"photo_library"})})}),Object(I.jsxs)(y.Menu,{anchorEl:i,open:Boolean(i),onClose:function(){return o(null)},children:[S.n[r].map((function(t){return Object(I.jsx)(y.MenuItem,{onClick:u(t),children:e("toggle."+t)},t)})),Object(I.jsx)(y.Divider,{style:{margin:"6px 0"}}),Object(I.jsx)(y.MenuItem,{onClick:u(S.a),children:e("toggle.all")})]})]})}),[r,i,t.menuButton])},z=function(){var e=Object(b.useTranslation)().t,t=E(),n=Object(w.useDispatch)();return s.useMemo((function(){return Object(I.jsxs)(I.Fragment,{children:[Object(I.jsx)(y.Tooltip,{title:e("zoom.out"),children:Object(I.jsx)(y.IconButton,{onClick:function(){return n(Object(x.k)())},className:t.menuButton,children:Object(I.jsx)(y.Icon,{children:"zoom_out"})})}),Object(I.jsx)(y.Tooltip,{title:e("zoom.in"),children:Object(I.jsx)(y.IconButton,{onClick:function(){return n(Object(x.j)())},className:t.menuButton,children:Object(I.jsx)(y.Icon,{children:"zoom_in"})})})]})}),[t.menuButton])},R=n(0),M=n(2),A=n(17),C=n(19),D=n(27),H=n(26),P=function(e){Object(D.a)(n,e);var t=Object(H.a)(n);function n(e){var r;return Object(A.a)(this,n),(r=t.call(this,e)).state={hasError:!1},r}return Object(C.a)(n,[{key:"componentDidCatch",value:function(e,t){}},{key:"render",value:function(){return this.state.hasError?Object(I.jsx)("h1",{children:"Something went wrong."}):this.props.children}}],[{key:"getDerivedStateFromError",value:function(e){return{hasError:!0}}}]),n}(o.a.Component),G=Object(y.makeStyles)((function(){return Object(y.createStyles)({root:{display:"flex",flexDirection:"row",overflowX:"scroll","&::before, &::after":{content:'""',margin:"auto"},"& > svg":{flex:"0 0 auto",border:"1px solid black"}}})})),F=function(){var e=G(),t=Object(w.useSelector)((function(e){return e.app.canvasScale})),n=Object(w.useSelector)((function(e){return e.param.svg_height})),r=Object(w.useSelector)((function(e){return e.param.svgWidth})),a=Object(w.useSelector)((function(e){return e.param.theme})),c=o.a.useCallback((function(e){var c;return{id:e,xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",height:n*t,viewBox:"0 0 ".concat(r[e]," ").concat(n),colorInterpolationFilters:"sRGB",style:(c={},Object(M.a)(c,"--rmg-svg-width",r[e]+"px"),Object(M.a)(c,"--rmg-svg-height",n+"px"),Object(M.a)(c,"--rmg-theme-colour",a[2]),Object(M.a)(c,"--rmg-theme-fg",a[3]),c)}}),[n,JSON.stringify(r),a,t]);return Object(I.jsx)("div",{className:e.root,children:Object(I.jsxs)(T.Switch,{children:[Object.values(S.k).map((function(e){return Object(I.jsx)(T.Route,{path:"/".concat(e),children:Object(I.jsx)(B,{style:e,canvasAvailable:X[e],svgProps:c})},e)})),Object(I.jsx)(T.Redirect,{to:"/"+S.k.MTR})]})})},B=Object(s.memo)((function(e){var t=Object(w.useDispatch)(),n=Object(w.useSelector)((function(e){return e.app.canvasToShow}));return t(Object(x.i)(e.style)),Object(s.useEffect)((function(){["share"].concat(Object(i.a)(Object.values(S.c))).forEach((function(t){t in e.canvasAvailable||"share"===t?document.getElementById("css_"+t).href="/RailMapGenerator"+"/styles/".concat(t,"_").concat(e.style,".css"):document.getElementById("css_"+t).href=""})),![].concat(Object(i.a)(S.n[e.style]),[S.a]).includes(n)&&t(Object(x.f)(S.a))}),[]),Object(I.jsx)(I.Fragment,{children:Object.keys(e.canvasAvailable).map((function(t){return[S.a,t].includes(n)&&Object(I.jsx)(o.a.Suspense,{fallback:Object(I.jsx)(y.CircularProgress,{}),children:Object(I.jsx)(P,{children:Object(I.jsxs)("svg",Object(R.a)(Object(R.a)({},e.svgProps(t)),{},{children:[Object(I.jsx)("rect",{id:"canvas-bg",fill:"white",style:{height:"var(--rmg-svg-height)",width:"var(--rmg-svg-width)"}}),e.canvasAvailable[t],Object(I.jsx)("rect",{id:"canvas-border",fill:"none",strokeWidth:3,stroke:"none",style:{height:"var(--rmg-svg-height)",width:"var(--rmg-svg-width)"}})]}))})},t)}))})})),L=Object(s.lazy)((function(){return n.e(98).then(n.bind(null,143))})),W=Object(s.lazy)((function(){return n.e(95).then(n.bind(null,137))})),U=Object(s.lazy)((function(){return n.e(76).then(n.bind(null,123))})),Z=Object(s.lazy)((function(){return n.e(96).then(n.bind(null,138))})),K=Object(s.lazy)((function(){return n.e(77).then(n.bind(null,124))})),J=Object(s.lazy)((function(){return n.e(99).then(n.bind(null,125))})),Y=Object(s.lazy)((function(){return n.e(97).then(n.bind(null,139))})),V=Object(s.lazy)((function(){return n.e(78).then(n.bind(null,144))})),X=(_={},Object(M.a)(_,S.k.GZMTR,(g={},Object(M.a)(g,S.c.RunIn,Object(I.jsx)(L,{})),Object(M.a)(g,S.c.RailMap,Object(I.jsx)(W,{})),g)),Object(M.a)(_,S.k.MTR,(p={},Object(M.a)(p,S.c.Destination,Object(I.jsx)(U,{})),Object(M.a)(p,S.c.RailMap,Object(I.jsx)(Z,{})),p)),Object(M.a)(_,S.k.SHMetro,(m={},Object(M.a)(m,S.c.Destination,Object(I.jsx)(K,{})),Object(M.a)(m,S.c.RunIn,Object(I.jsx)(J,{})),Object(M.a)(m,S.c.RailMap,Object(I.jsx)(Y,{})),Object(M.a)(m,S.c.Indoor,Object(I.jsx)(V,{})),m)),_),q=F,Q=s.lazy((function(){return n.e(88).then(n.bind(null,136))})),$=s.lazy((function(){return n.e(85).then(n.bind(null,140))})),ee=s.lazy((function(){return n.e(80).then(n.bind(null,141))})),te=s.lazy((function(){return n.e(90).then(n.bind(null,135))})),ne=s.lazy((function(){return n.e(84).then(n.bind(null,126))})),re=Object(y.makeStyles)((function(e){var t;return Object(y.createStyles)({root:Object(M.a)({display:"flex",flexDirection:"row",height:"100%"},e.breakpoints.down("xs"),{flexDirection:"column"}),typography:{background:e.palette.background.default},tab:(t={padding:"6px 24px",height:48,"& .MuiTab-wrapper":{flexDirection:"row"}},Object(M.a)(t,e.breakpoints.up("sm"),{"& .MuiTab-wrapper":{justifyContent:"flex-start"}}),Object(M.a)(t,e.breakpoints.down("xs"),{minWidth:"calc(100% / 5)"}),Object(M.a)(t,"&.MuiTab-labelIcon",{minHeight:"unset","& .MuiTab-wrapper":{"& > *:first-child":{marginBottom:0},"& > *:not(first-child)":{paddingLeft:8}}}),t),tabs:{overflow:"auto","&::-webkit-scrollbar":{width:0},scrollbarWidth:"none",WebkitOverflowScrolling:"touch"},tabpanel:{overflow:"auto",flex:1,padding:e.spacing(3),paddingBottom:0,height:"calc(100% - ".concat(e.spacing(3),"px)"),display:"flex",justifyContent:"center",alignItems:"flex-start"}})}));function ae(){var e=Object(b.useTranslation)(),t=e.t,n=e.i18n,r=re(),a=Object(y.useTheme)(),c=Object(y.useMediaQuery)(a.breakpoints.down("xs")),i=s.useState(0),o=Object(v.a)(i,2),u=o[0],l=o[1],d=s.useMemo((function(){return Object(I.jsx)(y.Typography,{className:"".concat(r.typography," ").concat(r.tabs),component:"div",children:Object(I.jsx)(y.Tabs,{value:u,orientation:c?"horizontal":"vertical",indicatorColor:"primary",textColor:"primary",onChange:function(e,t){return l(t)},variant:"scrollable",scrollButtons:"off",children:[["file","insert_drive_file"],["layout","panorama"],["design","brush"],["stations","directions_transit"],["info","info"]].map((function(e,n){return Object(I.jsx)(y.Tab,{label:Object(I.jsx)("span",{children:t("tab."+e[0])}),icon:Object(I.jsx)(y.Icon,{children:e[1]}),className:r.tab},n)}))})})}),[u,n.language,r.tab,c]);return Object(I.jsxs)("div",{className:r.root,children:[d,Object(I.jsx)(y.Typography,{className:"".concat(r.typography," ").concat(r.tabpanel),component:"div",role:"tabpanel",children:Object(I.jsx)(s.Suspense,{fallback:Object(I.jsx)(y.CircularProgress,{}),children:function(e){switch(e){case 0:return Object(I.jsx)(Q,{});case 1:return Object(I.jsx)($,{});case 2:return Object(I.jsx)(ee,{});case 3:return Object(I.jsx)(te,{});case 4:return Object(I.jsx)(ne,{});default:return Object(I.jsx)(Q,{})}}(u)})})]})}function ce(){return Object(I.jsx)(s.Suspense,{fallback:Object(I.jsx)(y.CircularProgress,{}),children:Object(I.jsx)(ae,{})})}var ie=n(18),se=n(21),oe=Object(y.createMuiTheme)({palette:{type:"dark",primary:{main:"#bb86fc"},secondary:{main:"#018786"},error:{main:"#cf6679"}},overrides:{MuiDialog:{paper:{minWidth:280}}}}),ue=Object(y.createMuiTheme)({palette:{primary:{light:"#bb86fc",main:"#6200ee"},secondary:{main:"#018786"},error:{main:"#b00020"}},overrides:{MuiDialog:{paper:{minWidth:280}}}});function le(){var e=Object(y.useMediaQuery)("(prefers-color-scheme: dark)")?oe:ue;return Object(I.jsx)(T.BrowserRouter,{basename:"/RailMapGenerator",children:Object(I.jsxs)(y.ThemeProvider,{theme:e,children:[Object(I.jsx)(o.a.Suspense,{fallback:Object(I.jsx)(y.LinearProgress,{}),children:Object(I.jsx)(N,{})}),Object(I.jsx)(de,{})]})})}var de=function(){var e=Object(s.useReducer)(se.b,JSON.parse(localStorage.rmgParam)),t=Object(v.a)(e,2),n=t[0],r=t[1],a=JSON.stringify(n);Object(s.useEffect)((function(){window.rmgStorage.writeFile("rmgParam",a).then()}),[a]);var c=Object.keys(n.stn_list).reduce((function(e,t){return e+t+function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(e){return t.reduce((function(t,n){return t+JSON.stringify(e[n])}),"")}}("parents","children","branch")(n.stn_list[t])}),""),i=Object(s.useMemo)((function(){return Object(ie.a)(n.stn_list)}),[c]),o=Object(s.useMemo)((function(){return Object(ie.b)(n.stn_list)}),[c]),u=Object(ie.d)(i);return Object(I.jsxs)(I.Fragment,{children:[Object(I.jsxs)(se.a.Provider,{value:{param:n,dispatch:r,branches:i,routes:o,deps:c,tpo:u},children:[Object(I.jsx)("div",{style:{overflowY:"auto"},children:Object(I.jsx)(q,{})}),Object(I.jsx)("div",{style:{flex:1,overflow:"hidden"},children:Object(I.jsx)(ce,{})})]}),Object(I.jsx)("canvas",{style:{display:"none"}})]})},be=n(22);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var he=function(){function e(){Object(A.a)(this,e),this.currentBusyFilename=void 0,this.currentBusyFilename=!1}return Object(C.a)(e,[{key:"init",value:function(){var e=Object(c.a)(a.a.mark((function e(){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(console.warn("Using localStorage, please update your browser"),window.localStorage){e.next=4;break}throw alert("Local storage is not available! Please upgrade to a newer browser!"),new Error("LocalStorage unavailable");case 4:e.prev=4,window.localStorage.setItem("storage_test","1"),window.localStorage.removeItem("storage_test"),e.next=13;break;case 9:throw e.prev=9,e.t0=e.catch(4),alert("Local storage is not accessible! Please modify your browser's settings or try with another browser!"),new Error("LocalStorage no write permission");case 13:case"end":return e.stop()}}),e,null,[[4,9]])})));return function(){return e.apply(this,arguments)}}()},{key:"writeFile",value:function(){var e=Object(c.a)(a.a.mark((function e(t,n){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.currentBusyFilename===t&&console.warn("Attempt to write",t,"while write process is not finished!"),this.currentBusyFilename=t,window.localStorage.setItem(t,n),this.currentBusyFilename=!1;case 4:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"readFile",value:function(){var e=Object(c.a)(a.a.mark((function e(t){var n;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.currentBusyFilename===t&&console.warn("Attempt to read",t,"while write process is not finished!"),n=window.localStorage.getItem(t)){e.next=4;break}throw new Error("FILE_NOT_FOUND");case 4:return e.abrupt("return",n);case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"deleteFile",value:function(){var e=Object(c.a)(a.a.mark((function e(t){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.currentBusyFilename===t&&console.warn("Attempt to delete",t,"while write process is not finished!"),this.currentBusyFilename=t,window.localStorage.removeItem(t),this.currentBusyFilename=!1;case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),e}();function fe(){return(fe=Object(c.a)(a.a.mark((function e(){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(window.indexedDB){e.next=3;break}return console.log("IndexedDB not supported"),e.abrupt("return",new he);case 3:return e.next=5,new Promise((function(e){try{var t=window.indexedDB.open("indexeddb_feature_detection",1);t.onerror=function(t){console.log("IndexedDB can NOT be accessed:",t),console.log("Fallback to LocalStorage"),e(new he)},t.onsuccess=function(){console.log("IndexedDB can be accessed"),e(new he)}}catch(n){console.warn("Error while opening IndexedDB:",n),e(new he)}}));case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var je=n(20),Oe=n(31),ge=n.n(Oe),pe={rmgStyle:S.k.MTR,canvasScale:1,canvasScaleStatus:S.g.init,canvasToShow:S.a,canvasToShowStatus:S.g.init};var me=n(25),_e=n(7),ve={svgWidth:{destination:100,runin:100,railmap:100,indoor:100},svg_height:100,y_pc:50,padding:10,branch_spacing:10,direction:S.m.left,platform_num:"1",theme:[me.a.HongKong,"twl","#E2231A",S.h.white],line_name:["\u7dda","line"],current_stn_idx:"",stn_list:{},namePosMTR:{isStagger:!0,isFlip:!0},customiseMTRDest:{isLegacy:!1,terminal:!1},line_num:"1",psd_num:"1",info_panel_type:S.i.gz1,notesGZMTR:[],direction_gz_x:0,direction_gz_y:0};var Te,ye=Object(je.combineReducers)({app:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:pe,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case x.e:e.rmgStyle=t.rmgStyle;break;case x.a:e.canvasScale=t.canvasScale;break;case x.b:e.canvasScaleStatus=t.canvasScaleStatus;break;case x.c:e.canvasToShow=t.canvasToShow;break;case x.d:e.canvasToShowStatus=t.canvasToShowStatus}return Object(R.a)({},e)},param:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ve,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case _e.g:return t.fullParam;case _e.r:e.svg_height=t.svgHeight;break;case _e.s:e.svgWidth[t.canvas]=t.svgWidth;break;case _e.u:e.y_pc=t.yPercentage;break;case _e.a:e.branch_spacing=t.branchSpacing;break;case _e.l:e.padding=t.paddingPercentage;break;case _e.e:e.direction_gz_x=t.directionIndicatorX;break;case _e.f:e.direction_gz_y=t.directionIndicatorY;break;case _e.t:e.theme=t.theme;break;case _e.h:e.line_name=t.lineName;break;case _e.d:e.direction=t.direction;break;case _e.n:e.platform_num=t.platform;break;case _e.i:e.line_num=t.lineNum;break;case _e.o:e.psd_num=t.psdNum;break;case _e.m:e.info_panel_type=t.panelType;break;case _e.k:e.notesGZMTR=t.notes;break;case _e.j:e.namePosMTR=t.namePosition;break;case _e.c:e.customiseMTRDest=t.customisedMtrDestination;break;case _e.b:e.current_stn_idx=t.currentStation;break;case _e.p:e.stn_list[t.stationId]=t.station;break;case _e.q:e.stn_list=t.stations}return Object(R.a)({},e)}}),Se=Object(je.createStore)(ye,Object(je.applyMiddleware)(ge.a));"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)})),(Te=document.head).append.apply(Te,Object(i.a)(["share"].concat(Object(i.a)(Object.values(S.c))).map((function(e){var t=document.createElement("link");return t.rel="stylesheet",t.id="css_"+e,t}))));(function(){return fe.apply(this,arguments)})().then(function(){var e=Object(c.a)(a.a.mark((function e(t){var r,c,i,s;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.init();case 2:return e.prev=2,e.next=5,t.readFile("rmgParam");case 5:return r=e.sent,c=Object(be.c)(JSON.parse(r)),e.next=9,t.writeFile("rmgParam",JSON.stringify(c));case 9:e.next=20;break;case 11:return e.prev=11,e.t0=e.catch(2),console.warn("Error in reading rmgParam",e.t0),e.next=16,n.e(0).then(n.bind(null,81));case 16:return i=e.sent,s=Object(be.c)(i.default),e.next=20,t.writeFile("rmgParam",JSON.stringify(s));case 20:return e.prev=20,window.rmgStorage=t,e.finish(20);case 23:case"end":return e.stop()}}),e,null,[[2,11,20,23]])})));return function(t){return e.apply(this,arguments)}}()).then(Object(c.a)(a.a.mark((function e(){var t;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,window.rmgStorage.readFile("rmgParam");case 2:t=e.sent,Se.dispatch(Object(_e.K)(JSON.parse(t)));case 4:case"end":return e.stop()}}),e)})))).then(Object(c.a)(a.a.mark((function e(){var t,n,r;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,window.rmgStorage.readFile("rmgScale");case 3:t=e.sent,(n=Number(t))>=.1&&Se.dispatch(Object(x.g)(n)),e.next=15;break;case 8:return e.prev=8,e.t0=e.catch(0),console.warn("Error in reading rmgScale file",e.t0),console.log("Initiating rmgScale as 1"),e.next=14,window.rmgStorage.writeFile("rmgScale","1");case 14:Se.dispatch(Object(x.g)(1));case 15:return e.prev=15,e.next=18,window.rmgStorage.readFile("rmgCanvas");case 18:r=e.sent,Se.dispatch(Object(x.h)(r)),e.next=29;break;case 22:return e.prev=22,e.t1=e.catch(15),console.warn("Error in reading rmgCanvas file",e.t1),console.log('Initiating rmgCanvas as "all"'),e.next=28,window.rmgStorage.writeFile("rmgCanvas",S.a);case 28:Se.dispatch(Object(x.h)(S.a));case 29:window.rmgStore=Se;case 30:case"end":return e.stop()}}),e,null,[[0,8],[15,22]])})))).then((function(){u.render(Object(I.jsx)(w.Provider,{store:Se,children:Object(I.jsx)(le,{})}),document.getElementById("root"))})).then((function(){setInterval(Object(c.a)(a.a.mark((function e(){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,window.rmgStorage.writeFile("rmgParamRedux",JSON.stringify(window.rmgStore.getState().param));case 2:console.log("Parameter auto saved!");case 3:case"end":return e.stop()}}),e)}))),6e4)}))}],[[35,100,101]]]);
//# sourceMappingURL=main.6b991afe.chunk.js.map