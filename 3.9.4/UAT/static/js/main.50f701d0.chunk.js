(this["webpackJsonprail-map-generator"]=this["webpackJsonprail-map-generator"]||[]).push([[72],[,,function(e,t,n){"use strict";n.d(t,"f",(function(){return r})),n.d(t,"j",(function(){return c})),n.d(t,"c",(function(){return i})),n.d(t,"a",(function(){return f})),n.d(t,"m",(function(){return p})),n.d(t,"l",(function(){return l})),n.d(t,"b",(function(){return u})),n.d(t,"g",(function(){return h})),n.d(t,"k",(function(){return d})),n.d(t,"d",(function(){return b})),n.d(t,"h",(function(){return j})),n.d(t,"i",(function(){return O})),n.d(t,"e",(function(){return g}));var a,r,c,i,s=n(3);!function(e){e.init="init",e.loading="loading",e.loaded="loaded",e.failed="failed"}(r||(r={})),function(e){e.MTR="mtr",e.GZMTR="gzmtr",e.SHMetro="shmetro"}(c||(c={})),function(e){e.Destination="destination",e.RunIn="runin",e.RailMap="railmap",e.Indoor="indoor"}(i||(i={}));var o,l,u,h,d,b,j,O,g,f="all",p=(a={},Object(s.a)(a,c.MTR,[i.Destination,i.RailMap]),Object(s.a)(a,c.GZMTR,[i.RunIn,i.RailMap]),Object(s.a)(a,c.SHMetro,[i.Destination,i.RunIn,i.RailMap,i.Indoor]),a);!function(e){e.left="left",e.right="right"}(o||(o={})),function(e){e.left="l",e.right="r"}(l||(l={})),function(e){e.through="through",e.nonThrough="nonthrough"}(u||(u={})),function(e){e.black="#000",e.white="#fff"}(h||(h={})),function(e){e.local="local",e.express="express",e.direct="direct"}(d||(d={})),function(e){e.airport="airport",e.disney="disney",e.hsr="hsr",e.none=""}(b||(b={})),function(e){e.gz1="gz1",e.gz28="gz28",e.gz2otis="gz2otis",e.gz3="gz3",e.gz4="gz4",e.gz5="gz5",e.gz1421="gz1421",e.gz6="gz6",e.gzgf="gzgf"}(j||(j={})),function(e){e.sh="sh",e.sh2020="sh2020"}(O||(O={})),function(e){e.Catalan="ca",e.English="en",e.Spanish="es",e.French="fr",e.Gaelic="ga",e.Japanese="ja",e.Korean="ko",e.Norwegian="no",e.Portuguese="pt",e.Swedish="sv",e.Chinese="zh",e.ChineseCN="zh-CN",e.ChineseSimp="zh-Hans",e.ChineseTrad="zh-Hant",e.ChineseHK="zh-HK",e.ChineseTW="zh-TW"}(g||(g={}))},,function(e,t){e.exports=React},function(e,t){e.exports=MaterialUI},,function(e,t,n){"use strict";n.d(t,"e",(function(){return s})),n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return l})),n.d(t,"c",(function(){return u})),n.d(t,"d",(function(){return h})),n.d(t,"i",(function(){return d})),n.d(t,"g",(function(){return b})),n.d(t,"j",(function(){return O})),n.d(t,"k",(function(){return g})),n.d(t,"h",(function(){return f})),n.d(t,"f",(function(){return m}));var a=n(6),r=n.n(a),c=n(9),i=n(2),s="SET_RMG_STYLE",o="SET_CANVAS_SCALE",l="SET_CANVAS_SCALE_STATUS",u="SET_CANVAS_TO_SHOW",h="SET_CANVAS_TO_SHOW_STATUS",d=function(e){return{type:s,rmgStyle:e}},b=function(e){return{type:o,canvasScale:e}},j=function(e){return{type:l,canvasScaleStatus:e}},O=function(){return function(){var e=Object(c.a)(r.a.mark((function e(t,n){var a;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t(j(i.f.loading)),e.prev=1,a=Number((n().app.canvasScale+.1).toFixed(1)),t(b(a)),e.next=6,window.rmgStorage.writeFile("rmgScale",a.toString());case 6:t(j(i.f.loaded)),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(1),t(j(i.f.failed));case 12:case"end":return e.stop()}}),e,null,[[1,9]])})));return function(t,n){return e.apply(this,arguments)}}()},g=function(){return function(){var e=Object(c.a)(r.a.mark((function e(t,n){var a,c;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t(j(i.f.loading)),e.prev=1,a=n().app.canvasScale,c=Number(a.toFixed(1))<=.1?Number(a.toFixed(1)):Number((a-.1).toFixed(1)),t(b(c)),e.next=7,window.rmgStorage.writeFile("rmgScale",c.toString());case 7:t(j(i.f.loaded)),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(1),t(j(i.f.failed));case 13:case"end":return e.stop()}}),e,null,[[1,10]])})));return function(t,n){return e.apply(this,arguments)}}()},f=function(e){return{type:u,canvasToShow:e}},p=function(e){return{type:h,canvasToShowStatus:e}},m=function(e){return function(){var t=Object(c.a)(r.a.mark((function t(n){return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n(p(i.f.loading)),t.prev=1,n(f(e)),t.next=5,window.rmgStorage.writeFile("rmgCanvas",e);case 5:n(p(i.f.loaded)),t.next=11;break;case 8:t.prev=8,t.t0=t.catch(1),n(p(i.f.failed));case 11:case"end":return t.stop()}}),t,null,[[1,8]])})));return function(e){return t.apply(this,arguments)}}()}},,,function(e,t){e.exports=ReactRedux},function(e,t){e.exports=ReactI18next},,,function(e,t){e.exports=ReactRouterDOM},function(e,t,n){"use strict";n.d(t,"a",(function(){return s})),n.d(t,"b",(function(){return o}));var a=n(3),r=n(0),c=n(4),i=n(2),s=Object(c.createContext)({}),o=function(e,t){var n,c,s,o,l,u;switch(t.type){case"GLOBAL":return t.data;case"ANY":return Object(r.a)(Object(r.a)({},e),{},Object(a.a)({},t.key,t.data));case"SET_HEIGHT":return Object(r.a)(Object(r.a)({},e),{},{svg_height:t.value});case"SET_WIDTH":return Object(r.a)(Object(r.a)({},e),{},{svgWidth:Object(r.a)(Object(r.a)({},e.svgWidth),{},Object(a.a)({},t.targetId,t.value))});case"SET_Y":return Object(r.a)(Object(r.a)({},e),{},{y_pc:t.value});case"SET_BRANCH_SPACING":return Object(r.a)(Object(r.a)({},e),{},{branch_spacing:t.value});case"SET_PADDING":return Object(r.a)(Object(r.a)({},e),{},{padding:t.value});case"SET_DIRECTION_GZ_X":return Object(r.a)(Object(r.a)({},e),{},{direction_gz_x:t.value});case"SET_DIRECTION_GZ_Y":return Object(r.a)(Object(r.a)({},e),{},{direction_gz_y:t.value});case"SET_LINE_NAME":return Object(r.a)(Object(r.a)({},e),{},{line_name:t.name});case"SET_THEME":return Object(r.a)(Object(r.a)({},e),{},{theme:t.theme});case"SET_DIRECTION":return Object(r.a)(Object(r.a)({},e),{},{direction:e.direction===i.l.left?i.l.right:i.l.left});case"SET_PLATFORM":return Object(r.a)(Object(r.a)({},e),{},{platform_num:t.platform});case"SET_TEXT_STAGGER":return Object(r.a)(Object(r.a)({},e),{},{namePosMTR:Object(r.a)(Object(r.a)({},e.namePosMTR),{},{isStagger:t.checked})});case"SET_TEXT_FLIP":return Object(r.a)(Object(r.a)({},e),{},{namePosMTR:Object(r.a)(Object(r.a)({},e.namePosMTR),{},{isFlip:!e.namePosMTR.isFlip})});case"SET_DEST_LEGACY":return Object(r.a)(Object(r.a)({},e),{},{customiseMTRDest:Object(r.a)(Object(r.a)({},e.customiseMTRDest),{},{isLegacy:t.isLegacy})});case"SET_TERMINAL_OVERRIDE":return Object(r.a)(Object(r.a)({},e),{},{customiseMTRDest:Object(r.a)(Object(r.a)({},e.customiseMTRDest),{},{terminal:t.terminal})});case"SET_LINE_NUM":return Object(r.a)(Object(r.a)({},e),{},{line_num:t.num});case"SET_PSD_NUM":return Object(r.a)(Object(r.a)({},e),{},{psd_num:t.num});case"SET_PANEL_TYPE":return Object(r.a)(Object(r.a)({},e),{},{info_panel_type:t.variant});case"ADD_NOTE_GZMTR":return Object(r.a)(Object(r.a)({},e),{},{notesGZMTR:null===(n=e.notesGZMTR)||void 0===n?void 0:n.concat([["","",0,0,!1]])});case"REMOVE_NOTE_GZMTR":return Object(r.a)(Object(r.a)({},e),{},{notesGZMTR:null===(c=e.notesGZMTR)||void 0===c?void 0:c.filter((function(e,n){return n!==t.idx}))});case"UPDATE_NOTE_GZMTR":return Object(r.a)(Object(r.a)({},e),{},{notesGZMTR:null===(s=e.notesGZMTR)||void 0===s?void 0:s.map((function(e,n){return n===t.idx?t.note:e}))});case"SET_CURRENT_STATION":return Object(r.a)(Object(r.a)({},e),{},{current_stn_idx:t.stnId});case"REVERSE_STATIONS":return Object(r.a)(Object(r.a)({},e),{},{stn_list:Object.keys(e.stn_list).reduce((function(t,n){return Object(r.a)(Object(r.a)({},t),{},Object(a.a)({},n,function(t){switch(t){case"linestart":return Object(r.a)(Object(r.a)({},e.stn_list.lineend),{},{parents:[],children:e.stn_list.lineend.parents.slice().reverse(),branch:{left:[],right:e.stn_list.lineend.branch.left}});case"lineend":return Object(r.a)(Object(r.a)({},e.stn_list.linestart),{},{parents:e.stn_list.linestart.children.slice().reverse(),children:[],branch:{left:e.stn_list.linestart.branch.right,right:[]}});default:return Object(r.a)(Object(r.a)({},e.stn_list[t]),{},{parents:e.stn_list[t].children.map((function(e){return"linestart"===e?"lineend":"lineend"===e?"linestart":e})).reverse(),children:e.stn_list[t].parents.map((function(e){return"linestart"===e?"lineend":"lineend"===e?"linestart":e})).reverse(),branch:{left:e.stn_list[t].branch.right,right:e.stn_list[t].branch.left}})}}(n)))}),{})});case"UPDATE_STATION_NAME":return Object(r.a)(Object(r.a)({},e),{},{stn_list:Object(r.a)(Object(r.a)({},e.stn_list),{},Object(a.a)({},t.stnId,Object(r.a)(Object(r.a)({},e.stn_list[t.stnId]),{},{name:t.name})))});case"UPDATE_STATION_SECONDARY_NAME":return Object(r.a)(Object(r.a)({},e),{},{stn_list:Object(r.a)(Object(r.a)({},e.stn_list),{},Object(a.a)({},t.stnId,Object(r.a)(Object(r.a)({},e.stn_list[t.stnId]),{},{secondaryName:t.name})))});case"UPDATE_STATION_NUM":return Object(r.a)(Object(r.a)({},e),{},{stn_list:Object(r.a)(Object(r.a)({},e.stn_list),{},Object(a.a)({},t.stnId,Object(r.a)(Object(r.a)({},e.stn_list[t.stnId]),{},{num:t.num})))});case"ADD_STATION_INTERCHANGE_INFO":return Object(r.a)(Object(r.a)({},e),{},{stn_list:Object(r.a)(Object(r.a)({},e.stn_list),{},Object(a.a)({},t.stnId,Object(r.a)(Object(r.a)({},e.stn_list[t.stnId]),{},{transfer:Object(r.a)(Object(r.a)({},e.stn_list[t.stnId].transfer),{},{info:function(n){var a=n.setIdx,r=n.info,c=e.stn_list[t.stnId].transfer.info.slice();return c[a]=(c[a]||[]).concat([r]),c}(t)})})))});case"REMOVE_STATION_INTERCHANGE_INFO":return Object(r.a)(Object(r.a)({},e),{},{stn_list:Object(r.a)(Object(r.a)({},e.stn_list),{},Object(a.a)({},t.stnId,Object(r.a)(Object(r.a)({},e.stn_list[t.stnId]),{},{transfer:Object(r.a)(Object(r.a)({},e.stn_list[t.stnId].transfer),{},{info:e.stn_list[t.stnId].transfer.info.map((function(e,n){return n===t.setIdx?e.slice(0,t.intIdx).concat(e.slice(t.intIdx+1)):e}))})})))});case"UPDATE_STATION_INTERCHANGE_INFO":return Object(r.a)(Object(r.a)({},e),{},{stn_list:Object(r.a)(Object(r.a)({},e.stn_list),{},Object(a.a)({},t.stnId,Object(r.a)(Object(r.a)({},e.stn_list[t.stnId]),{},{transfer:Object(r.a)(Object(r.a)({},e.stn_list[t.stnId].transfer),{},{info:null===(o=e.stn_list[t.stnId].transfer)||void 0===o?void 0:o.info.map((function(e,n){return n===t.setIdx?e.map((function(e,n){return n===t.intIdx?[0,1,2,3,4,5].map((function(n){return void 0===t.info[n]?e[n]:t.info[n]})):e})):e}))})})))});case"UPDATE_STATION_OSI_NAME":return Object(r.a)(Object(r.a)({},e),{},{stn_list:Object(r.a)(Object(r.a)({},e.stn_list),{},Object(a.a)({},t.stnId,Object(r.a)(Object(r.a)({},e.stn_list[t.stnId]),{},{transfer:Object(r.a)(Object(r.a)({},e.stn_list[t.stnId].transfer),{},{osi_names:[t.name]})})))});case"UPDATE_STATION_TICK_DIREC":return Object(r.a)(Object(r.a)({},e),{},{stn_list:Object(r.a)(Object(r.a)({},e.stn_list),{},Object(a.a)({},t.stnId,Object(r.a)(Object(r.a)({},e.stn_list[t.stnId]),{},{transfer:Object(r.a)(Object(r.a)({},e.stn_list[t.stnId].transfer),{},{tick_direc:t.direction})})))});case"UPDATE_STATION_PAID_AREA":return Object(r.a)(Object(r.a)({},e),{},{stn_list:Object(r.a)(Object(r.a)({},e.stn_list),{},Object(a.a)({},t.stnId,Object(r.a)(Object(r.a)({},e.stn_list[t.stnId]),{},{transfer:Object(r.a)(Object(r.a)({},e.stn_list[t.stnId].transfer),{},{paid_area:t.isPaid})})))});case"UPDATE_STATION_BRANCH_TYPE":return Object(r.a)(Object(r.a)({},e),{},{stn_list:Object(r.a)(Object(r.a)({},e.stn_list),{},Object(a.a)({},t.stnId,Object(r.a)(Object(r.a)({},e.stn_list[t.stnId]),{},{branch:Object(r.a)(Object(r.a)({},e.stn_list[t.stnId].branch),{},Object(a.a)({},t.direction,[t.branchType,e.stn_list[t.stnId].branch[t.direction][1]]))})))});case"UPDATE_STATION_BRANCH_FIRST":return Object(r.a)(Object(r.a)({},e),{},{stn_list:Object(r.a)(Object(r.a)({},e.stn_list),{},(l={},Object(a.a)(l,t.branches[0].stnId,Object(r.a)(Object(r.a)({},e.stn_list[t.branches[0].stnId]),{},{branch:Object(r.a)(Object(r.a)({},e.stn_list[t.branches[0].stnId].branch),{},Object(a.a)({},t.branches[0].direction,[e.stn_list[t.branches[0].stnId].branch[t.branches[0].direction][0],t.branches[0].first]))})),Object(a.a)(l,t.branches[1].stnId,Object(r.a)(Object(r.a)({},e.stn_list[t.branches[1].stnId]),{},{branch:Object(r.a)(Object(r.a)({},e.stn_list[t.branches[1].stnId].branch),{},Object(a.a)({},t.branches[1].direction,[e.stn_list[t.branches[1].stnId].branch[t.branches[1].direction][0],t.branches[1].first]))})),l))});case"UPDATE_STATION_BRANCH_POS":return Object(r.a)(Object(r.a)({},e),{},{stn_list:Object(r.a)(Object(r.a)({},e.stn_list),{},(u={},Object(a.a)(u,t.left,Object(r.a)(Object(r.a)({},e.stn_list[t.left]),{},{parents:e.stn_list[t.left].parents.slice().reverse()})),Object(a.a)(u,t.right,Object(r.a)(Object(r.a)({},e.stn_list[t.right]),{},{children:e.stn_list[t.right].children.slice().reverse()})),u))});case"UPDATE_STATION_FACILITY":return Object(r.a)(Object(r.a)({},e),{},{stn_list:Object(r.a)(Object(r.a)({},e.stn_list),{},Object(a.a)({},t.stnId,Object(r.a)(Object(r.a)({},e.stn_list[t.stnId]),{},{facility:t.facility})))});case"UPDATE_STATION_SERVICES":return Object(r.a)(Object(r.a)({},e),{},{stn_list:Object(r.a)(Object(r.a)({},e.stn_list),{},Object(a.a)({},t.stnId,Object(r.a)(Object(r.a)({},e.stn_list[t.stnId]),{},{services:Array.from(t.isChecked?new Set(e.stn_list[t.stnId].services).add(t.serviceId):e.stn_list[t.stnId].services.filter((function(e){return e!==t.serviceId})))})))});case"UPDATE_STATION_LIST":return Object(r.a)(Object(r.a)({},e),{},{stn_list:t.stnList});default:return e}}},,,function(e,t,n){"use strict";n.d(t,"c",(function(){return i})),n.d(t,"a",(function(){return s})),n.d(t,"b",(function(){return o})),n.d(t,"d",(function(){return l}));var a=n(8),r=n(4),c=n.n(r),i=function e(t,n){if(["linestart","lineend"].includes(t)||n[t].parents.length>1||n[t].children.length>1)return 0;var a=n[t].parents[0];return a?1===n[a].children.length?e(a,n):0===n[a].children.indexOf(t)?1:-1:0},s=function(e){console.log("computing branches");for(var t=["linestart"],n=[["linestart"]],a=0;t.length;){var r=t.shift(),c=n[a].slice().reverse()[0]||null;for(c&&"linestart"!==r?n[a].push(r):n[a]=[r];"lineend"!==r;){var i=e[c=r].children;if(function(){switch(i.length){case 1:r=i[0];break;case 2:var s=e[c].branch.right[1];"through"===e[c].branch.right[0]?(n.push([r]),t.push(s)):0===a&&(n.push([c]),t.push(s)),r=i.filter((function(e){return e!==s}))[0]}}(),n[a].push(r),c===e[r].branch.left[1])break}a++}return n},o=function(e){console.log("computing routes");for(var t=["linestart"],n=[["linestart"]],a=0;t.length;){var r=t.shift(),c=n[a].slice().reverse()[0]||null;for(c&&"linestart"!==r?n[a].push(r):n[a]=[r];"lineend"!==r;){var i=e[c=r].children;if(function(){switch(i.length){case 1:r=i[0];break;case 2:var s=e[c].branch.right[1];"through"===e[c].branch.right[0]?(n.push(n[a].slice()),t.push(s)):0===a&&(n.push([c]),t.push(s)),r=i.filter((function(e){return e!==s}))[0]}}(),n[a].push(r),c===e[r].branch.left[1]&&"nonthrough"===e[r].branch.left[0])break}a++}return n},l=function(e){var t=c.a.useState([]),n=Object(a.a)(t,2),r=n[0],i=n[1];return c.a.useEffect((function(){if(console.log("computing tpo"),1!==e.length){var t=e.reduce((function(e,t){var n=e.indexOf(t.slice(-1)[0]);return e.slice(0,n).concat(t.slice(1),e.slice(n+1))}),["lineend"]).slice(0,-1);i(t)}else i(e[0].slice(1,-1))}),[e.toString()]),r}},,function(e,t){e.exports=Redux},function(e,t,n){"use strict";n.d(t,"c",(function(){return i})),n.d(t,"b",(function(){return s})),n.d(t,"a",(function(){return o}));var a=n(23),r=n(8),c=n(2),i=function(e){var t;"line_name"in e||(e.line_name=["\u8def\u7dda\u540d","Name of Line"]),"dest_legacy"in e||(e.dest_legacy=!1),delete e.fontZH,delete e.fontEN,delete e.weightZH,delete e.weightEN;for(var n=0,a=Object.entries(e.stn_list);n<a.length;n++){var c=Object(r.a)(a[n],2),i=c[0],s=c[1];"branch"in s||(e.stn_list[i].branch={left:[],right:[]},2===s.children.length?e.stn_list[i].branch.right=["through",s.children[1]]:e.stn_list[i].branch.right=[],2===s.parents.length?e.stn_list[i].branch.left=["through",s.parents[1]]:e.stn_list[i].branch.left=[])}e.psd_num="psd_num"in e?e.psd_num.toString():"1","line_num"in e||(e.line_num="1"),delete e.style,3===e.theme.length&&e.theme.push("#fff");for(var o=0,l=Object.entries(e.stn_list);o<l.length;o++){var u=Object(r.a)(l[o],2),h=u[0],d=u[1];"num"in d||(e.stn_list[h].num="00"),"interchange"in d&&d.interchange.map((function(e){return e.forEach((function(e){5===e.length&&e.splice(3,0,"#fff")}))}))}for(var b=0,j=Object.entries(e.stn_list);b<j.length;b++){var O=Object(r.a)(j[b],2),g=O[0],f=O[1];"osi22_end_p"===f.change_type&&(e.stn_list[g].change_type="osi22_pr"),"osi22_end_u"===f.change_type&&(e.stn_list[g].change_type="osi22_ur")}for(var p=0,m=Object.entries(e.stn_list);p<m.length;p++){var _=Object(r.a)(m[p],2),v=_[0];"interchange"in _[1]||(e.stn_list[v].interchange=[[]])}e.info_panel_type="info_panel_type"in e?function(e){switch(e){case"gz_1":case"panasonic":return"gz28";case"gz_2":return"gz6";case"gz_3":return"gz3";default:return e}}(e.info_panel_type):"gz28","direction_gz_x"in e||(e.direction_gz_x=50),"direction_gz_y"in e||(e.direction_gz_y=70);for(var y=0,T=Object.entries(e.stn_list);y<T.length;y++){var S,x,w,I,z=Object(r.a)(T[y],2),E=z[0],N=z[1];if(!("transfer"in N))e.stn_list[E].transfer={tick_direc:"none"===N.change_type||"int2"===N.change_type?"r":null===(S=N.change_type)||void 0===S?void 0:S.split("_")[1].split("").slice().reverse()[0],paid_area:-1===(null===(x=N.change_type)||void 0===x?void 0:x.indexOf("osi"))||"p"===(null===(w=N.change_type)||void 0===w?void 0:w.split("_")[1][0]),osi_names:-1!==(null===(I=N.change_type)||void 0===I?void 0:I.indexOf("osi"))?[N.interchange[1][0]]:[],info:2===N.interchange.length?[N.interchange[0],N.interchange[1].slice(1)]:N.interchange};delete e.stn_list[E].change_type,delete e.stn_list[E].interchange}for(var k=0,R=Object.entries(e.stn_list);k<R.length;k++){var M=Object(r.a)(R[k],2),A=M[0],C=M[1];"services"in C||(e.stn_list[A].services=["local"]),"facility"in C||(e.stn_list[A].facility="usage"in C?C.usage:""),delete e.stn_list[A].usage}return"customiseMTRDest"in e||(e.customiseMTRDest={isLegacy:e.dest_legacy||!1,terminal:!1}),delete e.dest_legacy,"svgWidth"in e||(e.svgWidth={destination:e.svg_dest_width,runin:e.svg_dest_width,railmap:e.svg_width,indoor:e.svg_width}),"indoor"in e.svgWidth||(e.svgWidth.indoor=e.svgWidth.railmap),delete e.svg_width,delete e.svg_dest_width,"notesGZMTR"in e||(e.notesGZMTR=[]),e.notesGZMTR=null===(t=e.notesGZMTR)||void 0===t?void 0:t.map((function(e){return 4===e.length?e.concat([!1]):e})),delete e.char_form,delete e.show_outer,delete e.strip_pc,delete e.txt_bg_gap,"namePosMTR"in e||(e.namePosMTR={isStagger:!0,isFlip:e.txt_flip}),delete e.txt_flip,Object.keys(e.stn_list).forEach((function(t){"secondaryName"in e.stn_list[t]?!1!==e.stn_list[t].secondaryName&&","===e.stn_list[t].secondaryName.join()&&(e.stn_list[t].secondaryName=!1):e.stn_list[t].secondaryName=!1,"type"in e.stn_list[t].transfer&&delete e.stn_list[t].transfer.type})),e},s=function(e,t){var n,r=Object(a.a)(t);try{for(r.s();!(n=r.n()).done;){var i=n.value;if(e[i])return e[i]}}catch(s){r.e(s)}finally{r.f()}return e[c.e.English]},o=function(e,t){return(t===c.j.GZMTR?((null===e||void 0===e?void 0:e.num)||"-")+": ":"")+(null===e||void 0===e?void 0:e.name.join().replace("\\"," "))}},function(e,t){e.exports=i18next},,function(e,t,n){"use strict";var a;n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return r})),function(e){e.Barcelona="barcelona",e.Beijing="beijing",e.Changsha="changsha",e.Chengdu="chengdu",e.Chongqing="chongqing",e.Dongguan="dongguan",e.Edinburgh="edinburgh",e.Foshan="foshan",e.Glasgow="glasgow",e.Guangzhou="guangzhou",e.Hangzhou="hangzhou",e.HongKong="hongkong",e.Kansai="kansai",e.Kaohsiung="kaohsiung",e.London="london",e.Macao="macao",e.Madrid="madrid",e.Nanjing="nanjing",e.NewTaipei="newtaipei",e.Osaka="osaka",e.Oslo="oslo",e.Paris="paris",e.Qingdao="qingdao",e.SanFrancisco="sanfrancisco",e.Seoul="seoul",e.Shanghai="shanghai",e.Shenzhen="shenzhen",e.Singapore="singapore",e.Stockholm="stockholm",e.Taipei="taipei",e.Tianjin="tianjin",e.Tokyo="tokyo",e.Toronto="toronto",e.TyneAndWear="tyneandwear",e.Xian="xian",e.Other="other"}(a||(a={}));var r=[{id:a.Barcelona,country:"ES",name:{en:"Barcelona","zh-Hans":"\u5df4\u585e\u7f57\u90a3","zh-HK":"\u5df4\u585e\u9686\u62ff","zh-TW":"\u5df4\u585e\u9686\u7d0d"}},{id:a.Beijing,country:"CN",name:{en:"Beijing",zh:"\u5317\u4eac"}},{id:a.Changsha,country:"CN",name:{en:"Changsha","zh-Hans":"\u957f\u6c99","zh-Hant":"\u9577\u6c99"}},{id:a.Chengdu,country:"CN",name:{en:"Chengdu",zh:"\u6210\u90fd"}},{id:a.Chongqing,country:"CN",name:{en:"Chongqing","zh-Hans":"\u91cd\u5e86","zh-Hant":"\u91cd\u6176"}},{id:a.Dongguan,country:"CN",name:{en:"Dongguan","zh-Hans":"\u4e1c\u839e","zh-Hant":"\u6771\u839e"}},{id:a.Edinburgh,country:"GBSCT",name:{en:"Edinburgh",ga:"D\xf9n \xc8ideann","zh-Hans":"\u7231\u4e01\u5821","zh-Hant":"\u611b\u4e01\u5821"}},{id:a.Foshan,country:"CN",name:{en:"Foshan",zh:"\u4f5b\u5c71"}},{id:a.Glasgow,country:"GBSCT",name:{en:"Glasgow",ga:"Glaschu",zh:"\u683c\u62c9\u65af\u54e5"}},{id:a.Guangzhou,country:"CN",name:{en:"Guangzhou","zh-Hans":"\u5e7f\u5dde","zh-Hant":"\u5ee3\u5dde"}},{id:a.Hangzhou,country:"CN",name:{en:"Hangzhou",zh:"\u676d\u5dde"}},{id:a.HongKong,country:"HK",name:{en:"Hong Kong",zh:"\u9999\u6e2f"}},{id:a.Kansai,country:"JP",name:{en:"Kansai Area",ja:"\u8fd1\u757f\u5730\u65b9","zh-Hans":"\u8fd1\u757f\u5730\u65b9\uff08\u5173\u897f\u5730\u65b9\uff09","zh-Hant":"\u8fd1\u757f\u5730\u65b9\uff08\u95dc\u897f\u5730\u65b9\uff09"}},{id:a.Kaohsiung,country:"TW",name:{en:"Kaohsiung",zh:"\u9ad8\u96c4"}},{id:a.London,country:"GBENG",name:{en:"London","zh-Hans":"\u4f26\u6566","zh-Hant":"\u502b\u6566"}},{id:a.Macao,country:"MO",name:{en:"Macao",pt:"Macau","zh-Hans":"\u6fb3\u95e8","zh-Hant":"\u6fb3\u9580"}},{id:a.Madrid,country:"ES",name:{en:"Madrid","zh-Hans":"\u9a6c\u5fb7\u91cc","zh-Hant":"\u99ac\u5fb7\u91cc"}},{id:a.Nanjing,country:"CN",name:{en:"Nanjing",zh:"\u5357\u4eac"}},{id:a.NewTaipei,country:"TW",name:{en:"New Taipei",zh:"\u65b0\u5317"}},{id:a.Osaka,country:"JP",name:{en:"Osaka",ja:"\u5927\u962a",zh:"\u5927\u962a"}},{id:a.Oslo,country:"NO",name:{en:"Oslo","zh-Hans":"\u5965\u65af\u9646","zh-Hant":"\u5967\u65af\u9678"}},{id:a.Paris,country:"FR",name:{en:"Paris",zh:"\u5df4\u9ece"}},{id:a.Qingdao,country:"CN",name:{en:"Qingdao","zh-Hans":"\u9752\u5c9b","zh-Hant":"\u9752\u5cf6"}},{id:a.SanFrancisco,country:"US",name:{en:"San Francisco","zh-Hans":"\u65e7\u91d1\u5c71","zh-HK":"\u4e09\u85e9\u5e02","zh-TW":"\u820a\u91d1\u5c71"}},{id:a.Seoul,country:"KR",name:{en:"Seoul (Metropolitan Area)",ko:"\uc11c\uc6b8(\uc218\ub3c4\uad8c)","zh-Hans":"\u9996\u5c14\uff08\u9996\u90fd\u5708\uff09","zh-Hant":"\u9996\u723e\uff08\u9996\u90fd\u5708\uff09"}},{id:a.Shanghai,country:"CN",name:{en:"Shanghai",zh:"\u4e0a\u6d77"}},{id:a.Shenzhen,country:"CN",name:{en:"Shenzhen",zh:"\u6df1\u5733"}},{id:a.Singapore,country:"SG",name:{en:"Singapore",zh:"\u65b0\u52a0\u5761"}},{id:a.Stockholm,country:"SE",name:{en:"Stockholm","zh-Hans":"\u65af\u5fb7\u54e5\u5c14\u6469","zh-Hant":"\u65af\u5fb7\u54e5\u723e\u6469"}},{id:a.Taipei,country:"TW",name:{en:"Taipei",zh:"\u53f0\u5317"}},{id:a.Tianjin,country:"CN",name:{en:"Tianjin",zh:"\u5929\u6d25"}},{id:a.Tokyo,country:"JP",name:{en:"Tokyo (Greater Tokyo Area)",ja:"\u6771\u4eac\uff08\u9996\u90fd\u570f\uff09","zh-Hans":"\u4e1c\u4eac\uff08\u9996\u90fd\u5708\uff09","zh-Hant":"\u6771\u4eac\uff08\u9996\u90fd\u5708\uff09"}},{id:a.Toronto,country:"CA",name:{en:"Toronto","zh-Hans":"\u591a\u4f26\u591a","zh-Hant":"\u591a\u502b\u591a"}},{id:a.TyneAndWear,country:"GBENG",name:{en:"Tyne and Wear","zh-Hans":"\u6cf0\u6069-\u5a01\u5c14","zh-HK":"\u6cf0\u5a01","zh-TW":"\u6cf0\u6069-\u5a01\u723e"}},{id:a.Xian,country:"CN",name:{en:"Xi'an",zh:"\u897f\u5b89"}},{id:a.Other,country:"UN",name:{en:"Customise","zh-Hans":"\u81ea\u5b9a\u4e49","zh-Hant":"\u81ea\u8a02"}}]},,,function(e,t){e.exports=ReactDOM},function(e,t){e.exports=i18nextXHRBackend},function(e,t){e.exports=i18nextBrowserLanguageDetector},function(e,t){e.exports=ReduxThunk},,function(e,t,n){},,function(e,t,n){"use strict";n.r(t);var a=n(6),r=n.n(a),c=n(9),i=n(12),s=n(4),o=n.n(s),l=n(27),u=(n(32),n(22)),h=n.n(u),d=n(11),b=n(28),j=n.n(b),O=n(29),g=n.n(O);h.a.use(j.a).use(g.a).use(d.initReactI18next).init({fallbackLng:{"zh-CN":["zh-Hans","en"],"zh-Hant":["zh-HK","en"],"zh-HK":["zh-Hant","en"],"zh-TW":["zh-HK","zh-Hant"],default:["en"]},backend:{loadPath:"/uat-rail-map-generator/locale/{{lng}}.json"},interpolation:{escapeValue:!1}}).then((function(e){document.title=e("title"),document.documentElement.setAttribute("lang",h.a.language)}));var f,p,m,_,v=n(8),y=n(14),T=n(5),S=n(2),x=n(10),w=n(7),I=n(1),z=Object(T.makeStyles)((function(e){return Object(T.createStyles)({rootLight:{backgroundColor:e.palette.primary.main},rootDark:{backgroundColor:e.palette.background.paper},title:{flexGrow:1,color:"#fff"},menuButton:{color:"#fff"}})})),E=function(){var e=Object(d.useTranslation)(),t=e.t,n=e.i18n,a=z(),r=Object(T.useMediaQuery)("(prefers-color-scheme: dark)");return s.useMemo((function(){return Object(I.jsx)(T.AppBar,{position:"sticky",className:r?a.rootDark:a.rootLight,children:Object(I.jsxs)(T.Toolbar,{variant:"dense",children:[Object(I.jsx)(T.Typography,{variant:"h6",className:a.title,color:"textPrimary",children:"/uat-rail-map-generator".includes("uat")?t("titleUAT"):t("title")}),Object(I.jsx)(N,{}),Object(I.jsx)(k,{})]})})}),[r,n.language])},N=function(){var e=Object(d.useTranslation)().t,t=z(),n=Object(x.useDispatch)(),a=Object(x.useSelector)((function(e){return e.app.rmgStyle})),r=s.useState(null),c=Object(v.a)(r,2),i=c[0],o=c[1],l=function(e){return function(){n(Object(w.f)(e)),o(null)}};return s.useMemo((function(){return Object(I.jsxs)(I.Fragment,{children:[Object(I.jsx)(T.Tooltip,{title:e("toggle.tooltip"),children:Object(I.jsx)(T.IconButton,{onClick:function(e){return o(e.currentTarget)},className:t.menuButton,children:Object(I.jsx)(T.Icon,{children:"photo_library"})})}),Object(I.jsxs)(T.Menu,{anchorEl:i,open:Boolean(i),onClose:function(){return o(null)},children:[S.m[a].map((function(t){return Object(I.jsx)(T.MenuItem,{onClick:l(t),children:e("toggle."+t)},t)})),Object(I.jsx)(T.Divider,{style:{margin:"6px 0"}}),Object(I.jsx)(T.MenuItem,{onClick:l(S.a),children:e("toggle.all")})]})]})}),[a,i,t.menuButton])},k=function(){var e=Object(d.useTranslation)().t,t=z(),n=Object(x.useDispatch)();return s.useMemo((function(){return Object(I.jsxs)(I.Fragment,{children:[Object(I.jsx)(T.Tooltip,{title:e("zoom.out"),children:Object(I.jsx)(T.IconButton,{onClick:function(){return n(Object(w.k)())},className:t.menuButton,children:Object(I.jsx)(T.Icon,{children:"zoom_out"})})}),Object(I.jsx)(T.Tooltip,{title:e("zoom.in"),children:Object(I.jsx)(T.IconButton,{onClick:function(){return n(Object(w.j)())},className:t.menuButton,children:Object(I.jsx)(T.Icon,{children:"zoom_in"})})})]})}),[t.menuButton])},R=n(0),M=n(3),A=n(15),C=n(17),H=n(19),D=n(26),P=n(25),F=function(e){Object(D.a)(n,e);var t=Object(P.a)(n);function n(e){var a;return Object(C.a)(this,n),(a=t.call(this,e)).state={hasError:!1},a}return Object(H.a)(n,[{key:"componentDidCatch",value:function(e,t){}},{key:"render",value:function(){return this.state.hasError?Object(I.jsx)("h1",{children:"Something went wrong."}):this.props.children}}],[{key:"getDerivedStateFromError",value:function(e){return{hasError:!0}}}]),n}(o.a.Component),B=Object(T.makeStyles)((function(){return Object(T.createStyles)({root:{display:"flex",flexDirection:"row",overflowX:"scroll","&::before, &::after":{content:'""',margin:"auto"},"& > svg":{flex:"0 0 auto",border:"1px solid black"}}})})),G=function(){var e=B(),t=o.a.useContext(A.a).param,n=Object(x.useSelector)((function(e){return e.app.canvasScale})),a=o.a.useCallback((function(e){var a;return{id:e,xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",height:t.svg_height*n,viewBox:"0 0 ".concat(t.svgWidth[e]," ").concat(t.svg_height),colorInterpolationFilters:"sRGB",style:(a={},Object(M.a)(a,"--rmg-svg-width",t.svgWidth[e]+"px"),Object(M.a)(a,"--rmg-svg-height",t.svg_height+"px"),Object(M.a)(a,"--rmg-theme-colour",t.theme[2]),Object(M.a)(a,"--rmg-theme-fg",t.theme[3]),a)}}),[t.svg_height,JSON.stringify(t.svgWidth),t.theme[2],t.theme[3],n]);return Object(I.jsx)("div",{className:e.root,children:Object(I.jsxs)(y.Switch,{children:[Object.entries(S.m).map((function(e){var t=Object(v.a)(e,2),n=t[0];t[1];return Object(I.jsx)(y.Route,{path:"/".concat(n),children:Object(I.jsx)(L,{style:n,canvasAvailable:Q[n],svgProps:a})},n)})),Object(I.jsx)(y.Redirect,{to:"/"+S.j.MTR})]})})},L=Object(s.memo)((function(e){var t=Object(x.useDispatch)(),n=Object(x.useSelector)((function(e){return e.app.canvasToShow}));return t(Object(w.i)(e.style)),Object(s.useEffect)((function(){["share"].concat(Object(i.a)(Object.values(S.c))).forEach((function(t){t in e.canvasAvailable||"share"===t?document.getElementById("css_"+t).href="/uat-rail-map-generator"+"/styles/".concat(t,"_").concat(e.style,".css"):document.getElementById("css_"+t).href=""})),![].concat(Object(i.a)(S.m[e.style]),[S.a]).includes(n)&&t(Object(w.f)(S.a))}),[]),Object(I.jsx)(I.Fragment,{children:Object.keys(e.canvasAvailable).map((function(t){return[S.a,t].includes(n)&&Object(I.jsx)(o.a.Suspense,{fallback:Object(I.jsx)(T.CircularProgress,{}),children:Object(I.jsx)(F,{children:Object(I.jsxs)("svg",Object(R.a)(Object(R.a)({},e.svgProps(t)),{},{children:[Object(I.jsx)("rect",{id:"canvas-bg",fill:"white",style:{height:"var(--rmg-svg-height)",width:"var(--rmg-svg-width)"}}),e.canvasAvailable[t],Object(I.jsx)("rect",{id:"canvas-border",fill:"none",strokeWidth:3,stroke:"none",style:{height:"var(--rmg-svg-height)",width:"var(--rmg-svg-width)"}})]}))})},t)}))})})),W=Object(s.lazy)((function(){return n.e(91).then(n.bind(null,135))})),U=Object(s.lazy)((function(){return n.e(88).then(n.bind(null,129))})),K=Object(s.lazy)((function(){return n.e(69).then(n.bind(null,115))})),Z=Object(s.lazy)((function(){return n.e(89).then(n.bind(null,130))})),J=Object(s.lazy)((function(){return n.e(70).then(n.bind(null,116))})),V=Object(s.lazy)((function(){return n.e(92).then(n.bind(null,117))})),Y=Object(s.lazy)((function(){return n.e(90).then(n.bind(null,131))})),X=Object(s.lazy)((function(){return n.e(71).then(n.bind(null,136))})),Q=(_={},Object(M.a)(_,S.j.GZMTR,(f={},Object(M.a)(f,S.c.RunIn,Object(I.jsx)(W,{})),Object(M.a)(f,S.c.RailMap,Object(I.jsx)(U,{})),f)),Object(M.a)(_,S.j.MTR,(p={},Object(M.a)(p,S.c.Destination,Object(I.jsx)(K,{})),Object(M.a)(p,S.c.RailMap,Object(I.jsx)(Z,{})),p)),Object(M.a)(_,S.j.SHMetro,(m={},Object(M.a)(m,S.c.Destination,Object(I.jsx)(J,{})),Object(M.a)(m,S.c.RunIn,Object(I.jsx)(V,{})),Object(M.a)(m,S.c.RailMap,Object(I.jsx)(Y,{})),Object(M.a)(m,S.c.Indoor,Object(I.jsx)(X,{})),m)),_),q=G,$=s.lazy((function(){return n.e(81).then(n.bind(null,128))})),ee=s.lazy((function(){return n.e(78).then(n.bind(null,132))})),te=s.lazy((function(){return n.e(73).then(n.bind(null,133))})),ne=s.lazy((function(){return n.e(83).then(n.bind(null,127))})),ae=s.lazy((function(){return n.e(77).then(n.bind(null,118))})),re=Object(T.makeStyles)((function(e){var t;return Object(T.createStyles)({root:Object(M.a)({display:"flex",flexDirection:"row",height:"100%"},e.breakpoints.down("xs"),{flexDirection:"column"}),typography:{background:e.palette.background.default},tab:(t={padding:"6px 24px",height:48,"& .MuiTab-wrapper":{flexDirection:"row"}},Object(M.a)(t,e.breakpoints.up("sm"),{"& .MuiTab-wrapper":{justifyContent:"flex-start"}}),Object(M.a)(t,e.breakpoints.down("xs"),{minWidth:"calc(100% / 5)"}),Object(M.a)(t,"&.MuiTab-labelIcon",{minHeight:"unset","& .MuiTab-wrapper":{"& > *:first-child":{marginBottom:0},"& > *:not(first-child)":{paddingLeft:8}}}),t),tabs:{overflow:"auto","&::-webkit-scrollbar":{width:0},scrollbarWidth:"none",WebkitOverflowScrolling:"touch"},tabpanel:{overflow:"auto",flex:1,padding:e.spacing(3),paddingBottom:0,height:"calc(100% - ".concat(e.spacing(3),"px)"),display:"flex",justifyContent:"center",alignItems:"flex-start"}})}));function ce(){var e=Object(d.useTranslation)(),t=e.t,n=e.i18n,a=re(),r=Object(T.useTheme)(),c=Object(T.useMediaQuery)(r.breakpoints.down("xs")),i=s.useState(0),o=Object(v.a)(i,2),l=o[0],u=o[1],h=s.useMemo((function(){return Object(I.jsx)(T.Typography,{className:"".concat(a.typography," ").concat(a.tabs),component:"div",children:Object(I.jsx)(T.Tabs,{value:l,orientation:c?"horizontal":"vertical",indicatorColor:"primary",textColor:"primary",onChange:function(e,t){return u(t)},variant:"scrollable",scrollButtons:"off",children:[["file","insert_drive_file"],["layout","panorama"],["design","brush"],["stations","directions_transit"],["info","info"]].map((function(e,n){return Object(I.jsx)(T.Tab,{label:Object(I.jsx)("span",{children:t("tab."+e[0])}),icon:Object(I.jsx)(T.Icon,{children:e[1]}),className:a.tab},n)}))})})}),[l,n.language,a.tab,c]);return Object(I.jsxs)("div",{className:a.root,children:[h,Object(I.jsx)(T.Typography,{className:"".concat(a.typography," ").concat(a.tabpanel),component:"div",role:"tabpanel",children:Object(I.jsx)(s.Suspense,{fallback:Object(I.jsx)(T.CircularProgress,{}),children:function(e){switch(e){case 0:return Object(I.jsx)($,{});case 1:return Object(I.jsx)(ee,{});case 2:return Object(I.jsx)(te,{});case 3:return Object(I.jsx)(ne,{});case 4:return Object(I.jsx)(ae,{});default:return Object(I.jsx)($,{})}}(l)})})]})}function ie(){return Object(I.jsx)(s.Suspense,{fallback:Object(I.jsx)(T.CircularProgress,{}),children:Object(I.jsx)(ce,{})})}var se=n(18),oe=Object(T.createMuiTheme)({palette:{type:"dark",primary:{main:"#bb86fc"},secondary:{main:"#018786"},error:{main:"#cf6679"}},overrides:{MuiDialog:{paper:{minWidth:280}}}}),le=Object(T.createMuiTheme)({palette:{primary:{light:"#bb86fc",main:"#6200ee"},secondary:{main:"#018786"},error:{main:"#b00020"}},overrides:{MuiDialog:{paper:{minWidth:280}}}});function ue(){var e=Object(T.useMediaQuery)("(prefers-color-scheme: dark)")?oe:le;return Object(I.jsx)(y.BrowserRouter,{basename:"/uat-rail-map-generator",children:Object(I.jsxs)(T.ThemeProvider,{theme:e,children:[Object(I.jsx)(o.a.Suspense,{fallback:Object(I.jsx)(T.LinearProgress,{}),children:Object(I.jsx)(E,{})}),Object(I.jsx)(he,{})]})})}var he=function(){var e=Object(s.useReducer)(A.b,JSON.parse(localStorage.rmgParam)),t=Object(v.a)(e,2),n=t[0],a=t[1],r=JSON.stringify(n);Object(s.useEffect)((function(){window.rmgStorage.writeFile("rmgParam",r).then()}),[r]);var c=Object.keys(n.stn_list).reduce((function(e,t){return e+t+function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(e){return t.reduce((function(t,n){return t+JSON.stringify(e[n])}),"")}}("parents","children","branch")(n.stn_list[t])}),""),i=Object(s.useMemo)((function(){return Object(se.a)(n.stn_list)}),[c]),o=Object(s.useMemo)((function(){return Object(se.b)(n.stn_list)}),[c]),l=Object(se.d)(i);return Object(I.jsxs)(I.Fragment,{children:[Object(I.jsxs)(A.a.Provider,{value:{param:n,dispatch:a,branches:i,routes:o,deps:c,tpo:l},children:[Object(I.jsx)("div",{style:{overflowY:"auto"},children:Object(I.jsx)(q,{})}),Object(I.jsx)("div",{style:{flex:1,overflow:"hidden"},children:Object(I.jsx)(ie,{})})]}),Object(I.jsx)("canvas",{style:{display:"none"}})]})},de=n(21);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var be=function(){function e(){Object(C.a)(this,e),this.currentBusyFilename=void 0,this.currentBusyFilename=!1}return Object(H.a)(e,[{key:"init",value:function(){var e=Object(c.a)(r.a.mark((function e(){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(console.warn("Using localStorage, please update your browser"),window.localStorage){e.next=4;break}throw alert("Local storage is not available! Please upgrade to a newer browser!"),new Error("LocalStorage unavailable");case 4:e.prev=4,window.localStorage.setItem("storage_test","1"),window.localStorage.removeItem("storage_test"),e.next=13;break;case 9:throw e.prev=9,e.t0=e.catch(4),alert("Local storage is not accessible! Please modify your browser's settings or try with another browser!"),new Error("LocalStorage no write permission");case 13:case"end":return e.stop()}}),e,null,[[4,9]])})));return function(){return e.apply(this,arguments)}}()},{key:"writeFile",value:function(){var e=Object(c.a)(r.a.mark((function e(t,n){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.currentBusyFilename===t&&console.warn("Attempt to write",t,"while write process is not finished!"),this.currentBusyFilename=t,window.localStorage.setItem(t,n),this.currentBusyFilename=!1;case 4:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"readFile",value:function(){var e=Object(c.a)(r.a.mark((function e(t){var n;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.currentBusyFilename===t&&console.warn("Attempt to read",t,"while write process is not finished!"),n=window.localStorage.getItem(t)){e.next=4;break}throw new Error("FILE_NOT_FOUND");case 4:return e.abrupt("return",n);case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"deleteFile",value:function(){var e=Object(c.a)(r.a.mark((function e(t){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.currentBusyFilename===t&&console.warn("Attempt to delete",t,"while write process is not finished!"),this.currentBusyFilename=t,window.localStorage.removeItem(t),this.currentBusyFilename=!1;case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),e}();function je(){return(je=Object(c.a)(r.a.mark((function e(){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(window.indexedDB){e.next=3;break}return console.log("IndexedDB not supported"),e.abrupt("return",new be);case 3:return e.next=5,new Promise((function(e){try{var t=window.indexedDB.open("indexeddb_feature_detection",1);t.onerror=function(t){console.log("IndexedDB can NOT be accessed:",t),console.log("Fallback to LocalStorage"),e(new be)},t.onsuccess=function(){console.log("IndexedDB can be accessed"),e(new be)}}catch(n){console.warn("Error while opening IndexedDB:",n),e(new be)}}));case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var Oe=n(20),ge=n(30),fe=n.n(ge),pe={rmgStyle:S.j.MTR,canvasScale:1,canvasScaleStatus:S.f.init,canvasToShow:S.a,canvasToShowStatus:S.f.init};var me=n(24),_e="SET_FULL_PARAM",ve={svgWidth:{destination:100,runin:100,railmap:100,indoor:100},svg_height:100,y_pc:50,padding:10,branch_spacing:10,direction:S.l.left,platform_num:"1",theme:[me.a.HongKong,"twl","#E2231A",S.g.white],line_name:["\u7dda","line"],current_stn_idx:"",stn_list:{},namePosMTR:{isStagger:!0,isFlip:!0},customiseMTRDest:{isLegacy:!0,terminal:!1},line_num:"1",psd_num:"1",info_panel_type:S.h.gz1,notesGZMTR:[],direction_gz_x:0,direction_gz_y:0};var ye,Te=Object(Oe.combineReducers)({app:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:pe,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case w.e:e.rmgStyle=t.rmgStyle;break;case w.a:e.canvasScale=t.canvasScale;break;case w.b:e.canvasScaleStatus=t.canvasScaleStatus;break;case w.c:e.canvasToShow=t.canvasToShow;break;case w.d:e.canvasToShowStatus=t.canvasToShowStatus}return Object(R.a)({},e)},param:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ve,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case _e:return t.fullParam}return Object(R.a)({},e)}}),Se=Object(Oe.createStore)(Te,Object(Oe.applyMiddleware)(fe.a));"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)})),(ye=document.head).append.apply(ye,Object(i.a)(["share"].concat(Object(i.a)(Object.values(S.c))).map((function(e){var t=document.createElement("link");return t.rel="stylesheet",t.id="css_"+e,t}))));(function(){return je.apply(this,arguments)})().then(function(){var e=Object(c.a)(r.a.mark((function e(t){var a,c,i,s;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.init();case 2:return e.prev=2,e.next=5,t.readFile("rmgParam");case 5:return a=e.sent,c=Object(de.c)(JSON.parse(a)),e.next=9,t.writeFile("rmgParam",JSON.stringify(c));case 9:e.next=20;break;case 11:return e.prev=11,e.t0=e.catch(2),console.warn("Error in reading rmgParam",e.t0),e.next=16,n.e(0).then(n.bind(null,80));case 16:return i=e.sent,s=Object(de.c)(i.default),e.next=20,t.writeFile("rmgParam",JSON.stringify(s));case 20:return e.prev=20,window.rmgStorage=t,e.finish(20);case 23:case"end":return e.stop()}}),e,null,[[2,11,20,23]])})));return function(t){return e.apply(this,arguments)}}()).then(Object(c.a)(r.a.mark((function e(){var t;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,window.rmgStorage.readFile("rmgParam");case 2:t=e.sent,Se.dispatch((n=JSON.parse(t),{type:_e,fullParam:n}));case 4:case"end":return e.stop()}var n}),e)})))).then(Object(c.a)(r.a.mark((function e(){var t,n,a;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,window.rmgStorage.readFile("rmgScale");case 3:t=e.sent,(n=Number(t))>=.1&&Se.dispatch(Object(w.g)(n)),e.next=15;break;case 8:return e.prev=8,e.t0=e.catch(0),console.warn("Error in reading rmgScale file",e.t0),console.log("Initiating rmgScale as 1"),e.next=14,window.rmgStorage.writeFile("rmgScale","1");case 14:Se.dispatch(Object(w.g)(1));case 15:return e.prev=15,e.next=18,window.rmgStorage.readFile("rmgCanvas");case 18:a=e.sent,Se.dispatch(Object(w.h)(a)),e.next=29;break;case 22:return e.prev=22,e.t1=e.catch(15),console.warn("Error in reading rmgCanvas file",e.t1),console.log('Initiating rmgCanvas as "all"'),e.next=28,window.rmgStorage.writeFile("rmgCanvas",S.a);case 28:Se.dispatch(Object(w.h)(S.a));case 29:window.rmgStore=Se;case 30:case"end":return e.stop()}}),e,null,[[0,8],[15,22]])})))).then((function(){l.render(Object(I.jsx)(x.Provider,{store:Se,children:Object(I.jsx)(ue,{})}),document.getElementById("root"))}))}],[[34,93,94]]]);
//# sourceMappingURL=main.50f701d0.chunk.js.map