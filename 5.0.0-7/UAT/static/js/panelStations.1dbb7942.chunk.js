"use strict";(self.webpackChunkrail_map_generator=self.webpackChunkrail_map_generator||[]).push([[7090],{8008:function(n,e,r){r.r(e),r.d(e,{default:function(){return hn}});var t=r(885),i=r(2791),s=r(8596),c=r(2288),a=r(1288),o=r(9526),l=r(2067),d=r(7447),h=r(8096),u=r(8302),p=r(159),f=r(4212),m=r(7025),x=r(9418),Z=r(8048),j=r(1859),g=r(2020),b=r(6169),v=r(713),C=r(533),y=r(184),w=(0,s.Z)((function(n){return(0,c.Z)({listItemNum:{marginRight:n.spacing(1),fontSize:"1.2rem"},listItemText:{display:"flex",alignItems:"baseline",whiteSpace:"nowrap",overflow:"hidden","& .MuiListItemText-primary":{marginRight:n.spacing(1)}},selectedItem:{background:n.palette.action.hover}})})),k=function(n){var e=(0,b.CG)((function(n){return n.helper.tpo}));return(0,y.jsx)(o.Z,{children:(0,y.jsx)(l.Z,{dense:!0,disablePadding:!0,children:e.map((function(e){return(0,y.jsxs)(i.Fragment,{children:[(0,y.jsx)(S,{stnId:e,isSelected:e===n.selectedId,onAction:n.onAction(e)}),(0,y.jsx)(d.Z,{})]},e)}))})})},S=function(n){var e=n.stnId,r=n.isSelected,s=n.onAction,c=(0,g.$)().t,a=w(),o=(0,b.TL)(),l=(0,b.CG)((function(n){return n.param.style})),d=(0,b.CG)((function(n){return n.param.stn_list[e]})),k=(null===d||void 0===d?void 0:d.name)||["",""],S=(null===d||void 0===d?void 0:d.num)||"00",I=(0,i.useState)(null),_=(0,t.Z)(I,2),E=_[0],N=_[1],M=function(n){return function(){s(n),N(null)}};return(0,y.jsxs)(h.Z,{className:r?a.selectedItem:"",children:[l===v.RM.GZMTR&&(0,y.jsx)(u.Z,{className:a.listItemNum,children:S}),(0,y.jsx)(p.Z,{primary:k[0],secondary:k[1].replace("\\"," "),className:a.listItemText}),(0,y.jsxs)(f.Z,{children:[(0,y.jsx)(m.Z,{size:"small",onClick:function(n){return N(n.currentTarget)},children:(0,y.jsx)(x.Z,{children:"more_vert"})}),(0,y.jsxs)(Z.Z,{anchorEl:E,open:Boolean(E),onClose:function(){return N(null)},children:[(0,y.jsx)(j.Z,{onClick:function(){o((0,C.lS)(e)),N(null)},children:c("stations.current")}),(0,y.jsx)(j.Z,{onClick:M("edit"),children:c("stations.edit.button")}),(0,y.jsx)(j.Z,{onClick:M("remove"),children:c("stations.remove.button")})]})]})]})},I=r(3594),_=r(5159),E=r(4026),N=r(1969),M=r(9403),T=r(269),G=r(6513),L=r(7253),O=r(8222),A=r(4942),F=r(1413),R=function(){return Math.floor(Math.random()*Math.pow(36,4)).toString(36).padStart(4,"0")},$=(0,s.Z)((function(){return(0,c.Z)({dialogContent:{padding:8},select:{width:166,marginLeft:8}})})),z=i.memo((function(n){var e=(0,g.$)().t,r=$(),s=(0,b.TL)(),c=(0,b.CG)((function(n){return n.param.style})),a=(0,b.CG)((function(n){return n.param.stn_list})),o=(0,b.CG)((function(n){return n.helper})).tpo,u={centre:e("stations.add.centre"),upper:e("stations.add.upper"),lower:e("stations.add.lower"),newupper:e("stations.add.newUpper"),newlower:e("stations.add.newLower")},f=i.useState("before"),m=(0,t.Z)(f,2),Z=m[0],j=m[1],w=i.useState(o[0]),k=(0,t.Z)(w,2),S=k[0],z=k[1],B=i.useState(Object.keys(u)[0]),H=(0,t.Z)(B,2),P=H[0],K=H[1],U=i.useState(Array(5).fill(!0)),J=(0,t.Z)(U,2),D=J[0],V=J[1],W=i.useState(""),q=(0,t.Z)(W,2),Q=q[0],X=q[1],Y=i.useState([]),nn=(0,t.Z)(Y,2),en=nn[0],rn=nn[1],tn=(0,i.useMemo)((function(){return function(n,e,r){switch(r[e]?r[e]["before"===n?"parents":"children"].length:0){case 2:return[1,1,1,[],[]];case 1:var t=(0,O.o)(e,r);if(0===t){var i=function(n,e,r){var t=[];if("before"===n){for(;1===r[e].parents.length;)e=r[e].parents[0],t.unshift(e);t.pop()}else{for(;1===r[e].children.length;)e=r[e].children[0],t.push(e);t.shift()}return t}(n,e,r);return[1,0,0,i=i.length?i:[],i]}return t<0?"before"===n?[r[r[e].parents[0]].children.length-1,0,1,[],[]]:[r[r[e].children[0]].parents.length-1,0,1,[],[]]:"before"===n?[r[r[e].parents[0]].children.length-1,1,0,[],[]]:[r[r[e].children[0]].parents.length-1,1,0,[],[]]}return[0,0,0,[],[]]}(Z,S,a)}),[Z,S,a]);(0,i.useEffect)((function(){V(tn.map((function(n){return"number"===typeof n?Boolean(n):Boolean(n.length)}))),rn(tn[3])}),[tn.toString()]),(0,i.useEffect)((function(){return K(Object.keys(u)[D.indexOf(!0)])}),[D]),(0,i.useEffect)((function(){0!==en.length&&X(en[0])}),[en]),(0,i.useEffect)((function(){S in a||z(o[0])}),[Object.keys(a).toString()]);var sn=function(e){if("close"===e)n.onClose("close");else{var r=s(function(n,e,r,t){return function(i,s){for(var c=s().param.stn_list,a=R();Object.keys(c).includes(a);)a=R();var o={name:["\u672a\u547d\u540d "+a,"Unnamed "+a],secondaryName:!1,num:"00",services:[v.K9.local],parents:[],children:[],branch:{left:[],right:[]},transfer:{info:[[]],tick_direc:v.wA.right,paid_area:!0,osi_names:[]},facility:v.mV.none,loop_pivot:!1},l=JSON.parse(JSON.stringify(c));return"before"===n?"centre"===r?(o.parents=c[e].parents,0===c[e].parents.length&&0!==(0,O.o)(e,c)?o.children=c.linestart.children:0!==(0,O.o)(e,c)?(o.children=c[c[e].parents[0]].children.slice(),o.branch.right=c[o.parents[0]].branch.right,l[o.parents[0]].branch.right=[]):(o.children=[e],o.branch.left=c[e].branch.left,l[e].branch.left=[]),o.parents.forEach((function(n){l[n].children=[a]})),o.children.forEach((function(n){l[n].parents=[a]}))):"upper"===r?2===c[e].parents.length?(c[e].branch.left[1]===c[e].parents[0]&&(l[e].branch.left[1]=a),o.parents=c[e].parents.slice(0,1),o.children=[e],o.parents.forEach((function(n){l[n].children=[a]})),l[e].parents[0]=a):(o.parents=c[e].parents,o.children=[e],o.parents.forEach((function(n){l[n].children[0]=a,c[n].branch.right[1]===e&&(l[n].branch.right[1]=a)})),o.children.forEach((function(n){l[n].parents=[a]}))):"lower"===r?2===c[e].parents.length?(c[e].branch.left[1]===c[e].parents[1]&&(l[e].branch.left[1]=a),o.parents=c[e].parents.slice(1),o.children=[e],o.parents.forEach((function(n){l[n].children=[a]})),l[e].parents[1]=a):(o.parents=c[e].parents,o.children=[e],o.parents.forEach((function(n){var r=c[n].children.length;l[n].children[r-1]=a,c[n].branch.right[1]===e&&(l[n].branch.right[1]=a)})),o.children.forEach((function(n){l[n].parents=[a]}))):(l[e].branch.left=[v.H_.through,a],l[t].branch.right=[v.H_.through,a],o.parents=[t],o.children=[e],"newupper"===r?(l[t].children.unshift(a),l[e].parents.unshift(a)):(l[t].children.push(a),l[e].parents.push(a))):"centre"===r?(o.children=c[e].children,0===c[e].children.length&&0!==(0,O.o)(e,c)?o.parents=c.lineend.parents:0!==(0,O.o)(e,c)?(o.parents=c[c[e].children[0]].parents,o.branch.left=c[o.children[0]].branch.left,l[o.children[0]].branch.left=[]):(o.parents=[e],o.branch.right=c[e].branch.right,l[e].branch.right=[]),o.children.forEach((function(n){l[n].parents=[a]})),o.parents.forEach((function(n){l[n].children=[a]}))):"upper"===r?2===c[e].children.length?(c[e].branch.right[1]===c[e].children[0]&&(l[e].branch.right[1]=a),o.children=c[e].children.slice(0,1),o.parents=[e],o.children.forEach((function(n){l[n].parents=[a]})),l[e].children[0]=a):(o.children=c[e].children,o.parents=[e],o.children.forEach((function(n){l[n].parents[0]=a,c[n].branch.left[1]===e&&(l[n].branch.left[1]=a)})),o.parents.forEach((function(n){l[n].children=[a]}))):"lower"===r?2===c[e].children.length?(c[e].branch.right[1]===c[e].children[1]&&(l[e].branch.right[1]=a),o.children=c[e].children.slice(1),o.parents=[e],o.children.forEach((function(n){l[n].parents=[a]})),l[e].children[1]=a):(o.children=c[e].children,o.parents=[e],o.children.forEach((function(n){l[n].parents[1===c[n].parents.length?0:1]=a,c[n].branch.left[1]===e&&(l[n].branch.left[1]=a)})),o.parents.forEach((function(n){l[n].children=[a]}))):(l[e].branch.right=[v.H_.through,a],l[t].branch.left=[v.H_.through,a],o.children=[t],o.parents=[e],"newupper"===r?(l[t].parents.unshift(a),l[e].children.unshift(a)):(l[t].parents.push(a),l[e].children.push(a))),i((0,C.BI)((0,F.Z)((0,F.Z)({},l),{},(0,A.Z)({},a,o)))),a}}(Z,S,P,Q));n.onClose(r)}};return(0,y.jsxs)(I.Z,{open:n.open,onClose:function(){return sn("close")},children:[(0,y.jsx)(_.Z,{children:e("stations.add.title")}),(0,y.jsx)(E.Z,{className:r.dialogContent,children:(0,y.jsxs)(l.Z,{component:"div",disablePadding:!0,children:[(0,y.jsxs)(h.Z,{children:[(0,y.jsx)(N.Z,{children:(0,y.jsx)(x.Z,{children:"control_camera"})}),(0,y.jsx)(p.Z,{primary:e("stations.add.prep")}),(0,y.jsx)(M.Z,{native:!0,onChange:function(n){return j(n.target.value)},value:Z,className:r.select,children:["before","after"].map((function(n){return(0,y.jsx)("option",{value:n,children:e("stations.add."+n)},n)}))})]}),(0,y.jsx)(d.Z,{variant:"middle"}),(0,y.jsxs)(h.Z,{children:[(0,y.jsx)(N.Z,{children:(0,y.jsx)(x.Z,{children:"near_me"})}),(0,y.jsx)(p.Z,{primary:e("stations.add.pivot")}),(0,y.jsx)(M.Z,{native:!0,onChange:function(n){return z(n.target.value)},value:S,className:r.select,children:o.map((function(n){return(0,y.jsx)("option",{value:n,children:(0,L.Kd)(a[n],c)},n)}))})]}),(0,y.jsx)(d.Z,{variant:"middle"}),(0,y.jsxs)(h.Z,{children:[(0,y.jsx)(N.Z,{children:(0,y.jsx)(x.Z,{children:"share"})}),(0,y.jsx)(p.Z,{primary:e("stations.add.loc")}),(0,y.jsx)(M.Z,{native:!0,onChange:function(n){return K(n.target.value)},value:P,className:r.select,children:Object.keys(u).map((function(n,e){return(0,y.jsx)("option",{value:n,disabled:!D[e],children:u[n]},n)}))})]}),(0,y.jsx)(d.Z,{variant:"middle",style:{display:["newupper","newlower"].includes(P)?"flex":"none"}}),(0,y.jsxs)(h.Z,{style:{display:["newupper","newlower"].includes(P)?"flex":"none"},children:[(0,y.jsx)(N.Z,{children:(0,y.jsx)(x.Z,{children:"undo"})}),(0,y.jsx)(p.Z,{primary:e("stations.add.end")}),(0,y.jsx)(M.Z,{native:!0,onChange:function(n){return X(n.target.value)},value:Q,className:r.select,children:en.map((function(n){return(0,y.jsx)("option",{value:n,children:(0,L.Kd)(a[n],c)},n)}))})]})]})}),(0,y.jsxs)(T.Z,{children:[(0,y.jsx)(G.Z,{onClick:function(){return sn("close")},color:"primary",children:e("dialog.cancel")}),(0,y.jsx)(G.Z,{onClick:function(){return sn("accept")},color:"primary",autoFocus:!0,children:e("dialog.ok")})]})]})}),(function(n,e){return n.open===e.open})),B=r(8192),H=r(1370),P=r(5720),K=r(3364),U=r(8154),J=i.lazy((function(){return Promise.all([r.e(9038),r.e(2996)]).then(r.bind(r,4266))})),D=i.lazy((function(){return Promise.all([r.e(9038),r.e(7805),r.e(4462)]).then(r.bind(r,8225))})),V=i.lazy((function(){return r.e(9063).then(r.bind(r,6987))})),W=i.lazy((function(){return r.e(5060).then(r.bind(r,7061))})),q=(0,s.Z)((function(){return(0,c.Z)({tab:{padding:"6px 24px",height:48,minWidth:"calc(100% / 4)","& .MuiTab-wrapper":{flexDirection:"row"},"&.MuiTab-labelIcon":{minHeight:"unset","& .MuiTab-wrapper":{"& > *:first-child":{marginBottom:0},"& > *:not(first-child)":{paddingLeft:8}}}}})}));var Q=function(n){var e=(0,g.$)().t,r=(0,K.Z)(),t=(0,U.Z)(r.breakpoints.down("xs"));return(0,U.Z)(r.breakpoints.down("sm"))?(0,y.jsxs)(I.Z,{onClose:n.onClose,open:n.open,fullScreen:t,children:[(0,y.jsx)(_.Z,{children:e("stations.edit.title")}),(0,y.jsx)(E.Z,{dividers:!0,style:{padding:"0 16px"},children:n.children}),(0,y.jsx)(T.Z,{children:(0,y.jsx)(G.Z,{onClick:n.onClose,color:"primary",children:e("dialog.done")})})]}):(0,y.jsx)(o.Z,{children:n.children})},X=function(n){var e=(0,g.$)().t,r=i.useState(0),s=(0,t.Z)(r,2),c=s[0],a=s[1],o=q(),l=i.useMemo((function(){return(0,y.jsx)(B.Z,{value:c,indicatorColor:"primary",textColor:"primary",onChange:function(n,e){return a(e)},variant:"scrollable",scrollButtons:"off",children:[["name","title"],["interchange","transfer_within_a_station"],["branch","share"],["more","more_horiz"]].map((function(n,r){return(0,y.jsx)(H.Z,{label:(0,y.jsx)("span",{children:e("stations.edit.tab."+n[0])}),icon:(0,y.jsx)(x.Z,{children:n[1]}),className:o.tab},r)}))})}),[c,o.tab]);return(0,y.jsxs)(Q,(0,F.Z)((0,F.Z)({},n),{},{children:[l,(0,y.jsx)(u.Z,{component:"div",role:"tabpanel",children:(0,y.jsx)(i.Suspense,{fallback:(0,y.jsx)(P.Z,{}),children:function(e){switch(e){case 0:return(0,y.jsx)(J,{stnId:n.stnId});case 1:return(0,y.jsx)(D,{stnId:n.stnId});case 2:return(0,y.jsx)(V,{stnId:n.stnId});case 3:return(0,y.jsx)(W,{stnId:n.stnId})}}(c)})})]}))},Y=r(606),nn=r(6068),en=r(6455);function rn(n){var e,r=n.stnId,s=n.open,c=n.onClose,a=(0,g.$)().t,o=(0,b.TL)(),l=(0,b.CG)((function(n){return n.param.stn_list})),d=(0,b.CG)((function(n){return n.param.current_stn_idx})),h=(0,i.useState)(!1),u=(0,t.Z)(h,2),p=u[0],f=u[1],m=function(n){return function(){if("accept"===n)if((0,en.l)(r,l)){if(o((0,en.d)(r)),d===r){var e=Object.keys(l).filter((function(n){return!["linestart","lineend"].includes(n)}))[0];o((0,C.lS)(e))}}else f(!0);c()}};return(0,y.jsxs)(y.Fragment,{children:[(0,y.jsxs)(I.Z,{open:s,onClose:m("close"),children:[(0,y.jsx)(_.Z,{children:a("stations.remove.title")}),(0,y.jsx)(E.Z,{children:(0,y.jsx)(nn.Z,{children:(0,y.jsx)(Y.c,{i18nKey:"stations.remove.msg",children:{name:null===(e=l[n.stnId])||void 0===e?void 0:e.name.join()}})})}),(0,y.jsxs)(T.Z,{children:[(0,y.jsx)(G.Z,{onClick:m("close"),color:"primary",autoFocus:!0,children:a("dialog.cancel")}),(0,y.jsx)(G.Z,{onClick:m("accept"),color:"primary",children:a("stations.remove.button")})]})]}),(0,y.jsx)(tn,{open:p,onClose:function(){return f(!1)}})]})}var tn=(0,i.memo)((function(n){var e=(0,g.$)().t;return(0,y.jsxs)(I.Z,{open:n.open,onClose:n.onClose,children:[(0,y.jsx)(_.Z,{children:e("stations.remove.error.title")}),(0,y.jsx)(E.Z,{children:(0,y.jsx)(nn.Z,{children:e("stations.remove.error.msg")})}),(0,y.jsx)(T.Z,{children:(0,y.jsx)(G.Z,{onClick:n.onClose,color:"primary",autoFocus:!0,children:e("dialog.ok")})})]})}),(function(n,e){return n.open===e.open})),sn=r(2734),cn=r(8826),an=(0,s.Z)((function(n){return(0,c.Z)({fab:{position:"fixed",right:n.spacing(2),bottom:n.spacing(2)}})})),on=i.memo((function(n){var e=(0,g.$)().t,r=(0,b.CG)((function(n){return n.param.style})),s=an(),c=i.useState(null),a=(0,t.Z)(c,2),o=a[0],l=a[1],d=function(e){return function(){l(null),n.onAction(e)}};return(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)(sn.ZP,{title:e("stations.fabs.tooltip")||"","aria-label":"options",children:(0,y.jsx)(cn.Z,{color:"primary",className:s.fab,onClick:function(n){return l(n.target)},children:(0,y.jsx)(x.Z,{children:"more_vert"})})}),(0,y.jsxs)(Z.Z,{anchorEl:o,open:Boolean(o),onClose:function(){return l(null)},children:[(0,y.jsxs)(j.Z,{onClick:d("add"),children:[(0,y.jsx)(N.Z,{children:(0,y.jsx)(x.Z,{children:"add_box"})}),(0,y.jsx)(p.Z,{primary:e("stations.fabs.add")})]}),(0,y.jsxs)(j.Z,{onClick:d("reverse"),children:[(0,y.jsx)(N.Z,{children:(0,y.jsx)(x.Z,{children:"cached"})}),(0,y.jsx)(p.Z,{primary:e("stations.fabs.reverse")})]}),r===v.RM.GZMTR&&(0,y.jsxs)(j.Z,{onClick:d("autonum"),children:[(0,y.jsx)(N.Z,{children:(0,y.jsx)(x.Z,{children:"filter_1"})}),(0,y.jsx)(p.Z,{primary:e("design.autoNum.button")})]})]})]})}),(function(){return!0})),ln=function(n){var e=(0,g.$)().t,r=(0,b.TL)(),t=(0,b.CG)((function(n){return n.helper})).branches,s=function(e){var i=t[0];i.forEach((function(n,t){var s;s="ascend"===e?t.toString().padStart(2,"0"):(i.length-1-t).toString().padStart(2,"0"),r((0,C.Uf)(n,s))})),n.onClose()};return i.useMemo((function(){return(0,y.jsxs)(I.Z,{onClose:n.onClose,open:n.open,children:[(0,y.jsx)(_.Z,{children:e("design.autoNum.title")}),(0,y.jsx)(E.Z,{children:(0,y.jsx)(nn.Z,{children:e("design.autoNum.msg")})}),(0,y.jsxs)(T.Z,{children:[(0,y.jsx)(G.Z,{onClick:n.onClose,color:"primary",autoFocus:!0,children:e("dialog.cancel")}),(0,y.jsx)(G.Z,{onClick:function(){return s("ascend")},color:"primary",children:e("design.autoNum.ascend")}),(0,y.jsx)(G.Z,{onClick:function(){return s("descend")},color:"primary",children:e("design.autoNum.descend")})]})]})}),[n.open])},dn=(0,s.Z)((function(){return(0,c.Z)({gridContainer:{height:"100%",overflow:"hidden"},gridItem:{height:"100%",overflow:"auto"}})})),hn=function(){var n=dn(),e=(0,b.TL)(),r=(0,b.CG)((function(n){return n.param.style})),s=(0,i.useState)(""),c=(0,t.Z)(s,2),o=c[0],l=c[1],d=(0,i.useState)(!1),h=(0,t.Z)(d,2),u=h[0],p=h[1],f=(0,i.useState)(!1),m=(0,t.Z)(f,2),x=m[0],Z=m[1],j=(0,i.useState)(!1),g=(0,t.Z)(j,2),w=g[0],S=g[1],I=(0,i.useState)(""),_=(0,t.Z)(I,2),E=_[0],N=_[1],M=(0,i.useState)(!1),T=(0,t.Z)(M,2),G=T[0],L=T[1];return(0,y.jsxs)(y.Fragment,{children:[(0,y.jsxs)(a.Z,{container:!0,spacing:1,className:n.gridContainer,children:[(0,y.jsx)(a.Z,{item:!0,xs:12,md:4,className:n.gridItem,children:(0,y.jsx)(k,{selectedId:o,onAction:function(n){return function(e){"edit"===e&&(l(n),p(!0)),"remove"===e&&(o===n&&l(""),N(n),L(!0))}}})}),(0,y.jsx)(a.Z,{item:!0,xs:8,className:n.gridItem,children:o&&(0,y.jsx)(X,{open:u,stnId:o,onClose:function(){return p(!1)}})})]}),(0,y.jsx)(on,{onAction:function(n){"add"===n&&Z(!0),"reverse"===n&&e((0,C.iI)()),"autonum"===n&&S(!0)}}),(0,y.jsx)(z,{open:x,onClose:function(n){Z(!1),"close"!==n&&(l(n),p(!0))}}),(0,y.jsx)(rn,{open:G,onClose:function(){return L(!1)},stnId:E}),r===v.RM.GZMTR&&(0,y.jsx)(ln,{open:w,onClose:function(){return S(!1)}})]})}}}]);
//# sourceMappingURL=panelStations.1dbb7942.chunk.js.map