(this["webpackJsonprail-map-generator"]=this["webpackJsonprail-map-generator"]||[]).push([[93],{137:function(t,e,n){"use strict";n.r(e);var c=n(11),r=n(37),a=n(1),i=n(5),s=n(12),o=n(4),u=n.n(o),l=n(24),j=n(76),h=n(77),f=n(2),d=n(0),m=Object(o.memo)((function(t){return Object(d.jsxs)("g",{textAnchor:"middle",fill:-1===t.stnState?f.h.white:t.info[3],children:[Object(d.jsx)("use",{xlinkHref:"#intbox",fill:-1===t.stnState?"#aaa":t.info[2]}),t.info[4][0]===t.info[5][0]?Object(d.jsx)(b,{name:t.info.slice(-2)}):Object(d.jsx)(O,{name:t.info.slice(-2)})]})}),(function(t,e){return t.info.toString()===e.info.toString()&&t.stnState===e.stnState})),O=Object(o.memo)((function(t){var e,n=[],r=0;null===(e=t.name[0].match(/\d+|\D+/g))||void 0===e||e.forEach((function(t,e){isNaN(Number(t))?(n.push(Object(d.jsx)("tspan",{dominantBaseline:"hanging",dy:1-r,children:t},e)),r+=1-r):(n.push(Object(d.jsx)("tspan",{dominantBaseline:"hanging",fontSize:16,dy:-r,children:t},e)),r=0)}));var a=Object(o.useRef)(null),i=Object(o.useState)({width:0}),s=Object(c.a)(i,2),u=s[0],l=s[1];Object(o.useEffect)((function(){return l(a.current.getBBox())}),[t.name[0]]);var j=u.width>43.5?43.5/u.width:1,h=Object(o.useRef)(null),f=Object(o.useState)({width:0}),m=Object(c.a)(f,2),O=m[0],b=m[1];Object(o.useEffect)((function(){return b(h.current.getBBox())}),[t.name[1]]);var g=O.width>43.5?43.5/O.width:1;return Object(d.jsxs)(d.Fragment,{children:[Object(d.jsx)("text",{ref:a,y:navigator.userAgent.includes("Firefox")?-.5:2,className:"rmg-name__zh",fontSize:12,transform:"scale(".concat(j,",1)"),children:n}),Object(d.jsx)("text",{ref:h,y:19.5,fontSize:t.name[1].replace("\\"," ").length>10?7:8,className:"rmg-name__en",transform:"scale(".concat(g,",1)"),children:t.name[1]})]})}),(function(t,e){return t.name.toString()===e.name.toString()})),b=Object(o.memo)((function(t){var e="";for(var n in Object(s.a)(t.name[0])){if(t.name[0][n]!==t.name[1][n])break;e+=t.name[0][n]}var r=Object(o.useRef)(null),a=Object(o.useState)({x:0,width:0}),i=Object(c.a)(a,2),u=i[0],l=i[1];Object(o.useEffect)((function(){return l(r.current.getBBox())}),[t.name.toString()]);var j=u.width>43.5?43.5/u.width:1;return Object(d.jsx)("g",{transform:"scale(".concat(j,",1)"),children:Object(d.jsx)("g",{transform:"translate(".concat(-u.x-u.width/2,",0)"),children:Object(d.jsxs)("text",{ref:r,className:"rmg-name__zh",fontSize:14,y:12,textAnchor:"end",children:[e,Object(d.jsx)("tspan",{className:"rmg-name__zh",fontSize:8,x:0,dy:-2,textAnchor:"start",children:t.name[0].slice(e.length)}),Object(d.jsx)("tspan",{className:"rmg-name__en",fontSize:4,x:0,dy:6,textAnchor:"start",children:t.name[1].slice(e.length).trim()})]})})})}),(function(t,e){return t.name.toString()===e.name.toString()})),g=n(7),x=["intInfos","stnState","tickRotation"],p=["intInfos","tickRotation","stnState"],v=function(t){var e=t.stnId,n=t.stnState,c=t.stnY,r=Object(g.c)((function(t){return t.param.theme})),a=Object(g.c)((function(t){return t.param.line_name})),i=Object(g.c)((function(t){return t.param.line_num})),o=Object(g.c)((function(t){return t.param.stn_list[e]})),u=2===o.parents.length||2===o.children.length,l=c>0||1===o.parents.indexOf(o.branch.left[1]||"")||1===o.children.indexOf(o.branch.right[1]||"")?180:0,j=o.name[1].split("\\").length,m=u?180===l?16+12*(j-1)*Math.cos(-45):-9:180===l?-6:(25+15*(j-1))*Math.cos(-45);return Object(d.jsxs)(d.Fragment,{children:[Object(d.jsx)(w,{intInfos:u?[[r[0],r[1],"var(--rmg-theme-colour)","var(--rmg-theme-fg)"].concat(Object(s.a)(a))].concat(o.transfer.info[0]):o.transfer.info[0],stnState:n,tickRotation:l}),Object(d.jsxs)("g",{children:[Object(d.jsx)("use",{xlinkHref:"#stn",stroke:-1===n?"#aaa":"var(--rmg-theme-colour)"}),Object(d.jsx)(h.a,{className:"Name ".concat(-1===n?"Pass":"Future"),lineNum:i,stnNum:o.num})]}),Object(d.jsx)("g",{transform:"translate(".concat(-m,",0)"),children:Object(d.jsx)(y,{name:o.name,secondaryName:o.secondaryName,stnState:n,tickRotation:l,isExpress:o.services.includes(f.l.express)})})]})},y=function(t){var e=180===t.tickRotation?17.5:-20-14*t.name[1].split("\\").length*Math.cos(-45),n=Object(o.useRef)(null),r=Object(o.useState)({width:0}),a=Object(c.a)(r,2),i=a[0],s=a[1];Object(o.useEffect)((function(){return s(n.current.getBBox())}),[t.name.toString()]);var u=Object(o.useRef)(null),l=Object(o.useState)({x:0,width:-20}),j=Object(c.a)(l,2),h=j[0],f=j[1];return Object(o.useEffect)((function(){u.current?f(u.current.getBBox()):f((function(t){return{x:t.x,width:-20}}))}),[t.secondaryName.toString()]),Object(d.jsxs)("g",{textAnchor:180===t.tickRotation?"end":"start",className:"Name ".concat(-1===t.stnState?"Pass":0===t.stnState?"CurrentGZ":"Future"),transform:"translate(0,".concat(e,")rotate(-45)"),children:[Object(d.jsx)(S,{ref:n,name:t.name}),t.secondaryName&&Object(d.jsxs)("g",{transform:"translate(".concat((i.width+h.width/2+10)*(180===t.tickRotation?-1:1),",").concat(2+5*(t.name[1].split("\\").length-1),")"),className:"Name ".concat(-1===t.stnState?"Pass":"Future"),children:[Object(d.jsxs)("g",{transform:"translate(0,3)",fontSize:18,children:[Object(d.jsx)("text",{textAnchor:"end",x:h.x-3,className:"rmg-name__zh",children:"("}),Object(d.jsx)("text",{textAnchor:"start",x:h.width+h.x+3,className:"rmg-name__zh",children:")"})]}),Object(d.jsx)(_,{ref:u,secName:t.secondaryName})]}),t.isExpress&&Object(d.jsx)(z,{fill:-1===t.stnState?"#aaa":"var(--rmg-theme-colour)",transform:"translate(".concat((i.width+h.width+20+35)*(180===t.tickRotation?-1:1),",").concat(2+5*(t.name[1].split("\\").length-1),")")})]})},S=Object(o.forwardRef)((function(t,e){return Object(o.useMemo)((function(){return Object(d.jsxs)("g",{ref:e,children:[Object(d.jsx)("text",{className:"rmg-name__zh",fontSize:18,children:t.name[0]}),Object(d.jsx)("g",{fontSize:10.5,children:t.name[1].split("\\").map((function(t,e){return Object(d.jsx)("text",{className:"rmg-name__en",dy:16+11*e,children:t},e)}))})]})}),[t.name[0],t.name[1]])})),_=Object(o.forwardRef)((function(t,e){return Object(o.useMemo)((function(){return Object(d.jsxs)("g",{ref:e,textAnchor:"middle",children:[Object(d.jsx)("text",{className:"rmg-name__zh",fontSize:13,children:t.secName[0]}),Object(d.jsx)("text",{dy:10,className:"rmg-name__en",fontSize:6.5,children:t.secName[1]})]})}),[t.secName.toString()])})),z=u.a.memo((function(t){return Object(d.jsxs)("g",Object(a.a)(Object(a.a)({textAnchor:"middle"},t),{},{children:[Object(d.jsx)("text",{className:"rmg-name__zh",fontSize:13,children:"\u5feb\u8f66\u505c\u9760\u7ad9"}),Object(d.jsx)("text",{dy:10,className:"rmg-name__en",fontSize:6.5,children:"Express Station"})]}))})),w=function(t){return Object(d.jsxs)(d.Fragment,{children:[Object(d.jsx)(N,Object(a.a)({strokeWidth:4},t)),Object(d.jsx)(k,Object(a.a)({transform:"translate(0,".concat(180===t.tickRotation?-47:23,")")},t))]})},N=function(t){var e=t.intInfos,n=t.stnState,c=t.tickRotation,i=Object(r.a)(t,x);return Object(d.jsx)("g",Object(a.a)(Object(a.a)({},i),{},{children:e.map((function(t,r){return Object(d.jsx)("use",{xlinkHref:"#inttick",stroke:-1===n?"#aaa":t[2],transform:"translate(".concat(-2*(e.length-1)+4*r,",0)rotate(").concat(180===c?180:0,")")},r)}))}))},k=function(t){var e=t.intInfos,n=t.tickRotation,c=t.stnState,i=Object(r.a)(t,p);return Object(d.jsx)("g",Object(a.a)(Object(a.a)({},i),{},{children:e.map((function(t,e){return Object(d.jsx)("g",{transform:"translate(0,".concat(28*e*(180===n?-1:1),")"),children:Object(d.jsx)(m,{info:t,stnState:c})},e)}))}))},M=n(39),R=function(t,e){return 2===t[e].parents.length||2===t[e].children.length?.25:0},P=function(){var t,e=u.a.useContext(l.a),n=e.branches,c=e.routes,r=e.deps,s=Object(g.c)((function(t){return t.param.svgWidth})),j=Object(g.c)((function(t){return t.param.y_pc})),h=Object(g.c)((function(t){return t.param.padding})),O=Object(g.c)((function(t){return t.param.branch_spacing})),b=Object(g.c)((function(t){return t.param.direction})),x=Object(g.c)((function(t){return t.param.line_name})),p=Object(g.c)((function(t){return t.param.current_stn_idx})),v=Object(g.c)((function(t){return t.param.stn_list})),y=Object(M.b)(v,R,R),S=Object(o.useMemo)((function(){return console.log("computing x shares"),Object.keys(v).reduce((function(t,e){return Object(a.a)(Object(a.a)({},t),{},Object(i.a)({},e,function(t,e,n){var c=Object(M.c)("linestart","lineend",e);if(c.nodes.includes(t))return Object(M.c)(c.nodes[1],t,e).len;for(var r=n.filter((function(e){return e.includes(t)}))[0],a=t;!c.nodes.includes(a);)a=r[r.indexOf(a)-1];for(var i=t;!c.nodes.includes(i);)i=r[r.indexOf(i)+1];var s="linestart"===a,o="lineend"===i;if(r.toString()===n[0].toString()){var u=[];return s||o?s?(u[0]=0,u[1]=Object(M.c)(c.nodes[1],i,e).len,u[2]=Object(M.c)(r[1],t,e).len,u[3]=Object(M.c)(t,i,e).len):(u[0]=Object(M.c)(c.nodes[1],a,e).len,u[1]=Object(M.c)(a,c.nodes.slice(-2)[0],e).len,u[2]=Object(M.c)(a,t,e).len,u[3]=Object(M.c)(t,r.slice(-2)[0],e).len):(u[0]=Object(M.c)(c.nodes[1],a,e).len,u[1]=Object(M.c)(a,i,e).len,u[2]=Object(M.c)(a,t,e).len,u[3]=Object(M.c)(t,i,e).len),u[0]+u[2]*u[1]/(u[2]+u[3])}if(s||o)return s?Object(M.c)(c.nodes[1],i,e).len-Object(M.c)(t,i,e).len:Object(M.c)(c.nodes[1],a,e).len+Object(M.c)(a,t,e).len;var l=[];return l[0]=Object(M.c)(c.nodes[1],a,e).len,l[1]=Object(M.c)(a,i,e).len,l[2]=Object(M.c)(a,t,e).len,l[3]=Object(M.c)(t,i,e).len,l[0]+l[2]*l[1]/(l[2]+l[3])}(e,y,n)))}),{})}),[n.toString(),JSON.stringify(y)]),_=Object(M.c)("linestart","lineend",y),z=Object(M.c)(_.nodes[1],_.nodes.slice(-2)[0],y),w=b===f.m.right?[s[f.c.RailMap]*h/100+65,s[f.c.RailMap]*(1-h/100)-20]:[s[f.c.RailMap]*h/100,s[f.c.RailMap]*(1-h/100)-65],N=Object.keys(S).reduce((function(t,e){return Object(a.a)(Object(a.a)({},t),{},Object(i.a)({},e,w[0]+S[e]/z.len*(w[1]-w[0])))}),{}),k=Object(o.useMemo)((function(){return console.log("computing y shares"),Object.keys(v).reduce((function(t,e){if(n[0].includes(e))return Object(a.a)(Object(a.a)({},t),{},Object(i.a)({},e,0));var c=n.slice(1).filter((function(t){return t.includes(e)}))[0];return Object(a.a)(Object(a.a)({},t),{},Object(i.a)({},e,v[c[0]].children.indexOf(c[1])?-2:2))}),{})}),[r]),P=Object.keys(k).reduce((function(t,e){return Object(a.a)(Object(a.a)({},t),{},Object(i.a)({},e,-k[e]*O))}),{}),L=Object(o.useMemo)((function(){return Object(M.e)(p,c,b)}),[p,b,c.toString()]),A=Object(M.d)(n,L),W=Object.keys(A).reduce((function(t,e){return Object(a.a)(Object(a.a)({},t),{},Object(i.a)({},e,A[e].map((function(t){return F(t,N,P)}))))}),{});return Object(d.jsxs)("g",{id:"main",style:(t={},Object(i.a)(t,"--y-percentage",j),Object(i.a)(t,"transform","translateY(calc(var(--y-percentage) * var(--rmg-svg-height) / 100))"),t),children:[Object(d.jsx)(E,{paths:W}),Object(d.jsx)(H,{xs:N,ys:P,stnStates:L}),Object(d.jsx)("g",{id:"line_name",style:Object(i.a)({},"--translate-x",b===f.m.right?"".concat(w[0]-65,"px"):"".concat(w[1]+65,"px")),children:Object(d.jsx)(m,{info:Array(2).concat(["var(--rmg-theme-colour)","var(--rmg-theme-fg)"],x),stnState:1})})]})},E=u.a.memo((function(t){return Object(d.jsxs)("g",{fill:"none",strokeWidth:4,children:[Object(d.jsx)("g",{stroke:"#aaa",strokeDasharray:4,children:t.paths.pass.map((function(t,e){return Object(d.jsx)("path",{d:t},e)}))}),Object(d.jsx)("g",{stroke:"var(--rmg-theme-colour)",children:t.paths.main.map((function(t,e){return Object(d.jsx)("path",{d:t},e)}))})]})}),(function(t,e){return JSON.stringify(t.paths)===JSON.stringify(e.paths)})),F=function(t,e,n){var c,r=[];return t.forEach((function(t){var a=e[t],i=n[t];if(!c&&0!==c)return c=i,void r.push("M ".concat(a,",").concat(i));0===i?(i<c&&r.push("H ".concat(a-40),"a 40,40 0 0,0 40,-40","V ".concat(i)),i>c&&r.push("H ".concat(a-40),"a 40,40 0 0,1 40,40","V ".concat(i))):(i<c&&r.push("V ".concat(i+40),"a 40,40 0 0,1 40,-40","H ".concat(a)),i>c&&r.push("V ".concat(i-40),"a 40,40 0 0,0 40,40","H ".concat(a))),r.push("H ".concat(a)),c=i})),r.join(" ").replace(/( H ([\d.]+))+/g," H $2")},H=function(t){var e=t.xs,n=t.ys,c=t.stnStates,r=Object(g.c)((function(t){return t.param.stn_list}));return Object(d.jsx)("g",{id:"stn_icons",children:Object.keys(r).filter((function(t){return!["linestart","lineend"].includes(t)})).map((function(t){return Object(d.jsx)("g",{style:{transform:"translate(".concat(e[t],"px,").concat(n[t],"px)")},children:Object(d.jsx)(v,{stnId:t,stnState:c[t],stnY:n[t]})},t)}))})},L=["destIds"],A=["destIds"],W=(e.default=function(){var t=Object(g.c)((function(t){return t.param.svgWidth})),e=Object(g.c)((function(t){return t.param.direction})),n=Object(g.c)((function(t){return t.param.psd_num})),c=Object(g.c)((function(t){return t.param.info_panel_type})),r=Object(g.c)((function(t){return t.param.notesGZMTR})),a=Object(g.c)((function(t){return t.param.current_stn_idx})),i=Object(g.c)((function(t){return t.param.stn_list[a]}));return Object(d.jsxs)(d.Fragment,{children:[Object(d.jsx)(W,{}),Object(d.jsx)(j.a,{variant:c,isShowLight:c===f.i.gz2otis,isShowPSD:c===f.i.gz2otis&&n}),e===f.m.left&&i.parents.includes("linestart")||e===f.m.right&&i.children.includes("lineend")?Object(d.jsx)(D,{}):Object(d.jsxs)(d.Fragment,{children:[Object(d.jsx)(P,{}),Object(d.jsx)(B,{}),r.map((function(t,e){return Object(d.jsx)(V,{note:t},e)}))]}),c===f.i.gz2otis&&Object(d.jsx)("line",{x2:t[f.c.RailMap],transform:"translate(0,90)",strokeWidth:3,stroke:"black"})]})},u.a.memo((function(){return Object(d.jsxs)("defs",{children:[Object(d.jsx)("path",{id:"stn",className:"rmg-stn",d:"M 0,9.25 V -9.25 H -9.25 a 9.25,9.25 0 0,0 0,18.5 h 18.5 a 9.25,9.25 0 0,0 0,-18.5 H 0 "}),Object(d.jsx)("path",{id:"stn_pass",stroke:"#aaa",fill:"#fff",strokeWidth:2,d:"M 0,9.25 V -9.25 H -9.25 a 9.25,9.25 0 0,0 0,18.5 h 18.5 a 9.25,9.25 0 0,0 0,-18.5 H 0 "}),Object(d.jsx)("path",{id:"arrow_direction",d:"M 60,60 L 0,0 L 60,-60 H 100 L 55,-15 H 160 V 15 H 55 L 100,60z",fill:"black"}),Object(d.jsx)("path",{id:"inttick",d:"M 0,0 v 18",strokeLinecap:"square"}),Object(d.jsx)("rect",{id:"intbox",x:-22.5,height:24,width:45,rx:4.5})]})}))),B=function(){var t,e=u.a.useContext(l.a).routes,n=Object(g.c)((function(t){return t.param.direction})),c=Object(g.c)((function(t){return t.param.direction_gz_x})),r=Object(g.c)((function(t){return t.param.direction_gz_y})),o=Object(g.c)((function(t){return t.param.current_stn_idx})),j=u.a.useMemo((function(){return Object(s.a)(new Set(e.reduce((function(t,e){return e.includes(o)?t.concat(e.filter((function(t){return!["linestart","lineend"].includes(t)})).slice(n===f.m.left?0:-1)[0]):t}),[]).filter((function(t){return t!==o}))))}),[o,n,e.toString()]),h={textAnchor:n===f.m.left?"start":"end",transform:"translate(".concat(n===f.m.left?65:-65,",-5)"),destIds:j};return Object(d.jsxs)("g",{id:"direction_gz",style:(t={},Object(i.a)(t,"--x-percentage",c),Object(i.a)(t,"--y-percentage",r),t),children:[Object(d.jsx)("use",{xlinkHref:"#arrow_direction",style:Object(i.a)({},"--rotate",n===f.m.left?"0deg":"180deg")}),2!==j.length?Object(d.jsx)(I,Object(a.a)({},h)):Object(d.jsx)(T,Object(a.a)({},h))]})},I=function(t){var e=t.destIds,n=Object(r.a)(t,L),c=Object(g.c)((function(t){return t.param.stn_list}));return Object(d.jsxs)("g",Object(a.a)(Object(a.a)({},n),{},{children:[Object(d.jsx)("text",{className:"rmg-name__zh",fontSize:28,children:e.map((function(t){return c[t].name[0]})).join("/")+"\u65b9\u5411"}),Object(d.jsx)("text",{className:"rmg-name__en",fontSize:14,dy:22,children:"Towards "+e.map((function(t){return c[t].name[1].replace("\\"," ")})).join("/")})]}))},T=function(t){var e=t.destIds,n=Object(r.a)(t,A),c=Object(g.c)((function(t){return t.param.direction})),i=Object(g.c)((function(t){return t.param.stn_list})),o=e.map((function(t){return i[t].name[0].length})),l=Math.min.apply(Math,Object(s.a)(o)),j=l>1&&o[0]!==o[1]?Math.abs(o[0]-o[1])/(l-1):0;return Object(d.jsxs)("g",Object(a.a)(Object(a.a)({},n),{},{children:[e.map((function(t,e){return Object(d.jsxs)(u.a.Fragment,{children:[Object(d.jsx)("text",{className:"rmg-name__zh",fontSize:25,x:c===f.m.left?0:-75,y:42*e-21,letterSpacing:o[e]>o[1-e]?"0em":"".concat(j,"em"),children:i[t].name[0]}),Object(d.jsx)("text",{className:"rmg-name__en",fontSize:11.5,x:c===f.m.left?0:-75,y:42*e-1,children:"Towards "+i[t].name[1].replace("\\"," ")})]},t)})),Object(d.jsx)("text",{className:"rmg-name__zh",fontSize:28,x:c===f.m.left?25*(Math.max.apply(Math,Object(s.a)(o))+1):0,y:5,children:"\u65b9\u5411"})]}))},D=u.a.memo((function(){return Object(d.jsxs)("g",{id:"terminus_gz",textAnchor:"middle",children:[Object(d.jsx)("text",{className:"rmg-name__zh",fontSize:90,children:"\u7ec8 \u70b9 \u7ad9"}),Object(d.jsx)("text",{dy:70,className:"rmg-name__en",fontSize:36,children:"Terminal"}),Object(d.jsxs)("g",{strokeWidth:8,stroke:"#000",children:[Object(d.jsx)("path",{d:"M -160,68 h -160"}),Object(d.jsx)("path",{d:"M 160,68 h 160"})]})]})})),V=u.a.memo((function(t){var e,n=u.a.useRef(null),r=u.a.useState({width:0,height:0,y:0}),a=Object(c.a)(r,2),s=a[0],o=a[1];return u.a.useEffect((function(){return o(n.current.getBBox())}),[t.note[0],t.note[1]]),Object(d.jsxs)("g",{className:"note-box",style:(e={},Object(i.a)(e,"--x-percentage",t.note[2]),Object(i.a)(e,"--y-percentage",t.note[3]),e),children:[t.note[4]&&Object(d.jsx)("rect",{height:s.height+4,width:s.width+4,x:-2,y:s.y-2,fill:"none",stroke:"black",strokeWidth:.5}),Object(d.jsxs)("g",{ref:n,children:[Object(d.jsx)("g",{fontSize:16,letterSpacing:1.2,children:t.note[0].split("\n").map((function(t,e){return Object(d.jsx)("text",{className:"rmg-name__zh",y:18*e,children:t},e)}))}),Object(d.jsx)("g",{fontSize:10,letterSpacing:.33,transform:"translate(0,".concat(18*t.note[0].split("\n").length,")"),children:t.note[1].split("\n").map((function(e,n){var c;return Object(d.jsx)("text",{className:"rmg-name__en",y:11*n,textLength:n<((null===(c=t.note[1].match(/\n/g))||void 0===c?void 0:c.length)||0)?s.width:navigator.userAgent.includes("Firefox")?-1:0,lengthAdjust:"spacing",children:e},n)}))})]})]})}),(function(t,e){return t.note.toString()===e.note.toString()}))},37:function(t,e,n){"use strict";function c(t,e){if(null==t)return{};var n,c,r=function(t,e){if(null==t)return{};var n,c,r={},a=Object.keys(t);for(c=0;c<a.length;c++)n=a[c],e.indexOf(n)>=0||(r[n]=t[n]);return r}(t,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(c=0;c<a.length;c++)n=a[c],e.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(t,n)&&(r[n]=t[n])}return r}n.d(e,"a",(function(){return c}))},38:function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));var c=function t(e,n){if(["linestart","lineend"].includes(e)||n[e].parents.length>1||n[e].children.length>1)return 0;var c=n[e].parents[0];return c?1===n[c].children.length?t(c,n):0===n[c].children.indexOf(e)?1:-1:0}},39:function(t,e,n){"use strict";n.d(e,"b",(function(){return j})),n.d(e,"c",(function(){return h})),n.d(e,"f",(function(){return f})),n.d(e,"e",(function(){return d})),n.d(e,"a",(function(){return m})),n.d(e,"d",(function(){return O}));var c=n(11),r=n(19),a=n(20),i=n(12),s=n(25),o=n(5),u=n(1),l=(n(38),n(2)),j=function(t,e,n){return Object.keys(t).reduce((function(c,r){return Object(u.a)(Object(u.a)({},c),{},Object(o.a)({},r,t[r].children.reduce((function(c,a){return Object(u.a)(Object(u.a)({},c),{},Object(o.a)({},a,1+e(t,a)+n(t,r)))}),{})))}),{})},h=function t(e,n,c){if(e===n)return{len:0,nodes:[e]};var r=[],a=[];Object.keys(c[e]).forEach((function(i){var s=t(i,n,c);s.len<0||(r.push(c[e][i]+s.len),s.nodes.unshift(e),a.push(s.nodes))}));var i=Math.max.apply(Math,r);return{len:i,nodes:a[r.indexOf(i)]}},f=function(t,e,n){var c=h("linestart","lineend",e);if(c.nodes.includes(t))return h(c.nodes[1],t,e).len;for(var r=n.filter((function(e){return e.includes(t)}))[0],a=t;!c.nodes.includes(a);)a=r[r.indexOf(a)-1];for(var i=t;!c.nodes.includes(i);)i=r[r.indexOf(i)+1];var s="linestart"===a,o=[];return s||"lineend"===i?s?(o[0]=0,o[1]=h(c.nodes[1],i,e).len,o[2]=h(r[1],t,e).len,o[3]=h(t,i,e).len):(o[0]=h(c.nodes[1],a,e).len,o[1]=h(a,c.nodes.slice(-2)[0],e).len,o[2]=h(a,t,e).len,o[3]=h(t,r.slice(-2)[0],e).len):(o[0]=h(c.nodes[1],a,e).len,o[1]=h(a,i,e).len,o[2]=h(a,t,e).len,o[3]=h(t,i,e).len),o[0]+o[2]*o[1]/(o[2]+o[3])},d=function(t,e,n){var c;return console.log("computing stations' states"),Object(i.a)(new Set((c=[]).concat.apply(c,Object(i.a)(e)))).reduce((function(c,r){return Object(u.a)(Object(u.a)({},c),{},Object(o.a)({},r,r===t?0:(n===l.m.right?function(t,e,n){var c,r=Object(s.a)(n);try{for(r.s();!(c=r.n()).done;){var a=c.value,i=a.indexOf(t),o=a.indexOf(e);if(-1!==i&&i<o)return!0}}catch(u){r.e(u)}finally{r.f()}return!1}(t,r,e):function(t,e,n){var c,r=Object(s.a)(n);try{for(r.s();!(c=r.n()).done;){var a=c.value,i=a.indexOf(t),o=a.indexOf(e);if(-1!==o&&o<i)return!0}}catch(u){r.e(u)}finally{r.f()}return!1}(t,r,e))?1:-1))}),{})},m=function(){function t(e){var n=this;Object(r.a)(this,t),this.yShares={},this.xShares={},this.namePoss={},this.stnList={},this.criticalPath={},this.leftWideFactor=function(t){return 0},this.rightWideFactor=function(t){return 0},this.pathWeight=function(t,e){return n.stnList[t].children.includes(e)?1+n.rightWideFactor(t)+n.leftWideFactor(e):-1/0},this.pathTurnParams=function(t){var e=35-17.5*Math.sqrt(3),n=t-2*e;return{tr:35,dx_a:17.5,dy_a:e,dx_l:n*Math.sqrt(3),dy_l:n}},this.pathTurnSE=function(t){var e=n.pathTurnParams(t),c=e.tr,r=e.dx_a,a=e.dy_a,i=e.dx_l,s=e.dy_l;return"a ".concat(c,",").concat(c," 0 0,1 ").concat(r,",").concat(a," l ").concat(i,",").concat(s," a ").concat(c,",").concat(c," 0 0,0 ").concat(r,",").concat(a)},this.pathTurnNE=function(t){var e=n.pathTurnParams(t),c=e.tr,r=e.dx_a,a=e.dy_a,i=e.dx_l,s=e.dy_l;return"a ".concat(c,",").concat(c," 0 0,0 ").concat(r,",").concat(-a," l ").concat(i,",").concat(-s," a ").concat(c,",").concat(c," 0 0,1 ").concat(r,",").concat(-a)},this.stnList=e.stnList,this.criticalPath=e.criticalPath}return Object(a.a)(t,[{key:"getYShare",value:function(t,e){if(t in this.yShares)return this.yShares[t];if(["linestart","lineend"].includes(t)||this.stnList[t].parents.length>1||this.stnList[t].children.length>1)return this.yShares[t]=0,0;var n=this.stnList[t].parents[0];if(n){if(1===this.stnList[n].children.length){var c=this.getYShare(n);return this.yShares[t]=c,c}var r=0===this.stnList[n].children.indexOf(t)?1:-1;return this.yShares[t]=r,r}return this.yShares[t]=0,0}},{key:"_linePath",value:function(t,e,n,r,a,i,s,o){var u=this,l=Object(c.a)([],3),j=l[0],h=l[1],f=l[2],d=[],m=this.pathTurnParams(i),O=m.dx_a+m.dx_l/2,b=(e[1]-e[0])/s.len*.8,g=((e[1]-e[0])/s.len-2*O)/2;return g+b<0&&console.warn("SVG width too small! ".concat(g+b)),t.forEach((function(e){var c=r[e],s=a[e];if(!h&&0!==h)return j=e,f=c,h=s,void(1===t.length?d.push("M ".concat(c,",").concat(s)):n[0].includes(e)?n[0].includes(t[1])?d.push("M ".concat(c,",").concat(s)):(r[t[1]]>0&&d.push("M ".concat(c,",").concat(s+o)),a[t[1]]<0&&d.push("M ".concat(c,",").concat(s-o))):d.push("M ".concat(c,",").concat(s)));s>h?(d.push("h ".concat(0===s?c-f-b*u.leftWideFactor(e)-g-2*O:b*u.rightWideFactor(j)+g)),d.push(u.pathTurnSE(i))):s<h&&(d.push("h ".concat(0===s?c-f-b*u.leftWideFactor(e)-g-2*O:b*u.rightWideFactor(j)+g)),d.push(u.pathTurnNE(i))),d.push("H ".concat(c)),j=e,f=c,h=s})),d.join(" ").replace(/( H ([\d.]+))+/g," H $2")}}],[{key:"getYShares",value:function(t,e){console.log("computing y shares");var n=new this({stnList:t});return Object.keys(t).forEach((function(t){["linestart","lineend"].includes(t)||t in n.yShares||n.getYShare(t,e)})),n.yShares}},{key:"drawLine",value:function(t,e,n,c,r,a,i,s){var o=this,u=arguments.length>8&&void 0!==arguments[8]?arguments[8]:9.68,l={main:[],pass:[]};return t.forEach((function(j,h){var f=(j=j.filter((function(t){return!["linestart","lineend"].includes(t)}))).filter((function(t){return e[t]>=0})),d=j.filter((function(t){return e[t]<=0}));1===f.length&&(d=j),0===f.filter((function(t){return-1!==d.indexOf(t)})).length&&f.length&&(d[0]===j[0]?d.push(f[0]):f[0]===j[0]&&f[f.length-1]===j[j.length-1]&&d.length?(d=j,f=[]):d.unshift(f[f.length-1])),l.main.push(new o({stnList:n,criticalPath:s})._linePath(f,c,t,r,a,i,s,u)),l.pass.push(new o({stnList:n,criticalPath:s})._linePath(d,c,t,r,a,i,s,u))})),l}}]),t}(),O=function(t,e){var n={main:[],pass:[]};return t.forEach((function(t){var c=(t=t.filter((function(t){return!["linestart","lineend"].includes(t)}))).filter((function(t){return e[t]>=0})),r=t.filter((function(t){return e[t]<=0}));1===c.length&&(r=t),0===c.filter((function(t){return-1!==r.indexOf(t)})).length&&c.length&&(r[0]===t[0]?r.push(c[0]):c[0]===t[0]&&c[c.length-1]===t[t.length-1]&&r.length?(r=t,c=[]):r.unshift(c[c.length-1])),n.main.push(c),n.pass.push(r)})),n}},76:function(t,e,n){"use strict";var c=n(1),r=n(5),a=n(4),i=n.n(a),s=n(2),o=n(0);e.a=function(t){var e=function(t){switch(t){case"gz28":case"gz2otis":case"gz6":case"gzgf":return 60;case"gz1":case"gz3":return 40;case"gz4":case"gz5":case"gz1421":return 20;default:return 0}}(t.variant),n=i.a.useMemo((function(){switch(t.variant){case"gz1":return Object(o.jsx)("circle",{cy:-58,r:16,fill:"red"});case"gz28":case"gz2otis":return Object(o.jsx)("ellipse",{cy:-30,rx:24,ry:12,fill:"orange"});case"gz3":return Object(o.jsx)("rect",{x:-15,y:-55,height:30,width:30,fill:"red"});case"gz6":return Object(o.jsx)("ellipse",{cy:-30,rx:24,ry:12,fill:"white"});case"gz1421":return Object(o.jsx)("ellipse",{cy:-38,rx:24,ry:12,fill:"orange"});case"gz5":return Object(o.jsx)("rect",{x:-30,y:-70,height:30,width:60,fill:"orange"});case"gz4":return Object(o.jsx)("rect",{x:-50,y:-50,height:25,width:100,fill:"whitesmoke"});case"gzgf":return Object(o.jsx)("rect",{x:-30,y:-58,height:30,width:60,fill:"orange"});default:return Object(o.jsx)(o.Fragment,{})}}),[t.variant]);return Object(o.jsxs)("g",{transform:"translate(0,".concat("gz4"===t.variant?-20:0,")"),children:[Object(o.jsx)("rect",{id:"strip_gz",style:Object(r.a)({},"--height","".concat(e,"px"))}),Object(o.jsx)("g",{style:{transform:"translate(calc(var(--rmg-svg-width) / 2),var(--rmg-svg-height))"},children:t.isShowLight&&n}),!1!==t.isShowPSD&&Object(o.jsx)(u,Object(c.a)({},t))]})};var u=i.a.memo((function(t){var e,n=["gz28","gz2otis","gz6","gzgf"].includes(t.variant),c=function(t){switch(t){case"gz1":case"gz3":return"82px";case"gz4":return"65px";case"gz5":return"80px";case"gz1421":return"62px";default:return"58px"}}(t.variant);return Object(o.jsxs)("g",{textAnchor:"middle",fill:n?s.h.black:"var(--rmg-theme-fg)",style:(e={},Object(r.a)(e,"--psd-dy",c),Object(r.a)(e,"transform","translate(var(--translate-x), var(--translate-y))"),Object(r.a)(e,"--translate-x","calc(var(--rmg-svg-width) / 2 + 80px)"),Object(r.a)(e,"--translate-y","calc(var(--rmg-svg-height) - var(--psd-dy, 58px))"),e),children:[Object(o.jsx)("rect",{height:40,width:40,rx:4,x:-20,fill:n?"#fff":"var(--rmg-theme-colour)"}),Object(o.jsx)("text",{className:"rmg-name__en",fontSize:20,dy:12,children:t.isShowPSD}),Object(o.jsx)("text",{className:"rmg-name__zh",fontSize:12,dy:26,children:"\u5c4f\u853d\u95e8"}),Object(o.jsx)("text",{className:"rmg-name__en",fontSize:6.5,dy:36,children:"Screen Door"})]})}),(function(t,e){return t.variant===e.variant&&t.isShowPSD===e.isShowPSD}))},77:function(t,e,n){"use strict";var c=n(1),r=n(11),a=n(37),i=n(4),s=n.n(i),o=n(0),u=["lineNum","stnNum"];e.a=function(t){var e=t.lineNum,n=t.stnNum,i=Object(a.a)(t,u),l=15.03125,j=s.a.useRef(null),h=s.a.useState({width:l}),f=Object(r.a)(h,2),d=f[0],m=f[1];s.a.useEffect((function(){return m(j.current.getBBox())}),[e]);var O=d.width>l?l/d.width:1,b=2===e.length?O:1;return Object(o.jsx)("g",Object(c.a)(Object(c.a)({textAnchor:"middle",fontSize:13.5},i),{},{children:s.a.useMemo((function(){return Object(o.jsxs)(o.Fragment,{children:[Object(o.jsx)("g",{transform:"translate(-9.25,0)scale(".concat(O,")"),children:Object(o.jsx)("text",{ref:j,className:"rmg-name__zh",children:e})}),Object(o.jsx)("g",{transform:"translate(9.25,0)scale(".concat(b,")"),children:Object(o.jsx)("text",{className:"rmg-name__zh",children:n})})]})}),[d.width,e,n])}))}}}]);
//# sourceMappingURL=railmapGZMTR.92d0c82d.chunk.js.map